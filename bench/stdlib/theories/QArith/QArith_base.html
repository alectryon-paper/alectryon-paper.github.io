<!DOCTYPE html>
<html><head><title>QArith_base.v</title><meta charset="utf-8"><meta content="Alectryon v0.2" name="generator"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"><link href="https://unpkg.com/firacode/distr/fira_code.css" rel="stylesheet"><link href="alectryon.css" rel="stylesheet"><script src="alectryon.js"></script><style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-standalone alectryon-centered alectryon-coqdoc"><div class="alectryon-header">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running <a href="https://coq.inria.fr/">Coq</a>+<a href="https://github.com/ejgallego/coq-serapi">SerAPI</a> v8.10.0+0.7.0. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"><span class="sd">(************************************************************************)</span>
<span class="c">(*         *   The Coq Proof Assistant / The Coq Development Team       *)</span>
<span class="c">(*  v      *   INRIA, CNRS and contributors - Copyright 1999-2018       *)</span>
<span class="c">(* &lt;O___,, *       (see CREDITS file for the list of authors)           *)</span>
<span class="c">(*   \VV/  **************************************************************)</span>
<span class="c">(*    //   *    This file is distributed under the terms of the         *)</span>
<span class="c">(*         *     GNU Lesser General Public License Version 2.1          *)</span>
<span class="c">(*         *     (see LICENSE file for the text of the license)         *)</span>
<span class="sd">(************************************************************************)</span>

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Export</span> ZArith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Export</span> ZArithRing.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Export</span> Morphisms Setoid Bool.</span></span></span></pre><div class="doc">
<a name="lab1"></a><h1 class="section">Definition of <span class="inlinecode"><span class="id" title="var">Q</span></span> and basic properties</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
Rationals are pairs of <span class="inlinecode"><span class="id" title="var">Z</span></span> and <span class="inlinecode"><span class="id" title="var">positive</span></span> numbers. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">Q</span> : <span class="kt">Set</span> := Qmake {Qnum : Z; Qden : positive}.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Declare Scope</span> Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Delimit Scope</span> Q_scope <span class="kr">with</span> Q.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Bind Scope</span> Q_scope <span class="kr">with</span> Q.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Arguments</span> Qmake _%Z _%positive.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Open Scope</span> Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">simpl_mult</span> := <span class="nb">rewrite</span> ?Pos2Z.inj_mul.</span></span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">a</span>#<span class="id" title="var">b</span></span> denotes the fraction <span class="inlinecode"><span class="id" title="var">a</span></span> over <span class="inlinecode"><span class="id" title="var">b</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;a # b&quot;</span> := (Qmake a b) (<span class="kn">at level</span> <span class="mi">55</span>, <span class="kn">no associativity</span>) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">of_decimal</span> (<span class="nv">d</span>:Decimal.decimal) : Q :=
  <span class="kr">let</span> &#39;(i, f, e) :=
    <span class="kr">match</span> d <span class="kr">with</span>
    | Decimal.Decimal i f =&gt; (i, f, Decimal.Pos Decimal.Nil)
    | Decimal.DecimalExp i f e =&gt; (i, f, e)
    <span class="kr">end</span> <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">num</span> := Z.of_int (Decimal.app_int i f) <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">e</span> := Z.sub (Z.of_int e) (Z.of_nat (Decimal.nb_digits f)) <span class="kr">in</span>
  <span class="kr">match</span> e <span class="kr">with</span>
  | Z0 =&gt; Qmake num <span class="mi">1</span>
  | Zpos e =&gt; Qmake (Pos.iter (Z.mul <span class="mi">10</span>) num e) <span class="mi">1</span>
  | Zneg e =&gt; Qmake num (Pos.iter (Pos.mul <span class="mi">10</span>) <span class="mi">1</span>%positive e)
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">to_decimal</span> (<span class="nv">q</span>:Q) : option Decimal.decimal :=
  <span class="kr">let</span> <span class="nv">num</span> := Z.to_int (Qnum q) <span class="kr">in</span>
  <span class="kr">let</span> (<span class="nv">den</span>, e_den) := Decimal.nztail (Pos.to_uint (Qden q)) <span class="kr">in</span>
  <span class="kr">match</span> den <span class="kr">with</span>
  | Decimal.D1 Decimal.Nil =&gt;
    <span class="kr">match</span> Z.of_nat e_den <span class="kr">with</span>
    | Z0 =&gt; Some (Decimal.Decimal num Decimal.Nil)
    | e =&gt; Some (Decimal.DecimalExp num Decimal.Nil (Z.to_int (Z.opp e)))
    <span class="kr">end</span>
  | _ =&gt; None
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Numeral Notation</span> <span class="nf">Q</span> of_decimal to_decimal : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">inject_Z</span> (<span class="nv">x</span> : Z) := Qmake x <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Arguments</span> inject_Z x%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">QDen</span> p := (Zpos (Qden p)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qeq</span> (<span class="nv">p</span> <span class="nv">q</span> : Q) := (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qle</span> (<span class="nv">x</span> <span class="nv">y</span> : Q) := (Qnum x * QDen y &lt;= Qnum y * QDen x)%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qlt</span> (<span class="nv">x</span> <span class="nv">y</span> : Q) := (Qnum x * QDen y &lt; Qnum y * QDen x)%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Qgt</span> a b := (Qlt b a) (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Qge</span> a b := (Qle b a) (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;==&quot;</span> := Qeq (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;&quot;</span> := Qlt : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;=&quot;</span> := Qle : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &gt; y&quot;</span> := (Qlt y x)(<span class="kn">only parsing</span>) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &gt;= y&quot;</span> := (Qle y x)(<span class="kn">only parsing</span>) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := (x&lt;=y/\y&lt;=z) : Q_scope.</span></span></span></pre><div class="doc">
injection from Z is injective. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inject_Z_injective</span> (<span class="nv">a</span> <span class="nv">b</span>: Z): inject_Z a == inject_Z b &lt;-&gt; a = b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z a == inject_Z b &lt;-&gt; a = b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z a == inject_Z b &lt;-&gt; a = b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2"><span class="highlight"><span class="nb">unfold</span> Qeq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum (inject_Z a) * QDen (inject_Z b))%Z =
(Qnum (inject_Z b) * QDen (inject_Z a))%Z &lt;-&gt; a = b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a * <span class="mi">1</span>)%Z = (b * <span class="mi">1</span>)%Z &lt;-&gt; a = b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Another approach : using Qcompare for defining order relations. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qcompare</span> (<span class="nv">p</span> <span class="nv">q</span> : Q) := (Qnum p * QDen q ?= Qnum q * QDen p)%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;p ?= q&quot;</span> := (Qcompare p q) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_alt</span> <span class="nv">p</span> <span class="nv">q</span> : (p == q) &lt;-&gt; (p ?= q) = Eq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p == q &lt;-&gt; (p ?= q) = Eq</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p == q &lt;-&gt; (p ?= q) = Eq</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(p ?= q) = Eq &lt;-&gt; p == q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.compare_eq_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_alt</span> <span class="nv">p</span> <span class="nv">q</span> : (p&lt;q) &lt;-&gt; (p?=q = Lt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt; q &lt;-&gt; (p ?= q) = Lt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt; q &lt;-&gt; (p ?= q) = Lt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qgt_alt</span> <span class="nv">p</span> <span class="nv">q</span> : (p&gt;q) &lt;-&gt; (p?=q = Gt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q &lt; p &lt;-&gt; (p ?= q) = Gt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q &lt; p &lt;-&gt; (p ?= q) = Gt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(p ?= q) = Gt &lt;-&gt; q &lt; p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.gt_lt_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_alt</span> <span class="nv">p</span> <span class="nv">q</span> : (p&lt;=q) &lt;-&gt; (p?=q &lt;&gt; Gt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt;= q &lt;-&gt; (p ?= q) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt;= q &lt;-&gt; (p ?= q) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qge_alt</span> <span class="nv">p</span> <span class="nv">q</span> : (p&gt;=q) &lt;-&gt; (p?=q &lt;&gt; Lt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q &lt;= p &lt;-&gt; (p ?= q) &lt;&gt; Lt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q &lt;= p &lt;-&gt; (p ?= q) &lt;&gt; Lt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(p ?= q) &lt;&gt; Lt &lt;-&gt; q &lt;= p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.ge_le_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Unfold</span> Qeq Qlt Qle : qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Extern</span> <span class="mi">5</span> (?X1 &lt;&gt; ?X2) =&gt; <span class="nb">intro</span>; <span class="bp">discriminate</span>: qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk11" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk11"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qcompare_antisym</span> <span class="nv">x</span> <span class="nv">y</span> : CompOpp (x ?= y) = (y ?= x).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CompOpp (x ?= y) = (y ?= x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CompOpp (x ?= y) = (y ?= x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(y ?= x) = CompOpp (x ?= y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.compare_antisym.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qcompare_spec</span> <span class="nv">x</span> <span class="nv">y</span> : CompareSpec (x==y) (x&lt;y) (y&lt;x) (x ?= y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CompareSpec (x == y) (x &lt; y) (y &lt; x) (x ?= y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CompareSpec (x == y) (x &lt; y) (y &lt; x) (x ?= y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk16" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk16"><span class="highlight"><span class="nb">unfold</span> Qeq, Qlt, Qcompare.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CompareSpec
  ((Qnum x * QDen y)%Z = (Qnum y * QDen x)%Z)
  (Qnum x * QDen y &lt; Qnum y * QDen x)%Z
  (Qnum y * QDen x &lt; Qnum x * QDen y)%Z
  (Qnum x * QDen y ?= Qnum y * QDen x)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">case</span> Z.compare_spec; <span class="bp">now</span> <span class="nb">constructor</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab2"></a><h1 class="section">Properties of equality.</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk17" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk17"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qeq_refl</span> <span class="nv">x</span> : x == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qeq_sym</span> <span class="nv">x</span> <span class="nv">y</span> : x == y -&gt; y == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qeq_trans</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : x == y -&gt; y == z -&gt; x == z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; y == z -&gt; x == z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; y == z -&gt; x == z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d"><span class="highlight"><span class="nb">unfold</span> Qeq; <span class="nb">intros</span> XY YZ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">XY</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Qnum x * QDen y)%Z = (Qnum y * QDen x)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">YZ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Qnum y * QDen z)%Z = (Qnum z * QDen y)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum x * QDen z)%Z = (Qnum z * QDen x)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e"><span class="highlight"><span class="nb">apply</span> Z.mul_reg_r <span class="kr">with</span> (QDen y); [<span class="nb">auto with</span> qarith|].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">XY</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Qnum x * QDen y)%Z = (Qnum y * QDen x)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">YZ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Qnum y * QDen z)%Z = (Qnum z * QDen y)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum x * QDen z * QDen y)%Z =
(Qnum z * QDen x * QDen y)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Z.mul_shuffle0, XY, Z.mul_shuffle0, YZ, Z.mul_shuffle0.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Immediate</span> Qeq_sym : qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> Qeq_refl Qeq_trans : qarith.</span></span></span></pre><div class="doc">
In a word, <span class="inlinecode"><span class="id" title="var">Qeq</span></span> is a setoid equality. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Q_Setoid</span> : Equivalence Qeq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Equivalence Qeq</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk20" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk20"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Equivalence Qeq</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; <span class="nb">red</span>; <span class="nb">eauto with</span> qarith.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Furthermore, this equality is decidable: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk21" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk21"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qeq_dec</span> <span class="nv">x</span> <span class="nv">y</span> : {x==y} + {~ x==y}.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{x == y} + {~ x == y}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk22" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk22"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{x == y} + {~ x == y}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.eq_dec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qeq_bool</span> <span class="nv">x</span> <span class="nv">y</span> :=
  (Zeq_bool (Qnum x * QDen y) (Qnum y * QDen x))%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qle_bool</span> <span class="nv">x</span> <span class="nv">y</span> :=
  (Z.leb (Qnum x * QDen y) (Qnum y * QDen x))%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk23" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk23"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_iff</span> <span class="nv">x</span> <span class="nv">y</span> : Qeq_bool x y = true &lt;-&gt; x == y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk24" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk24"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">symmetry</span>; <span class="nb">apply</span> Zeq_is_eq_bool.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk25" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk25"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_eq</span> <span class="nv">x</span> <span class="nv">y</span> : Qeq_bool x y = true -&gt; x == y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true -&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk26" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk26"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true -&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qeq_bool_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk27" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk27"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_eq_bool</span> <span class="nv">x</span> <span class="nv">y</span> : x == y -&gt; Qeq_bool x y = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; Qeq_bool x y = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk28" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk28"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; Qeq_bool x y = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qeq_bool_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk29" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk29"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_neq</span> <span class="nv">x</span> <span class="nv">y</span> : Qeq_bool x y = false -&gt; ~ x == y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = false -&gt; ~ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = false -&gt; ~ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2b"><span class="highlight"><span class="nb">rewrite</span> &lt;- Qeq_bool_iff.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = false -&gt; Qeq_bool x y &lt;&gt; true</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">intros</span> -&gt;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_bool_iff</span> <span class="nv">x</span> <span class="nv">y</span> : Qle_bool x y = true &lt;-&gt; x &lt;= y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qle_bool x y = true &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qle_bool x y = true &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">symmetry</span>; <span class="nb">apply</span> Zle_is_le_bool.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_bool_imp_le</span> <span class="nv">x</span> <span class="nv">y</span> : Qle_bool x y = true -&gt; x &lt;= y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qle_bool x y = true -&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk2f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk2f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qle_bool x y = true -&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qle_bool_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk30" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk30"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qnot_eq_sym</span> <span class="nv">x</span> <span class="nv">y</span> : ~x == y -&gt; ~y == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ x == y -&gt; ~ y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk31" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk31"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ x == y -&gt; ~ y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk32" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk32"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_comm</span> <span class="nv">x</span> <span class="nv">y</span>: Qeq_bool x y = Qeq_bool y x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = Qeq_bool y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk33" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk33"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = Qeq_bool y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk34" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk34"><span class="highlight"><span class="nb">apply</span> eq_true_iff_eq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true &lt;-&gt; Qeq_bool y x = true</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk35" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk35"><span class="highlight"><span class="nb">rewrite</span> !Qeq_bool_iff.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y &lt;-&gt; y == x</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">symmetry</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk36" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk36"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_refl</span> <span class="nv">x</span>: Qeq_bool x x = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x x = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk37" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk37"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x x = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk38" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk38"><span class="highlight"><span class="nb">rewrite</span> Qeq_bool_iff.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == x</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk39" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk39"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_sym</span> <span class="nv">x</span> <span class="nv">y</span>: Qeq_bool x y = true -&gt; Qeq_bool y x = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true -&gt; Qeq_bool y x = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true -&gt; Qeq_bool y x = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3b"><span class="highlight"><span class="nb">rewrite</span> !Qeq_bool_iff.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y -&gt; y == x</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">symmetry</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qeq_bool_trans</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Qeq_bool x y = true -&gt; Qeq_bool y z = true -&gt; Qeq_bool x z = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true -&gt;
Qeq_bool y z = true -&gt; Qeq_bool x z = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool x y = true -&gt;
Qeq_bool y z = true -&gt; Qeq_bool x z = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> !Qeq_bool_iff; <span class="nb">apply</span> Qeq_trans.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> Qnot_eq_sym : qarith.</span></span></span></pre><div class="doc">
<a name="lab3"></a><h1 class="section">Addition, multiplication and opposite</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
The addition, multiplication and opposite are defined
   in the straightforward way: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qplus</span> (<span class="nv">x</span> <span class="nv">y</span> : Q) :=
  (Qnum x * QDen y + Qnum y * QDen x) # (Qden x * Qden y).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qmult</span> (<span class="nv">x</span> <span class="nv">y</span> : Q) := (Qnum x * Qnum y) # (Qden x * Qden y).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qopp</span> (<span class="nv">x</span> : Q) := (- Qnum x) # (Qden x).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qminus</span> (<span class="nv">x</span> <span class="nv">y</span> : Q) := Qplus x (Qopp y).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qinv</span> (<span class="nv">x</span> : Q) :=
  <span class="kr">match</span> Qnum x <span class="kr">with</span>
  | Z0 =&gt; <span class="mi">0</span>
  | Zpos p =&gt; (QDen x)#p
  | Zneg p =&gt; (Zneg (Qden x))#p
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qdiv</span> (<span class="nv">x</span> <span class="nv">y</span> : Q) := Qmult x (Qinv y).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;+&quot;</span> := Qplus : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;- x&quot;</span> := (Qopp x) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;-&quot;</span> := Qminus : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;*&quot;</span> := Qmult : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;/ x&quot;</span> := (Qinv x) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;/&quot;</span> := Qdiv : Q_scope.</span></span></span></pre><div class="doc">
A light notation for <span class="inlinecode"><span class="id" title="var">Zpos</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmake_Qdiv</span> <span class="nv">a</span> <span class="nv">b</span> : a#b==inject_Z a/inject_Z (Zpos b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a # b == inject_Z a / inject_Z (Z.pos b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk3f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk3f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a # b == inject_Z a / inject_Z (Z.pos b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk40" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk40"><span class="highlight"><span class="nb">unfold</span> Qeq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum (a # b) * QDen (inject_Z a / inject_Z (Z.pos b)))%Z =
(Qnum (inject_Z a / inject_Z (Z.pos b)) * QDen (a # b))%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk41" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk41"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a * Z.pos b)%Z = (a * <span class="mi">1</span> * Z.pos b)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab4"></a><h1 class="section">Setoid compatibility results</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk42" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk42"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qplus_comp</span> : Proper (Qeq==&gt;Qeq==&gt;Qeq) Qplus.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qplus</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk43" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk43"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qplus</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk44" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk44"><span class="highlight"><span class="nb">unfold</span> Qeq, Qplus; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z))
  (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : Q =&gt;
   Qnum x * QDen y + Qnum y * QDen x # Qden x * Qden y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk45" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk45"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p))
  (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : Q =&gt;
   Qnum x * QDen y + Qnum y * QDen x # Qden x * Qden y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk46" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk46"><span class="highlight"><span class="nb">intros</span> (p1, p2) (q1, q2) H (r1, r2) (s1, s2) H0; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(p1 * Z.pos r2 + r1 * Z.pos p2) * Z.pos (q2 * s2) =
(q1 * Z.pos s2 + s1 * Z.pos q2) * Z.pos (p2 * r2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk47" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk47"><span class="highlight">simpl_mult; <span class="nb">ring_simplify</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p1 * Z.pos r2 * Z.pos q2 * Z.pos s2 +
r1 * Z.pos p2 * Z.pos q2 * Z.pos s2 =
Z.pos r2 * Z.pos p2 * Z.pos q2 * s1 +
Z.pos r2 * Z.pos p2 * Z.pos s2 * q1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk48" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk48"><span class="highlight"><span class="nb">replace</span> (p1 * Zpos r2 * Zpos q2) <span class="kr">with</span> (p1 * Zpos q2 * Zpos r2) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p1 * Z.pos q2 * Z.pos r2 * Z.pos s2 +
r1 * Z.pos p2 * Z.pos q2 * Z.pos s2 =
Z.pos r2 * Z.pos p2 * Z.pos q2 * s1 +
Z.pos r2 * Z.pos p2 * Z.pos s2 * q1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk49" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk49"><span class="highlight"><span class="nb">rewrite</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q1 * Z.pos p2 * Z.pos r2 * Z.pos s2 +
r1 * Z.pos p2 * Z.pos q2 * Z.pos s2 =
Z.pos r2 * Z.pos p2 * Z.pos q2 * s1 +
Z.pos r2 * Z.pos p2 * Z.pos s2 * q1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4a"><span class="highlight"><span class="nb">replace</span> (r1 * Zpos p2 * Zpos q2 * Zpos s2) <span class="kr">with</span> (r1 * Zpos s2 * Zpos p2 * Zpos q2) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q1 * Z.pos p2 * Z.pos r2 * Z.pos s2 +
r1 * Z.pos s2 * Z.pos p2 * Z.pos q2 =
Z.pos r2 * Z.pos p2 * Z.pos q2 * s1 +
Z.pos r2 * Z.pos p2 * Z.pos s2 * q1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4b"><span class="highlight"><span class="nb">rewrite</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">q1 * Z.pos p2 * Z.pos r2 * Z.pos s2 +
s1 * Z.pos r2 * Z.pos p2 * Z.pos q2 =
Z.pos r2 * Z.pos p2 * Z.pos q2 * s1 +
Z.pos r2 * Z.pos p2 * Z.pos s2 * q1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4c"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qopp_comp</span> : Proper (Qeq==&gt;Qeq) Qopp.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq) Qopp</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq) Qopp</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4e"><span class="highlight"><span class="nb">unfold</span> Qeq, Qopp; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z))
  (<span class="kr">fun</span> <span class="nv">x</span> : Q =&gt; - Qnum x # Qden x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk4f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk4f"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p))
  (<span class="kr">fun</span> <span class="nv">x</span> : Q =&gt; - Qnum x # Qden x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk50" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk50"><span class="highlight"><span class="nb">intros</span> x y H; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Qnum x * QDen y = Qnum y * QDen x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">- Qnum x * QDen y = - Qnum y * QDen x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk51" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk51"><span class="highlight"><span class="nb">replace</span> (- Qnum x * Zpos (Qden y)) <span class="kr">with</span> (- (Qnum x * Zpos (Qden y))) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Qnum x * QDen y = Qnum y * QDen x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">- (Qnum x * QDen y) = - Qnum y * QDen x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> H;  <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk52" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk52"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qminus_comp</span> : Proper (Qeq==&gt;Qeq==&gt;Qeq) Qminus.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qminus</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk53" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk53"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qminus</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk54" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk54"><span class="highlight"><span class="nb">intros</span> x x&#39; Hx y y&#39; Hy.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y == y&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x - y == x&#39; - y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk55" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk55"><span class="highlight"><span class="nb">unfold</span> Qminus.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y == y&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + - y == x&#39; + - y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> Hx, Hy; <span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk56" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk56"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qmult_comp</span> : Proper (Qeq==&gt;Qeq==&gt;Qeq) Qmult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qmult</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk57" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk57"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qmult</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk58" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk58"><span class="highlight"><span class="nb">unfold</span> Qeq; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z)) Qmult</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk59" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk59"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p))
  Qmult</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5a"><span class="highlight"><span class="nb">intros</span> (p1, p2) (q1, q2) H (r1, r2) (s1, s2) H0; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p1 * r1 * Z.pos (q2 * s2) = q1 * s1 * Z.pos (p2 * r2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5b"><span class="highlight"><span class="nb">intros</span>; simpl_mult; <span class="nb">ring_simplify</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p1 * r1 * Z.pos q2 * Z.pos s2 =
q1 * s1 * Z.pos p2 * Z.pos r2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5c"><span class="highlight"><span class="nb">replace</span> (q1 * s1 * Zpos p2) <span class="kr">with</span> (q1 * Zpos p2 * s1) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p1 * r1 * Z.pos q2 * Z.pos s2 =
q1 * Z.pos p2 * s1 * Z.pos r2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5d"><span class="highlight"><span class="nb">rewrite</span> &lt;- H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p1 * r1 * Z.pos q2 * Z.pos s2 =
p1 * Z.pos q2 * s1 * Z.pos r2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5e"><span class="highlight"><span class="nb">replace</span> (p1 * r1 * Zpos q2 * Zpos s2) <span class="kr">with</span> (r1 * Zpos s2 * p1 * Zpos q2) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r1 * Z.pos s2 * p1 * Z.pos q2 =
p1 * Z.pos q2 * s1 * Z.pos r2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk5f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk5f"><span class="highlight"><span class="nb">rewrite</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s1 * Z.pos r2 * p1 * Z.pos q2 =
p1 * Z.pos q2 * s1 * Z.pos r2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk60" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk60"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qinv_comp</span> : Proper (Qeq==&gt;Qeq) Qinv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq) Qinv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk61" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk61"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq) Qinv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk62" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk62"><span class="highlight"><span class="nb">unfold</span> Qeq, Qinv; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z))
  (<span class="kr">fun</span> <span class="nv">x</span> : Q =&gt;
   <span class="kr">match</span> Qnum x <span class="kr">with</span>
   | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
   | Z.pos p =&gt; QDen x # p
   | Z.neg p =&gt; Z.neg (Qden x) # p
   <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk63" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk63"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p))
  (<span class="kr">fun</span> <span class="nv">x</span> : Q =&gt;
   <span class="kr">match</span> Qnum x <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; <span class="mi">0</span>%Q
   | Z.pos p =&gt; QDen x # p
   | Z.neg p =&gt; Z.neg (Qden x) # p
   <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk64" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk64"><span class="highlight"><span class="nb">intros</span> (p1, p2) (q1, q2) EQ; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos p2 # p
  | Z.neg p =&gt; Z.neg p2 # p
  <span class="kr">end</span> *
QDen
  <span class="kr">match</span> q1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos q2 # p
  | Z.neg p =&gt; Z.neg q2 # p
  <span class="kr">end</span> =
Qnum
  <span class="kr">match</span> q1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos q2 # p
  | Z.neg p =&gt; Z.neg q2 # p
  <span class="kr">end</span> *
QDen
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos p2 # p
  | Z.neg p =&gt; Z.neg p2 # p
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk65" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk65"><span class="highlight"><span class="nb">destruct</span> q1; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos p2 # p
  | Z.neg p =&gt; Z.neg p2 # p
  <span class="kr">end</span> * <span class="mi">1</span> = <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk66" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, p, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = Z.pos (p * p2)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk66"><hr></label><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p0 =&gt; Z.pos p2 # p0
  | Z.neg p0 =&gt; Z.neg p2 # p0
  <span class="kr">end</span> * Z.pos p =
Z.pos
  (q2 *
   Qden
     <span class="kr">match</span> p1 <span class="kr">with</span>
     | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
     | Z.pos p0 =&gt; Z.pos p2 # p0
     | Z.neg p0 =&gt; Z.neg p2 # p0
     <span class="kr">end</span>)</span></div></blockquote><input class="coq-extra-goal-toggle" id="QArith-base-v-chk67" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, p, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = Z.neg (p * p2)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk67"><hr></label><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p0 =&gt; Z.pos p2 # p0
  | Z.neg p0 =&gt; Z.neg p2 # p0
  <span class="kr">end</span> * Z.pos p =
Z.neg
  (q2 *
   Qden
     <span class="kr">match</span> p1 <span class="kr">with</span>
     | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
     | Z.pos p0 =&gt; Z.pos p2 # p0
     | Z.neg p0 =&gt; Z.neg p2 # p0
     <span class="kr">end</span>)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk68" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk68"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos p2 # p
  | Z.neg p =&gt; Z.neg p2 # p
  <span class="kr">end</span> * <span class="mi">1</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk69" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk69"><span class="highlight"><span class="nb">apply</span> Z.mul_eq_0 <span class="kr">in</span> EQ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 = <span class="mi">0</span> \/ Z.pos q2 = <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p =&gt; Z.pos p2 # p
  | Z.neg p =&gt; Z.neg p2 # p
  <span class="kr">end</span> * <span class="mi">1</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> EQ; <span class="bp">now</span> <span class="nb">subst</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6a"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, p, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = Z.pos (p * p2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p0 =&gt; Z.pos p2 # p0
  | Z.neg p0 =&gt; Z.neg p2 # p0
  <span class="kr">end</span> * Z.pos p =
Z.pos
  (q2 *
   Qden
     <span class="kr">match</span> p1 <span class="kr">with</span>
     | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
     | Z.pos p0 =&gt; Z.pos p2 # p0
     | Z.neg p0 =&gt; Z.neg p2 # p0
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6b"><span class="highlight"><span class="nb">destruct</span> p1; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="bp">discriminate</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0, p2, p, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos (p0 * q2) = Z.pos (p * p2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos (p2 * p) = Z.pos (q2 * p0)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.mul_comm, &lt;- EQ, Pos.mul_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6c"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2, p, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = Z.neg (p * p2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qnum
  <span class="kr">match</span> p1 <span class="kr">with</span>
  | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
  | Z.pos p0 =&gt; Z.pos p2 # p0
  | Z.neg p0 =&gt; Z.neg p2 # p0
  <span class="kr">end</span> * Z.pos p =
Z.neg
  (q2 *
   Qden
     <span class="kr">match</span> p1 <span class="kr">with</span>
     | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
     | Z.pos p0 =&gt; Z.pos p2 # p0
     | Z.neg p0 =&gt; Z.neg p2 # p0
     <span class="kr">end</span>)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6d"><span class="highlight"><span class="nb">destruct</span> p1; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="kp">try</span> <span class="bp">discriminate</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0, p2, p, q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.neg (p0 * q2) = Z.neg (p * p2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.neg (p2 * p) = Z.neg (q2 * p0)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.mul_comm, &lt;- EQ, Pos.mul_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6e"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qdiv_comp</span> : Proper (Qeq==&gt;Qeq==&gt;Qeq) Qdiv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qdiv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk6f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk6f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; Qeq) Qdiv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk70" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk70"><span class="highlight"><span class="nb">intros</span> x x&#39; Hx y y&#39; Hy; <span class="nb">unfold</span> Qdiv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y == y&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * / y == x&#39; * / y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> Hx, Hy; <span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk71" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk71"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qcompare_comp</span> : Proper (Qeq==&gt;Qeq==&gt;eq) Qcompare.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; eq) Qcompare</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk72" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk72"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; eq) Qcompare</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk73" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk73"><span class="highlight"><span class="nb">unfold</span> Qeq, Qcompare.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
    (Qnum p * QDen q)%Z = (Qnum q * QDen p)%Z) ==&gt; eq)
  (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt;
   (Qnum p * QDen q ?= Qnum q * QDen p)%Z)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk74" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk74"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper
  ((<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q = Qnum q * QDen p) ==&gt;
   eq)
  (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> : Q =&gt; Qnum p * QDen q ?= Qnum q * QDen p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk75" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk75"><span class="highlight"><span class="nb">intros</span> (p1,p2) (q1,q2) H (r1,r2) (s1,s2) H&#39;; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(p1 * Z.pos r2 ?= r1 * Z.pos p2) =
(q1 * Z.pos s2 ?= s1 * Z.pos q2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk76" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk76"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Zcompare_mult_compat (q2*s2) (p1*Zpos r2)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Z.pos (q2 * s2) * (p1 * Z.pos r2)
 ?= Z.pos (q2 * s2) * (r1 * Z.pos p2)) =
(q1 * Z.pos s2 ?= s1 * Z.pos q2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk77" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk77"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Zcompare_mult_compat (p2*r2) (q1*Zpos s2)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Z.pos (q2 * s2) * (p1 * Z.pos r2)
 ?= Z.pos (q2 * s2) * (r1 * Z.pos p2)) =
(Z.pos (p2 * r2) * (q1 * Z.pos s2)
 ?= Z.pos (p2 * r2) * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk78" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk78"><span class="highlight"><span class="nb">change</span> (Zpos (q2*s2)) <span class="kr">with</span> (Zpos q2 * Zpos s2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Z.pos q2 * Z.pos s2 * (p1 * Z.pos r2)
 ?= Z.pos q2 * Z.pos s2 * (r1 * Z.pos p2)) =
(Z.pos (p2 * r2) * (q1 * Z.pos s2)
 ?= Z.pos (p2 * r2) * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk79" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk79"><span class="highlight"><span class="nb">change</span> (Zpos (p2*r2)) <span class="kr">with</span> (Zpos p2 * Zpos r2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Z.pos q2 * Z.pos s2 * (p1 * Z.pos r2)
 ?= Z.pos q2 * Z.pos s2 * (r1 * Z.pos p2)) =
(Z.pos p2 * Z.pos r2 * (q1 * Z.pos s2)
 ?= Z.pos p2 * Z.pos r2 * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7a"><span class="highlight"><span class="nb">replace</span> (Zpos q2 * Zpos s2 * (p1*Zpos r2)) <span class="kr">with</span> ((p1*Zpos q2)*Zpos r2*Zpos s2) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(p1 * Z.pos q2 * Z.pos r2 * Z.pos s2
 ?= Z.pos q2 * Z.pos s2 * (r1 * Z.pos p2)) =
(Z.pos p2 * Z.pos r2 * (q1 * Z.pos s2)
 ?= Z.pos p2 * Z.pos r2 * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7b"><span class="highlight"><span class="nb">rewrite</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(q1 * Z.pos p2 * Z.pos r2 * Z.pos s2
 ?= Z.pos q2 * Z.pos s2 * (r1 * Z.pos p2)) =
(Z.pos p2 * Z.pos r2 * (q1 * Z.pos s2)
 ?= Z.pos p2 * Z.pos r2 * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7c"><span class="highlight"><span class="nb">replace</span> (Zpos q2 * Zpos s2 * (r1*Zpos p2)) <span class="kr">with</span> ((r1*Zpos s2)*Zpos q2*Zpos p2) <span class="bp">by</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(q1 * Z.pos p2 * Z.pos r2 * Z.pos s2
 ?= r1 * Z.pos s2 * Z.pos q2 * Z.pos p2) =
(Z.pos p2 * Z.pos r2 * (q1 * Z.pos s2)
 ?= Z.pos p2 * Z.pos r2 * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7d"><span class="highlight"><span class="nb">rewrite</span> H&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p1 * Z.pos q2 = q1 * Z.pos p2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r1 * Z.pos s2 = s1 * Z.pos r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(q1 * Z.pos p2 * Z.pos r2 * Z.pos s2
 ?= s1 * Z.pos r2 * Z.pos q2 * Z.pos p2) =
(Z.pos p2 * Z.pos r2 * (q1 * Z.pos s2)
 ?= Z.pos p2 * Z.pos r2 * (s1 * Z.pos q2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">f_equal</span>; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7e"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qle_comp</span> : Proper (Qeq==&gt;Qeq==&gt;iff) Qle.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; iff) Qle</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk7f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk7f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; iff) Qle</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk80" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk80"><span class="highlight"><span class="nb">intros</span> p q H r s H&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p == q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r == s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt;= r &lt;-&gt; q &lt;= s</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> Qle_alt, H, H&#39;; <span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk81" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk81"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qlt_compat</span> : Proper (Qeq==&gt;Qeq==&gt;iff) Qlt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; iff) Qlt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk82" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk82"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; iff) Qlt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk83" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk83"><span class="highlight"><span class="nb">intros</span> p q H r s H&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p == q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r == s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt; r &lt;-&gt; q &lt; s</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> Qlt_alt, H, H&#39;; <span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk84" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk84"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qeqb_comp</span> : Proper (Qeq==&gt;Qeq==&gt;eq) Qeq_bool.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; eq) Qeq_bool</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk85" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk85"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; eq) Qeq_bool</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk86" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk86"><span class="highlight"><span class="nb">intros</span> p q H r s H&#39;; <span class="nb">apply</span> eq_true_iff_eq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p == q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r == s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qeq_bool p r = true &lt;-&gt; Qeq_bool q s = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> Qeq_bool_iff, H, H&#39;; <span class="nb">split</span>; <span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk87" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk87"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qleb_comp</span> : Proper (Qeq==&gt;Qeq==&gt;eq) Qle_bool.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; eq) Qle_bool</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk88" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk88"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; Qeq ==&gt; eq) Qle_bool</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk89" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk89"><span class="highlight"><span class="nb">intros</span> p q H r s H&#39;; <span class="nb">apply</span> eq_true_iff_eq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p == q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r == s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qle_bool p r = true &lt;-&gt; Qle_bool q s = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> Qle_bool_iff, H, H&#39;; <span class="nb">split</span>; <span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<span class="inlinecode">0</span> and <span class="inlinecode">1</span> are apart 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Q_apart_0_1</span> : ~ <span class="mi">1</span> == <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ <span class="mi">1</span> == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ <span class="mi">1</span> == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qeq; <span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab5"></a><h1 class="section">Properties of <span class="inlinecode"><span class="id" title="var">Qadd</span></span></h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
Addition is associative: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8c"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qplus_assoc</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x+(y+z)==(x+y)+z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x + (y + z) == x + y + z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x + (y + z) == x + y + z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8e"><span class="highlight"><span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 # x2) + ((y1 # y2) + (z1 # z2)) ==
(x1 # x2) + (y1 # y2) + (z1 # z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qeq, Qplus; <span class="nb">simpl</span>; simpl_mult; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<span class="inlinecode">0</span> is a neutral element for addition: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk8f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk8f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_0_l</span> : <span class="kr">forall</span> <span class="nv">x</span>, <span class="mi">0</span>+x == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, <span class="mi">0</span> + x == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk90" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk90"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, <span class="mi">0</span> + x == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> (x1, x2); <span class="nb">unfold</span> Qeq, Qplus; <span class="nb">simpl</span>; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk91" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk91"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_0_r</span> : <span class="kr">forall</span> <span class="nv">x</span>, x+<span class="mi">0</span> == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, x + <span class="mi">0</span> == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk92" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk92"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, x + <span class="mi">0</span> == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk93" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk93"><span class="highlight"><span class="nb">intros</span> (x1, x2); <span class="nb">unfold</span> Qeq, Qplus; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((x1 * <span class="mi">1</span> + <span class="mi">0</span>) * Z.pos x2)%Z = (x1 * Z.pos (x2 * <span class="mi">1</span>))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> Pos.mul_comm; <span class="nb">simpl</span>; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Commutativity of addition: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk94" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk94"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qplus_comm</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x+y == y+x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x + y == y + x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk95" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk95"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x + y == y + x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk96" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk96"><span class="highlight"><span class="nb">intros</span> (x1, x2); <span class="nb">unfold</span> Qeq, Qplus; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Q,
((x1 * QDen y + Qnum y * Z.pos x2) *
 Z.pos (Qden y * x2))%Z =
((Qnum y * Z.pos x2 + x1 * QDen y) *
 Z.pos (x2 * Qden y))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> Pos.mul_comm; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab6"></a><h1 class="section">Properties of <span class="inlinecode"><span class="id" title="var">Qopp</span></span></h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk97" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk97"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qopp_involutive</span> : <span class="kr">forall</span> <span class="nv">q</span>, - -q == q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : Q, - - q == q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk98" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk98"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : Q, - - q == q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk99" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk99"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qplus_opp_r</span> : <span class="kr">forall</span> <span class="nv">q</span>, q+(-q) == <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : Q, q + - q == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk9a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk9a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : Q, q + - q == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">intro</span>; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Injectivity of addition (uses theory about Qopp above): 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk9b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk9b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_inj_r</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q):
  x + z == y + z &lt;-&gt; x == y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z == y + z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk9c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk9c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z == y + z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk9d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk9d"><span class="highlight"><span class="nb">split</span>; <span class="nb">intro</span> E.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z == y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk9e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk9e"><hr></label><div class="goal-conclusion"><span class="highlight">x + z == y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk9f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk9f"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qplus_0_r x), &lt;- (Qplus_0_r y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z == y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + <span class="mi">0</span> == y + <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chka0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chka0"><hr></label><div class="goal-conclusion"><span class="highlight">x + z == y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka1"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qplus_opp_r z); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z == y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + (z + - z) == y + (z + - z)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chka2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chka2"><hr></label><div class="goal-conclusion"><span class="highlight">x + z == y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka3"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> Qplus_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z == y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z + - z == y + z + - z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chka4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chka4"><hr></label><div class="goal-conclusion"><span class="highlight">x + z == y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka5"><span class="highlight"><span class="nb">rewrite</span> E.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z == y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y + z + - z == y + z + - z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chka6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chka6"><hr></label><div class="goal-conclusion"><span class="highlight">x + z == y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka7"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z == y + z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka8"><span class="highlight"><span class="nb">rewrite</span> E.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y + z == y + z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chka9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chka9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_inj_l</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q):
  z + x == z + y &lt;-&gt; x == y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z + x == z + y &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkaa" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkaa"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z + x == z + y &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkab" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkab"><span class="highlight"><span class="nb">rewrite</span> (Qplus_comm z x), (Qplus_comm z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z == y + z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qplus_inj_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab7"></a><h1 class="section">Properties of <span class="inlinecode"><span class="id" title="var">Qmult</span></span></h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
Multiplication is associative: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkac" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkac"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_assoc</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, n*(m*p)==(n*m)*p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : Q, n * (m * p) == n * m * p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkad" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkad"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : Q, n * (m * p) == n * m * p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">rewrite</span> Pos.mul_assoc; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
multiplication and zero 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkae" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkae"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_0_l</span> : <span class="kr">forall</span> <span class="nv">x</span> , <span class="mi">0</span>*x == <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, <span class="mi">0</span> * x == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkaf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkaf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, <span class="mi">0</span> * x == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">compute</span>; <span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_0_r</span> : <span class="kr">forall</span> <span class="nv">x</span> , x*<span class="mi">0</span> == <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, x * <span class="mi">0</span> == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, x * <span class="mi">0</span> == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">simpl</span>; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<span class="inlinecode">1</span> is a neutral element for multiplication: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_1_l</span> : <span class="kr">forall</span> <span class="nv">n</span>, <span class="mi">1</span>*n == n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : Q, <span class="mi">1</span> * n == n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : Q, <span class="mi">1</span> * n == n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intro</span>; <span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">destruct</span> (Qnum n); <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb4"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_1_r</span> : <span class="kr">forall</span> <span class="nv">n</span>, n*<span class="mi">1</span>==n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : Q, n * <span class="mi">1</span> == n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : Q, n * <span class="mi">1</span> == n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb6"><span class="highlight"><span class="nb">intro</span>; <span class="nb">red</span>; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum n * <span class="mi">1</span> * QDen n)%Z =
(Qnum n * Z.pos (Qden n * <span class="mi">1</span>))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb7"><span class="highlight"><span class="nb">rewrite</span> Z.mul_1_r <span class="kr">with</span> (n := Qnum n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum n * QDen n)%Z = (Qnum n * Z.pos (Qden n * <span class="mi">1</span>))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> Pos.mul_comm; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Commutativity of multiplication 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb8"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_comm</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x*y==y*x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x * y == y * x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkb9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkb9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x * y == y * x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">rewrite</span> Pos.mul_comm; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Distributivity over <span class="inlinecode"><span class="id" title="var">Qadd</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkba" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkba"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_plus_distr_r</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x*(y+z)==(x*y)+(x*z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x * (y + z) == x * y + x * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkbb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkbb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x * (y + z) == x * y + x * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkbc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkbc"><span class="highlight"><span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 # x2) * ((y1 # y2) + (z1 # z2)) ==
(x1 # x2) * (y1 # y2) + (x1 # x2) * (z1 # z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qeq, Qmult, Qplus; <span class="nb">simpl</span>; simpl_mult; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkbd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkbd"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_plus_distr_l</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, (x+y)*z==(x*z)+(y*z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, (x + y) * z == x * z + y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkbe" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkbe"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, (x + y) * z == x * z + y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkbf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkbf"><span class="highlight"><span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((x1 # x2) + (y1 # y2)) * (z1 # z2) ==
(x1 # x2) * (z1 # z2) + (y1 # y2) * (z1 # z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qeq, Qmult, Qplus; <span class="nb">simpl</span>; simpl_mult; <span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Integrality 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc0"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_integral</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x*y==<span class="mi">0</span> -&gt; x==<span class="mi">0</span> \/ y==<span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x * y == <span class="mi">0</span> -&gt; x == <span class="mi">0</span> \/ y == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x * y == <span class="mi">0</span> -&gt; x == <span class="mi">0</span> \/ y == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc2"><span class="highlight"><span class="nb">intros</span> (x1,x2) (y1,y2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 # x2) * (y1 # y2) == <span class="mi">0</span> -&gt;
x1 # x2 == <span class="mi">0</span> \/ y1 # y2 == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc3"><span class="highlight"><span class="nb">unfold</span> Qeq, Qmult; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * y1 * <span class="mi">1</span>)%Z = <span class="mi">0</span>%Z -&gt;
(x1 * <span class="mi">1</span>)%Z = <span class="mi">0</span>%Z \/ (y1 * <span class="mi">1</span>)%Z = <span class="mi">0</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Z.mul_eq_0, !Z.mul_1_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc4"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_integral_l</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, ~ x == <span class="mi">0</span> -&gt; x*y == <span class="mi">0</span> -&gt; y == <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ x == <span class="mi">0</span> -&gt; x * y == <span class="mi">0</span> -&gt; y == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ x == <span class="mi">0</span> -&gt; x * y == <span class="mi">0</span> -&gt; y == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc6"><span class="highlight"><span class="nb">intros</span> (x1, x2) (y1, y2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ x1 # x2 == <span class="mi">0</span> -&gt;
(x1 # x2) * (y1 # y2) == <span class="mi">0</span> -&gt; y1 # y2 == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc7"><span class="highlight"><span class="nb">unfold</span> Qeq, Qmult; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * <span class="mi">1</span>)%Z &lt;&gt; <span class="mi">0</span>%Z -&gt;
(x1 * y1 * <span class="mi">1</span>)%Z = <span class="mi">0</span>%Z -&gt; (y1 * <span class="mi">1</span>)%Z = <span class="mi">0</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc8"><span class="highlight"><span class="nb">rewrite</span> !Z.mul_1_r, Z.mul_eq_0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 &lt;&gt; <span class="mi">0</span>%Z -&gt; x1 = <span class="mi">0</span>%Z \/ y1 = <span class="mi">0</span>%Z -&gt; y1 = <span class="mi">0</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab8"></a><h1 class="section">inject_Z is a ring homomorphism:</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkc9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkc9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inject_Z_plus</span> (<span class="nv">x</span> <span class="nv">y</span>: Z): inject_Z (x + y) = inject_Z x + inject_Z y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z (x + y) = inject_Z x + inject_Z y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkca" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkca"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z (x + y) = inject_Z x + inject_Z y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkcb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkcb"><span class="highlight"><span class="nb">unfold</span> Qplus, inject_Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + y # <span class="mi">1</span> =
Qnum (x # <span class="mi">1</span>) * QDen (y # <span class="mi">1</span>) +
Qnum (y # <span class="mi">1</span>) * QDen (x # <span class="mi">1</span>)
# Qden (x # <span class="mi">1</span>) * Qden (y # <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkcc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkcc"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + y # <span class="mi">1</span> = x * <span class="mi">1</span> + y * <span class="mi">1</span> # <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkcd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkcd"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x + y)%Z = (x * <span class="mi">1</span> + y * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">ring</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkce" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkce"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inject_Z_mult</span> (<span class="nv">x</span> <span class="nv">y</span>: Z): inject_Z (x * y) = inject_Z x * inject_Z y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z (x * y) = inject_Z x * inject_Z y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkcf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkcf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z (x * y) = inject_Z x * inject_Z y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inject_Z_opp</span> (<span class="nv">x</span>: Z): inject_Z (- x) = - inject_Z x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z (- x) = - inject_Z x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inject_Z (- x) = - inject_Z x</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab9"></a><h1 class="section">Inverse and division.</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qinv_involutive</span> : <span class="kr">forall</span> <span class="nv">q</span>, (/ / q) == q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : Q, / / q == q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : Q, / / q == q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> [[|n|n] d]; <span class="nb">red</span>; <span class="nb">simpl</span>; <span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd4"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_inv_r</span> : <span class="kr">forall</span> <span class="nv">x</span>, ~ x == <span class="mi">0</span> -&gt; x*(/x) == <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, ~ x == <span class="mi">0</span> -&gt; x * / x == <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Q, ~ x == <span class="mi">0</span> -&gt; x * / x == <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd6"><span class="highlight"><span class="nb">intros</span> (x1, x2); <span class="nb">unfold</span> Qeq, Qdiv, Qmult; <span class="nb">case</span> x1; <span class="nb">simpl</span>;
    <span class="nb">intros</span>; simpl_mult; <span class="kp">try</span> <span class="bp">ring</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%Z &lt;&gt; <span class="mi">0</span>%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span>%Z = (Z.pos x2 * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">elim</span> H; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qinv_mult_distr</span> : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, / (p * q) == /p * /q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, / (p * q) == / p * / q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, / (p * q) == / p * / q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkd9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkd9"><span class="highlight"><span class="nb">intros</span> (x1,x2) (y1,y2); <span class="nb">unfold</span> Qeq, Qinv, Qmult; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum
   <span class="kr">match</span> x1 * y1 <span class="kr">with</span>
   | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
   | Z.pos p =&gt; Z.pos (x2 * y2) # p
   | Z.neg p =&gt; Z.neg (x2 * y2) # p
   <span class="kr">end</span> *
 Z.pos
   (Qden
      <span class="kr">match</span> x1 <span class="kr">with</span>
      | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
      | Z.pos p =&gt; Z.pos x2 # p
      | Z.neg p =&gt; Z.neg x2 # p
      <span class="kr">end</span> *
    Qden
      <span class="kr">match</span> y1 <span class="kr">with</span>
      | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
      | Z.pos p =&gt; Z.pos y2 # p
      | Z.neg p =&gt; Z.neg y2 # p
      <span class="kr">end</span>))%Z =
(Qnum
   <span class="kr">match</span> x1 <span class="kr">with</span>
   | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
   | Z.pos p =&gt; Z.pos x2 # p
   | Z.neg p =&gt; Z.neg x2 # p
   <span class="kr">end</span> *
 Qnum
   <span class="kr">match</span> y1 <span class="kr">with</span>
   | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
   | Z.pos p =&gt; Z.pos y2 # p
   | Z.neg p =&gt; Z.neg y2 # p
   <span class="kr">end</span> *
 QDen
   <span class="kr">match</span> x1 * y1 <span class="kr">with</span>
   | <span class="mi">0</span>%Z =&gt; <span class="mi">0</span>
   | Z.pos p =&gt; Z.pos (x2 * y2) # p
   | Z.neg p =&gt; Z.neg (x2 * y2) # p
   <span class="kr">end</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x1; <span class="nb">simpl</span>; <span class="nb">auto</span>;
    <span class="nb">destruct</span> y1; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkda" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkda"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qdiv_mult_l</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, ~ y == <span class="mi">0</span> -&gt; (x*y)/y == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ y == <span class="mi">0</span> -&gt; x * y / y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkdb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkdb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ y == <span class="mi">0</span> -&gt; x * y / y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkdc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkdc"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> Qdiv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * y * / y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkdd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkdd"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qmult_assoc x y (Qinv y)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * (y * / y) == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkde" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkde"><span class="highlight"><span class="nb">rewrite</span> (Qmult_inv_r y H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * <span class="mi">1</span> == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qmult_1_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkdf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkdf"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Qmult_div_r</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, ~ y == <span class="mi">0</span> -&gt; y*(x/y) == x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ y == <span class="mi">0</span> -&gt; y * (x / y) == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ y == <span class="mi">0</span> -&gt; y * (x / y) == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke1"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> Qdiv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y * (x * / y) == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke2"><span class="highlight"><span class="nb">rewrite</span> (Qmult_assoc y x (Qinv y)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y * x * / y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke3"><span class="highlight"><span class="nb">rewrite</span> (Qmult_comm y x).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * y * / y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke4"><span class="highlight"><span class="nb">fold</span> (Qdiv (Qmult x y) y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ y == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * y / y == x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qdiv_mult_l; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Injectivity of Qmult (requires theory about Qinv above): 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_inj_r</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): ~ z == <span class="mi">0</span> -&gt; (x * z == y * z &lt;-&gt; x == y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ z == <span class="mi">0</span> -&gt; x * z == y * z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ z == <span class="mi">0</span> -&gt; x * z == y * z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke7"><span class="highlight"><span class="nb">intro</span> z_ne_0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * z == y * z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chke8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chke8"><span class="highlight"><span class="nb">split</span>; <span class="nb">intro</span> E.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x * z == y * z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x == y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chke9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chke9"><hr></label><div class="goal-conclusion"><span class="highlight">x * z == y * z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkea" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkea"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qmult_1_r x), &lt;- (Qmult_1_r y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x * z == y * z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * <span class="mi">1</span> == y * <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chkeb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chkeb"><hr></label><div class="goal-conclusion"><span class="highlight">x * z == y * z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkec" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkec"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qmult_inv_r z); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x * z == y * z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * (z * / z) == y * (z * / z)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chked" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chked"><hr></label><div class="goal-conclusion"><span class="highlight">x * z == y * z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkee" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkee"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> Qmult_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x * z == y * z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * z * / z == y * z * / z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chkef" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chkef"><hr></label><div class="goal-conclusion"><span class="highlight">x * z == y * z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf0"><span class="highlight"><span class="nb">rewrite</span> E.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x * z == y * z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y * z * / z == y * z * / z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chkf1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chkf1"><hr></label><div class="goal-conclusion"><span class="highlight">x * z == y * z</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf2"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * z == y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf3"><span class="highlight"><span class="nb">rewrite</span> E.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z_ne_0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ z == <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">E</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y * z == y * z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_inj_l</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): ~ z == <span class="mi">0</span> -&gt; (z * x == z * y &lt;-&gt; x == y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ z == <span class="mi">0</span> -&gt; z * x == z * y &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ z == <span class="mi">0</span> -&gt; z * x == z * y &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf6"><span class="highlight"><span class="nb">rewrite</span> (Qmult_comm z x), (Qmult_comm z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ z == <span class="mi">0</span> -&gt; x * z == y * z &lt;-&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qmult_inj_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab10"></a><h1 class="section">Properties of order upon Q.</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_refl</span> <span class="nv">x</span> : x&lt;=x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkf9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkf9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_antisym</span> <span class="nv">x</span> <span class="nv">y</span> : x&lt;=y -&gt; y&lt;=x -&gt; x==y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y -&gt; y &lt;= x -&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkfa" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkfa"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y -&gt; y &lt;= x -&gt; x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qeq; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkfb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkfb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_trans</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x&lt;=y -&gt; y&lt;=z -&gt; x&lt;=z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt;= y -&gt; y &lt;= z -&gt; x &lt;= z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkfc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkfc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt;= y -&gt; y &lt;= z -&gt; x &lt;= z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkfd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkfd"><span class="highlight"><span class="nb">unfold</span> Qle; <span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2); <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(x1 * Z.pos y2 &lt;= y1 * Z.pos x2)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(y1 * Z.pos z2 &lt;= z1 * Z.pos y2)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos z2 &lt;= z1 * Z.pos x2)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkfe" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkfe"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 &lt;= z1 * Z.pos x2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chkff" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chkff"><span class="highlight"><span class="nb">apply</span> Z.mul_le_mono_pos_r <span class="kr">with</span> (Zpos y2); [<span class="bp">easy</span>|].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt;= z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk100" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk100"><span class="highlight"><span class="nb">apply</span> Z.le_trans <span class="kr">with</span> (y1 * Zpos x2 * Zpos z2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt;= y1 * Z.pos x2 * Z.pos z2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk101" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk101"><hr></label><div class="goal-conclusion"><span class="highlight">y1 * Z.pos x2 * Z.pos z2 &lt;= z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk102" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk102"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt;= y1 * Z.pos x2 * Z.pos z2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk103" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk103"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 * Z.pos z2 &lt;= y1 * Z.pos x2 * Z.pos z2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.mul_le_mono_pos_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk104" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk104"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y1 * Z.pos x2 * Z.pos z2 &lt;= z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk105" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk105"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle0, (Z.mul_shuffle0 z1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y1 * Z.pos z2 * Z.pos x2 &lt;= z1 * Z.pos y2 * Z.pos x2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.mul_le_mono_pos_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> Qle_trans : qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk106" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk106"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_irrefl</span> <span class="nv">x</span> : ~x&lt;x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ x &lt; x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk107" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk107"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ x &lt; x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk108" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk108"><span class="highlight"><span class="nb">unfold</span> Qlt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ (Qnum x * QDen x &lt; Qnum x * QDen x)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk109" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk109"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_not_eq</span> <span class="nv">x</span> <span class="nv">y</span> : x&lt;y -&gt; ~ x==y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt; y -&gt; ~ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt; y -&gt; ~ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qlt, Qeq; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zle_Qle</span> (<span class="nv">x</span> <span class="nv">y</span>: Z): (x &lt;= y)%Z = (inject_Z x &lt;= inject_Z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt;= y)%Z = (inject_Z x &lt;= inject_Z y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt;= y)%Z = (inject_Z x &lt;= inject_Z y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10d"><span class="highlight"><span class="nb">unfold</span> Qle.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt;= y)%Z =
(Qnum (inject_Z x) * QDen (inject_Z y) &lt;=
 Qnum (inject_Z y) * QDen (inject_Z x))%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10e"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt;= y)%Z = (x * <span class="mi">1</span> &lt;= y * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> !Z.mul_1_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk10f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk10f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zlt_Qlt</span> (<span class="nv">x</span> <span class="nv">y</span>: Z): (x &lt; y)%Z = (inject_Z x &lt; inject_Z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt; y)%Z = (inject_Z x &lt; inject_Z y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk110" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk110"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt; y)%Z = (inject_Z x &lt; inject_Z y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk111" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk111"><span class="highlight"><span class="nb">unfold</span> Qlt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt; y)%Z =
(Qnum (inject_Z x) * QDen (inject_Z y) &lt;
 Qnum (inject_Z y) * QDen (inject_Z x))%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk112" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk112"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x &lt; y)%Z = (x * <span class="mi">1</span> &lt; y * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> !Z.mul_1_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Large = strict or equal 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk113" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk113"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_lteq</span> <span class="nv">x</span> <span class="nv">y</span> : x&lt;=y &lt;-&gt; x&lt;y \/ x==y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y &lt;-&gt; x &lt; y \/ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk114" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk114"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y &lt;-&gt; x &lt; y \/ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk115" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk115"><span class="highlight"><span class="nb">rewrite</span> Qeq_alt, Qle_alt, Qlt_alt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x ?= y) &lt;&gt; Gt &lt;-&gt; (x ?= y) = Lt \/ (x ?= y) = Eq</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (x ?= y); <span class="nb">intuition</span>; <span class="bp">discriminate</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk116" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk116"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_le_weak</span> <span class="nv">x</span> <span class="nv">y</span> : x&lt;y -&gt; x&lt;=y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt; y -&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk117" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk117"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt; y -&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk118" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk118"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_lt_trans</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x&lt;=y -&gt; y&lt;z -&gt; x&lt;z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt;= y -&gt; y &lt; z -&gt; x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk119" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk119"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt;= y -&gt; y &lt; z -&gt; x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk11a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk11a"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2); <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(x1 * Z.pos y2 &lt;= y1 * Z.pos x2)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(y1 * Z.pos z2 &lt; z1 * Z.pos y2)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos z2 &lt; z1 * Z.pos x2)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk11b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk11b"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 &lt; z1 * Z.pos x2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk11c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk11c"><span class="highlight"><span class="nb">apply</span> Z.mul_lt_mono_pos_r <span class="kr">with</span> (Zpos y2); [<span class="bp">easy</span>|].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt; z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk11d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk11d"><span class="highlight"><span class="nb">apply</span> Z.le_lt_trans <span class="kr">with</span> (y1 * Zpos x2 * Zpos z2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt;= y1 * Z.pos x2 * Z.pos z2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk11e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk11e"><hr></label><div class="goal-conclusion"><span class="highlight">y1 * Z.pos x2 * Z.pos z2 &lt; z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk11f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk11f"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt;= y1 * Z.pos x2 * Z.pos z2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk120" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk120"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 * Z.pos z2 &lt;= y1 * Z.pos x2 * Z.pos z2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.mul_le_mono_pos_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk121" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk121"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y1 * Z.pos x2 * Z.pos z2 &lt; z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk122" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk122"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle0, (Z.mul_shuffle0 z1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt; z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y1 * Z.pos z2 * Z.pos x2 &lt; z1 * Z.pos y2 * Z.pos x2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.mul_lt_mono_pos_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk123" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk123"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_le_trans</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x&lt;y -&gt; y&lt;=z -&gt; x&lt;z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt; y -&gt; y &lt;= z -&gt; x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk124" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk124"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt; y -&gt; y &lt;= z -&gt; x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk125" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk125"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2); <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(x1 * Z.pos y2 &lt; y1 * Z.pos x2)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(y1 * Z.pos z2 &lt;= z1 * Z.pos y2)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos z2 &lt; z1 * Z.pos x2)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk126" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk126"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 &lt; z1 * Z.pos x2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk127" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk127"><span class="highlight"><span class="nb">apply</span> Z.mul_lt_mono_pos_r <span class="kr">with</span> (Zpos y2); [<span class="bp">easy</span>|].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt; z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk128" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk128"><span class="highlight"><span class="nb">apply</span> Z.lt_le_trans <span class="kr">with</span> (y1 * Zpos x2 * Zpos z2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt; y1 * Z.pos x2 * Z.pos z2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk129" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk129"><hr></label><div class="goal-conclusion"><span class="highlight">y1 * Z.pos x2 * Z.pos z2 &lt;= z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12a"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 &lt; y1 * Z.pos x2 * Z.pos z2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12b"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 * Z.pos z2 &lt; y1 * Z.pos x2 * Z.pos z2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.mul_lt_mono_pos_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12c"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y1 * Z.pos x2 * Z.pos z2 &lt;= z1 * Z.pos x2 * Z.pos y2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12d"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle0, (Z.mul_shuffle0 z1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y1 * Z.pos z2 &lt;= z1 * Z.pos y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">y1 * Z.pos z2 * Z.pos x2 &lt;= z1 * Z.pos y2 * Z.pos x2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.mul_le_mono_pos_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_trans</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x&lt;y -&gt; y&lt;z -&gt; x&lt;z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt; y -&gt; y &lt; z -&gt; x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk12f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk12f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt; y -&gt; y &lt; z -&gt; x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk130" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk130"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt; y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y &lt; z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt; z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk131" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk131"><span class="highlight"><span class="nb">apply</span> Qle_lt_trans <span class="kr">with</span> y; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt; y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y &lt; z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qlt_le_weak; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">x</span>&lt;<span class="id" title="var">y</span></span> iff <span class="inlinecode">~(<span class="id" title="var">y</span>‚â§<span class="id" title="var">x</span>)</span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk132" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk132"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qnot_lt_le</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, ~ x&lt;y -&gt; y&lt;=x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ x &lt; y -&gt; y &lt;= x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk133" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk133"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ x &lt; y -&gt; y &lt;= x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk134" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk134"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qnot_le_lt</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, ~ x&lt;=y -&gt; y&lt;x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ x &lt;= y -&gt; y &lt; x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk135" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk135"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, ~ x &lt;= y -&gt; y &lt; x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk136" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk136"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_not_le</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x&lt;y -&gt; ~ y&lt;=x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x &lt; y -&gt; ~ y &lt;= x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk137" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk137"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x &lt; y -&gt; ~ y &lt;= x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk138" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk138"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_not_lt</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x&lt;=y -&gt; ~ y&lt;x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x &lt;= y -&gt; ~ y &lt; x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk139" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk139"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x &lt;= y -&gt; ~ y &lt; x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_lt_or_eq</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, x&lt;=y -&gt; x&lt;y \/ x==y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x &lt;= y -&gt; x &lt; y \/ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, x &lt;= y -&gt; x &lt; y \/ x == y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt, Qeq; <span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">apply</span> Z.lt_eq_cases.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> Qle_not_lt Qlt_not_le Qnot_le_lt Qnot_lt_le
 Qlt_le_weak Qlt_not_eq Qle_antisym Qle_refl: qarith.</span></span></span></pre><div class="doc">
Some decidability results about orders. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Q_dec</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, {x&lt;y} + {y&lt;x} + {x==y}.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, {x &lt; y} + {y &lt; x} + {x == y}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, {x &lt; y} + {y &lt; x} + {x == y}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13e"><span class="highlight"><span class="nb">unfold</span> Qlt, Qle, Qeq; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{(Qnum x * QDen y &lt; Qnum y * QDen x)%Z} +
{(Qnum y * QDen x &lt; Qnum x * QDen y)%Z} +
{(Qnum x * QDen y)%Z = (Qnum y * QDen x)%Z}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (Z_dec&#39; (Qnum x * QDen y) (Qnum y * QDen x)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk13f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk13f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_le_dec</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, {x&lt;y} + {y&lt;=x}.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, {x &lt; y} + {y &lt;= x}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk140" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk140"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Q, {x &lt; y} + {y &lt;= x}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk141" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk141"><span class="highlight"><span class="nb">unfold</span> Qlt, Qle; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{(Qnum x * QDen y &lt; Qnum y * QDen x)%Z} +
{(Qnum y * QDen x &lt;= Qnum x * QDen y)%Z}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (Z_lt_le_dec (Qnum x * QDen y) (Qnum y * QDen x)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span></span></pre><div class="doc">
Compatibility of operations with respect to order. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk142" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk142"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qopp_le_compat</span> : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, p&lt;=q -&gt; -q &lt;= -p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, p &lt;= q -&gt; - q &lt;= - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk143" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk143"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, p &lt;= q -&gt; - q &lt;= - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk144" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk144"><span class="highlight"><span class="nb">intros</span> (a1,a2) (b1,b2); <span class="nb">unfold</span> Qle, Qlt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a1 * Z.pos b2 &lt;= b1 * Z.pos a2)%Z -&gt;
(- b1 * Z.pos a2 &lt;= - a1 * Z.pos b2)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk145" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk145"><span class="highlight"><span class="nb">rewrite</span> !Z.mul_opp_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a1 * Z.pos b2 &lt;= b1 * Z.pos a2)%Z -&gt;
(- (b1 * Z.pos a2) &lt;= - (a1 * Z.pos b2))%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> Qopp_le_compat : qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk146" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk146"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_minus_iff</span> : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, p &lt;= q &lt;-&gt; <span class="mi">0</span> &lt;= q+-p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, p &lt;= q &lt;-&gt; <span class="mi">0</span> &lt;= q + - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk147" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk147"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, p &lt;= q &lt;-&gt; <span class="mi">0</span> &lt;= q + - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk148" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk148"><span class="highlight"><span class="nb">intros</span> (x1,x2) (y1,y2); <span class="nb">unfold</span> Qle; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos y2 &lt;= y1 * Z.pos x2)%Z &lt;-&gt;
(<span class="mi">0</span> &lt;= (y1 * Z.pos x2 + - x1 * Z.pos y2) * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk149" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk149"><span class="highlight"><span class="nb">rewrite</span> Z.mul_opp_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos y2 &lt;= y1 * Z.pos x2)%Z &lt;-&gt;
(<span class="mi">0</span> &lt;= (y1 * Z.pos x2 + - (x1 * Z.pos y2)) * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_minus_iff</span> : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, p &lt; q &lt;-&gt; <span class="mi">0</span> &lt; q+-p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, p &lt; q &lt;-&gt; <span class="mi">0</span> &lt; q + - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : Q, p &lt; q &lt;-&gt; <span class="mi">0</span> &lt; q + - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14c"><span class="highlight"><span class="nb">intros</span> (x1,x2) (y1,y2); <span class="nb">unfold</span> Qlt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos y2 &lt; y1 * Z.pos x2)%Z &lt;-&gt;
(<span class="mi">0</span> &lt; (y1 * Z.pos x2 + - x1 * Z.pos y2) * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14d"><span class="highlight"><span class="nb">rewrite</span> Z.mul_opp_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos y2 &lt; y1 * Z.pos x2)%Z &lt;-&gt;
(<span class="mi">0</span> &lt; (y1 * Z.pos x2 + - (x1 * Z.pos y2)) * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_le_compat</span> :
  <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span>, x&lt;=y -&gt; z&lt;=t -&gt; x+z &lt;= y+t.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span> : Q, x &lt;= y -&gt; z &lt;= t -&gt; x + z &lt;= y + t</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk14f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk14f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span> : Q, x &lt;= y -&gt; z &lt;= t -&gt; x + z &lt;= y + t</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk150" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk150"><span class="highlight"><span class="nb">unfold</span> Qplus, Qle; <span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2) (t1, t2);
    <span class="nb">simpl</span>; simpl_mult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos y2 &lt;= y1 * Z.pos x2)%Z -&gt;
(z1 * Z.pos t2 &lt;= t1 * Z.pos z2)%Z -&gt;
((x1 * Z.pos z2 + z1 * Z.pos x2) *
 (Z.pos y2 * Z.pos t2) &lt;=
 (y1 * Z.pos t2 + t1 * Z.pos y2) *
 (Z.pos x2 * Z.pos z2))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk151" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk151"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2 -&gt;
z1 * Z.pos t2 &lt;= t1 * Z.pos z2 -&gt;
(x1 * Z.pos z2 + z1 * Z.pos x2) *
(Z.pos y2 * Z.pos t2) &lt;=
(y1 * Z.pos t2 + t1 * Z.pos y2) *
(Z.pos x2 * Z.pos z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk152" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk152"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos z2 + z1 * Z.pos x2) *
(Z.pos y2 * Z.pos t2) &lt;=
(y1 * Z.pos t2 + t1 * Z.pos y2) *
(Z.pos x2 * Z.pos z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk153" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk153"><span class="highlight"><span class="kr">match goal with</span> |- ?a &lt;= ?b =&gt; <span class="nb">ring_simplify</span> a b <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 +
z1 * Z.pos x2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos y2 * t1 +
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk154" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk154"><span class="highlight"><span class="nb">rewrite</span> Z.add_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z1 * Z.pos x2 * Z.pos y2 * Z.pos t2 +
x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos y2 * t1 +
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk155" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk155"><span class="highlight"><span class="nb">apply</span> Z.add_le_mono.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z1 * Z.pos x2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos y2 * t1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk156" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk156"><hr></label><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk157" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk157"><span class="highlight"><span class="kr">match goal with</span> |- ?a &lt;= ?b =&gt; <span class="nb">ring_simplify</span> z1 t1 (Zpos z2) (Zpos t2) a b <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z1 * Z.pos t2 * Z.pos x2 * Z.pos y2 &lt;=
t1 * Z.pos z2 * Z.pos x2 * Z.pos y2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk158" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk158"><hr></label><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk159" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk159"><span class="highlight"><span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15a"><span class="highlight"><span class="kr">match goal with</span> |- ?a &lt;= ?b =&gt; <span class="nb">ring_simplify</span> x1 y1 (Zpos x2) (Zpos y2) a b <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt;= y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 * Z.pos z2 * Z.pos t2 &lt;=
y1 * Z.pos x2 * Z.pos z2 * Z.pos t2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_lt_le_compat</span> :
  <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span>, x&lt;y -&gt; z&lt;=t -&gt; x+z &lt; y+t.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span> : Q, x &lt; y -&gt; z &lt;= t -&gt; x + z &lt; y + t</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">t</span> : Q, x &lt; y -&gt; z &lt;= t -&gt; x + z &lt; y + t</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15d"><span class="highlight"><span class="nb">unfold</span> Qplus, Qle, Qlt; <span class="nb">intros</span> (x1, x2) (y1, y2) (z1, z2) (t1, t2);
    <span class="nb">simpl</span>; simpl_mult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos y2 &lt; y1 * Z.pos x2)%Z -&gt;
(z1 * Z.pos t2 &lt;= t1 * Z.pos z2)%Z -&gt;
((x1 * Z.pos z2 + z1 * Z.pos x2) *
 (Z.pos y2 * Z.pos t2) &lt;
 (y1 * Z.pos t2 + t1 * Z.pos y2) *
 (Z.pos x2 * Z.pos z2))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15e"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2 -&gt;
z1 * Z.pos t2 &lt;= t1 * Z.pos z2 -&gt;
(x1 * Z.pos z2 + z1 * Z.pos x2) *
(Z.pos y2 * Z.pos t2) &lt;
(y1 * Z.pos t2 + t1 * Z.pos y2) *
(Z.pos x2 * Z.pos z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk15f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk15f"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x1 * Z.pos z2 + z1 * Z.pos x2) *
(Z.pos y2 * Z.pos t2) &lt;
(y1 * Z.pos t2 + t1 * Z.pos y2) *
(Z.pos x2 * Z.pos z2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk160" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk160"><span class="highlight"><span class="kr">match goal with</span> |- ?a &lt; ?b =&gt; <span class="nb">ring_simplify</span> a b <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 +
z1 * Z.pos x2 * Z.pos y2 * Z.pos t2 &lt;
Z.pos z2 * Z.pos x2 * Z.pos y2 * t1 +
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk161" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk161"><span class="highlight"><span class="nb">rewrite</span> Z.add_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z1 * Z.pos x2 * Z.pos y2 * Z.pos t2 +
x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;
Z.pos z2 * Z.pos x2 * Z.pos y2 * t1 +
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk162" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk162"><span class="highlight"><span class="nb">apply</span> Z.add_le_lt_mono.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z1 * Z.pos x2 * Z.pos y2 * Z.pos t2 &lt;=
Z.pos z2 * Z.pos x2 * Z.pos y2 * t1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk163" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk163"><hr></label><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk164" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk164"><span class="highlight"><span class="kr">match goal with</span> |- ?a &lt;= ?b =&gt; <span class="nb">ring_simplify</span> z1 t1 (Zpos z2) (Zpos t2) a b <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z1 * Z.pos t2 * Z.pos x2 * Z.pos y2 &lt;=
t1 * Z.pos z2 * Z.pos x2 * Z.pos y2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk165" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk165"><hr></label><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk166" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk166"><span class="highlight"><span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos z2 * Z.pos y2 * Z.pos t2 &lt;
Z.pos z2 * Z.pos x2 * Z.pos t2 * y1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk167" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk167"><span class="highlight"><span class="kr">match goal with</span> |- ?a &lt; ?b =&gt; <span class="nb">ring_simplify</span> x1 y1 (Zpos x2) (Zpos y2) a b <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x1 * Z.pos y2 &lt; y1 * Z.pos x2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z1 * Z.pos t2 &lt;= t1 * Z.pos z2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x1 * Z.pos y2 * Z.pos z2 * Z.pos t2 &lt;
y1 * Z.pos x2 * Z.pos z2 * Z.pos t2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> (<span class="nb">apply</span> Z.mul_lt_mono_pos_r;<span class="kp">try</span> <span class="bp">easy</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk168" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk168"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_le_l</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): x + z &lt;= y + z &lt;-&gt; x &lt;= y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk169" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk169"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk16a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk16a"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z &lt;= y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk16b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt;= y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk16b"><hr></label><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk16c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk16c"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qplus_0_r x), &lt;- (Qplus_0_r y), &lt;- (Qplus_opp_r z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z &lt;= y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + (z + - z) &lt;= y + (z + - z)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk16d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt;= y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk16d"><hr></label><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk16e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk16e"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> Qplus_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z &lt;= y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z + - z &lt;= y + z + - z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk16f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt;= y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk16f"><hr></label><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk170" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk170"><span class="highlight"><span class="nb">apply</span> Qplus_le_compat; <span class="nb">auto with</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt;= y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qplus_le_compat; <span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk171" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk171"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_le_r</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): z + x &lt;= z + y &lt;-&gt; x &lt;= y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z + x &lt;= z + y &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk172" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk172"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z + x &lt;= z + y &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk173" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk173"><span class="highlight"><span class="nb">rewrite</span> (Qplus_comm z x), (Qplus_comm z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt;= y + z &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qplus_le_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk174" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk174"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_lt_l</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): x + z &lt; y + z &lt;-&gt; x &lt; y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk175" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk175"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk176" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk176"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z &lt; y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt; y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk177" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt; y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk177"><hr></label><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk178" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk178"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Qplus_0_r x), &lt;- (Qplus_0_r y), &lt;- (Qplus_opp_r z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z &lt; y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + (z + - z) &lt; y + (z + - z)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk179" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt; y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk179"><hr></label><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk17a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk17a"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> Qplus_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x + z &lt; y + z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z + - z &lt; y + z + - z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk17b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt; y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk17b"><hr></label><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk17c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk17c"><span class="highlight"><span class="nb">apply</span> Qplus_lt_le_compat; <span class="nb">auto with</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt; y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qplus_lt_le_compat; <span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk17d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk17d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qplus_lt_r</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): z + x &lt; z + y &lt;-&gt; x &lt; y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z + x &lt; z + y &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk17e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk17e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">z + x &lt; z + y &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk17f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk17f"><span class="highlight"><span class="nb">rewrite</span> (Qplus_comm z x), (Qplus_comm z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x + z &lt; y + z &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qplus_lt_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk180" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk180"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_le_compat_r</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, x &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; x*z &lt;= y*z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; x * z &lt;= y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk181" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk181"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, x &lt;= y -&gt; <span class="mi">0</span> &lt;= z -&gt; x * z &lt;= y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk182" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk182"><span class="highlight"><span class="nb">intros</span> (a1,a2) (b1,b2) (c1,c2); <span class="nb">unfold</span> Qle, Qlt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a1 * Z.pos b2 &lt;= b1 * Z.pos a2)%Z -&gt;
(<span class="mi">0</span> &lt;= c1 * <span class="mi">1</span>)%Z -&gt;
(a1 * c1 * Z.pos (b2 * c2) &lt;=
 b1 * c1 * Z.pos (a2 * c2))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk183" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk183"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * Z.pos b2 &lt;= b1 * Z.pos a2 -&gt;
<span class="mi">0</span> &lt;= c1 * <span class="mi">1</span> -&gt;
a1 * c1 * Z.pos (b2 * c2) &lt;= b1 * c1 * Z.pos (a2 * c2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk184" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk184"><span class="highlight"><span class="nb">intros</span>; simpl_mult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 &lt;= b1 * Z.pos a2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= c1 * <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * c1 * (Z.pos b2 * Z.pos c2) &lt;=
b1 * c1 * (Z.pos a2 * Z.pos c2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk185" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk185"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle1, (Z.mul_shuffle1 b1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 &lt;= b1 * Z.pos a2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= c1 * <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;=
b1 * Z.pos a2 * (c1 * Z.pos c2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.mul_le_mono_nonneg_r; <span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk186" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk186"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_lt_0_le_reg_r</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, <span class="mi">0</span> &lt; z  -&gt; x*z &lt;= y*z -&gt; x &lt;= y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, <span class="mi">0</span> &lt; z -&gt; x * z &lt;= y * z -&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk187" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk187"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, <span class="mi">0</span> &lt; z -&gt; x * z &lt;= y * z -&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk188" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk188"><span class="highlight"><span class="nb">intros</span> (a1,a2) (b1,b2) (c1,c2); <span class="nb">unfold</span> Qle, Qlt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; c1 * <span class="mi">1</span>)%Z -&gt;
(a1 * c1 * Z.pos (b2 * c2) &lt;=
 b1 * c1 * Z.pos (a2 * c2))%Z -&gt;
(a1 * Z.pos b2 &lt;= b1 * Z.pos a2)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk189" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk189"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * c1 * Z.pos (b2 * c2) &lt;= b1 * c1 * Z.pos (a2 * c2) -&gt;
a1 * Z.pos b2 &lt;= b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18a"><span class="highlight">simpl_mult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * c1 * (Z.pos b2 * Z.pos c2) &lt;=
b1 * c1 * (Z.pos a2 * Z.pos c2) -&gt;
a1 * Z.pos b2 &lt;= b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18b"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle1, (Z.mul_shuffle1 b1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;=
b1 * Z.pos a2 * (c1 * Z.pos c2) -&gt;
a1 * Z.pos b2 &lt;= b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18c"><span class="highlight"><span class="nb">intros</span> LT LE.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;=
b1 * Z.pos a2 * (c1 * Z.pos c2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * Z.pos b2 &lt;= b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18d"><span class="highlight"><span class="nb">apply</span> Z.mul_le_mono_pos_r <span class="kr">in</span> LE; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;=
b1 * Z.pos a2 * (c1 * Z.pos c2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : Z,
<span class="mi">0</span> &lt; p -&gt; n * p &lt;= m * p -&gt; n &lt;= m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * Z.pos c2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.mul_pos_pos; [<span class="bp">omega</span>|<span class="bp">easy</span>].</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_le_r</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): <span class="mi">0</span> &lt; z -&gt; (x*z &lt;= y*z &lt;-&gt; x &lt;= y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; x * z &lt;= y * z &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk18f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk18f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; x * z &lt;= y * z &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk190" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk190"><span class="highlight"><span class="nb">split</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x * z &lt;= y * z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;= y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk191" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt;= y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk191"><hr></label><div class="goal-conclusion"><span class="highlight">x * z &lt;= y * z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk192" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk192"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Qmult_lt_0_le_reg_r <span class="kr">with</span> z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x &lt;= y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x * z &lt;= y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qmult_le_compat_r; <span class="nb">auto with</span> qarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk193" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk193"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_le_l</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): <span class="mi">0</span> &lt; z -&gt; (z*x &lt;= z*y &lt;-&gt; x &lt;= y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; z * x &lt;= z * y &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk194" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk194"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; z * x &lt;= z * y &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk195" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk195"><span class="highlight"><span class="nb">rewrite</span> (Qmult_comm z x), (Qmult_comm z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; x * z &lt;= y * z &lt;-&gt; x &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qmult_le_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk196" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk196"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_lt_compat_r</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, <span class="mi">0</span> &lt; z  -&gt; x &lt; y -&gt; x*z &lt; y*z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, <span class="mi">0</span> &lt; z -&gt; x &lt; y -&gt; x * z &lt; y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk197" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk197"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, <span class="mi">0</span> &lt; z -&gt; x &lt; y -&gt; x * z &lt; y * z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk198" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk198"><span class="highlight"><span class="nb">intros</span> (a1,a2) (b1,b2) (c1,c2); <span class="nb">unfold</span> Qle, Qlt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; c1 * <span class="mi">1</span>)%Z -&gt;
(a1 * Z.pos b2 &lt; b1 * Z.pos a2)%Z -&gt;
(a1 * c1 * Z.pos (b2 * c2) &lt; b1 * c1 * Z.pos (a2 * c2))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk199" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk199"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * Z.pos b2 &lt; b1 * Z.pos a2 -&gt;
a1 * c1 * Z.pos (b2 * c2) &lt; b1 * c1 * Z.pos (a2 * c2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19a" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19a"><span class="highlight"><span class="nb">intros</span>; simpl_mult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * c1 * (Z.pos b2 * Z.pos c2) &lt;
b1 * c1 * (Z.pos a2 * Z.pos c2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19b" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19b"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle1, (Z.mul_shuffle1 b1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;
b1 * Z.pos a2 * (c1 * Z.pos c2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19c" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19c"><span class="highlight"><span class="nb">apply</span> Z.mul_lt_mono_pos_r; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * Z.pos c2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.mul_pos_pos; [<span class="bp">omega</span>|<span class="bp">reflexivity</span>].</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19d" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_lt_r</span>: <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>, <span class="mi">0</span> &lt; z -&gt; (x*z &lt; y*z &lt;-&gt; x &lt; y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, <span class="mi">0</span> &lt; z -&gt; x * z &lt; y * z &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19e" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q, <span class="mi">0</span> &lt; z -&gt; x * z &lt; y * z &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk19f" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk19f"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : Q,
(<span class="mi">0</span> &lt; z)%Q -&gt; (x * z &lt; y * z)%Q &lt;-&gt; (x &lt; y)%Q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a0"><span class="highlight"><span class="nb">intros</span> (a1,a2) (b1,b2) (c1,c2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; c1 # c2)%Q -&gt;
((a1 # a2) * (c1 # c2) &lt; (b1 # b2) * (c1 # c2))%Q &lt;-&gt;
(a1 # a2 &lt; b1 # b2)%Q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a1"><span class="highlight"><span class="nb">unfold</span> Qle, Qlt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * c1 * Z.pos (b2 * c2) &lt; b1 * c1 * Z.pos (a2 * c2) &lt;-&gt;
a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a2"><span class="highlight">simpl_mult.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * c1 * (Z.pos b2 * Z.pos c2) &lt;
b1 * c1 * (Z.pos a2 * Z.pos c2) &lt;-&gt;
a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a3"><span class="highlight"><span class="nb">rewrite</span> Z.mul_shuffle1, (Z.mul_shuffle1 b1).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span> -&gt;
a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;
b1 * Z.pos a2 * (c1 * Z.pos c2) &lt;-&gt;
a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a4"><span class="highlight"><span class="nb">intro</span> LT.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * Z.pos b2 * (c1 * Z.pos c2) &lt;
b1 * Z.pos a2 * (c1 * Z.pos c2) &lt;-&gt;
a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a5"><span class="highlight"><span class="nb">rewrite</span> &lt;- Z.mul_lt_mono_pos_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 * Z.pos b2 &lt; b1 * Z.pos a2 &lt;-&gt;
a1 * Z.pos b2 &lt; b1 * Z.pos a2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1a6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1a6"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * Z.pos c2</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a7"><span class="highlight"><span class="bp">reflexivity</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">c2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c1 * <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c1 * Z.pos c2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.mul_pos_pos; [<span class="bp">omega</span>|<span class="bp">reflexivity</span>].</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Close Scope</span> Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_lt_l</span> (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span>: Q): <span class="mi">0</span> &lt; z -&gt; (z*x &lt; z*y &lt;-&gt; x &lt; y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; z * x &lt; z * y &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1a9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1a9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; z * x &lt; z * y &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1aa" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1aa"><span class="highlight"><span class="nb">rewrite</span> (Qmult_comm z x), (Qmult_comm z y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; z -&gt; x * z &lt; y * z &lt;-&gt; x &lt; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qmult_lt_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ab" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ab"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qmult_le_0_compat</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span>, <span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt;= b -&gt; <span class="mi">0</span> &lt;= a*b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Q, <span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt;= b -&gt; <span class="mi">0</span> &lt;= a * b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ac" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ac"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Q, <span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt;= b -&gt; <span class="mi">0</span> &lt;= a * b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ad" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ad"><span class="highlight"><span class="nb">intros</span> a b Ha Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= a * b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ae" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ae"><span class="highlight"><span class="nb">unfold</span> Qle <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Qnum <span class="mi">0</span> * QDen a &lt;= Qnum a * QDen <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Qnum <span class="mi">0</span> * QDen b &lt;= Qnum b * QDen <span class="mi">0</span>)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Qnum <span class="mi">0</span> * QDen (a * b) &lt;= Qnum (a * b) * QDen <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1af" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1af"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">0</span> &lt;= Qnum a * <span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">0</span> &lt;= Qnum b * <span class="mi">1</span>)%Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt;= Qnum a * Qnum b * <span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qinv_le_0_compat</span> : <span class="kr">forall</span> <span class="nv">a</span>, <span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt;= /a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : Q, <span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt;= / a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : Q, <span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt;= / a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> [[|n|n] d] Ha; <span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_shift_div_l</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; c -&gt; a*c &lt;= b -&gt; a &lt;= b/c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt;= b -&gt; a &lt;= b / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt;= b -&gt; a &lt;= b / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b4"><span class="highlight"><span class="nb">intros</span> a b c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= b / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b5"><span class="highlight"><span class="nb">apply</span> Qmult_lt_0_le_reg_r <span class="kr">with</span> (c).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1b6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1b6"><hr></label><div class="goal-conclusion"><span class="highlight">a * c &lt;= b / c * c</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b7"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a * c &lt;= b / c * c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b8"><span class="highlight"><span class="nb">setoid_replace</span> (b/c*c) <span class="kr">with</span> (c*(b/c)) <span class="bp">by</span> <span class="nb">apply</span> Qmult_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a * c &lt;= c * (b / c)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1b9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1b9"><span class="highlight"><span class="nb">rewrite</span> Qmult_div_r; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ c == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ba" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ba"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_shift_inv_l</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; c -&gt; a*c &lt;= <span class="mi">1</span> -&gt; a &lt;= /c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt;= <span class="mi">1</span> -&gt; a &lt;= / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1bb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1bb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt;= <span class="mi">1</span> -&gt; a &lt;= / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1bc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1bc"><span class="highlight"><span class="nb">intros</span> a c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1bd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1bd"><span class="highlight"><span class="nb">setoid_replace</span> (/c) <span class="kr">with</span> (<span class="mi">1</span>*/c) <span class="bp">by</span> (<span class="nb">symmetry</span>; <span class="nb">apply</span> Qmult_1_l).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= <span class="mi">1</span> * / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1be" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1be"><span class="highlight"><span class="nb">change</span> (a &lt;= <span class="mi">1</span>/c).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt;= <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= <span class="mi">1</span> / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qle_shift_div_l; <span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1bf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1bf"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_shift_div_r</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; b -&gt; a &lt;= c*b -&gt; a/b &lt;= c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; a &lt;= c * b -&gt; a / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; a &lt;= c * b -&gt; a / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c1"><span class="highlight"><span class="nb">intros</span> a b c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c2"><span class="highlight"><span class="nb">apply</span> Qmult_lt_0_le_reg_r <span class="kr">with</span> b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1c3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt;= c * b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1c3"><hr></label><div class="goal-conclusion"><span class="highlight">a / b * b &lt;= c * b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c4"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a / b * b &lt;= c * b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c5"><span class="highlight"><span class="nb">setoid_replace</span> (a/b*b) <span class="kr">with</span> (b*(a/b)) <span class="bp">by</span> <span class="nb">apply</span> Qmult_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b * (a / b) &lt;= c * b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c6"><span class="highlight"><span class="nb">rewrite</span> Qmult_div_r; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ b == <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qle_shift_inv_r</span> : <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; b -&gt; <span class="mi">1</span> &lt;= c*b -&gt; /b &lt;= c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; <span class="mi">1</span> &lt;= c * b -&gt; / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; <span class="mi">1</span> &lt;= c * b -&gt; / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1c9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1c9"><span class="highlight"><span class="nb">intros</span> b c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">1</span> &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">/ b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ca" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ca"><span class="highlight"><span class="nb">setoid_replace</span> (/b) <span class="kr">with</span> (<span class="mi">1</span>*/b) <span class="bp">by</span> (<span class="nb">symmetry</span>; <span class="nb">apply</span> Qmult_1_l).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">1</span> &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> * / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1cb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1cb"><span class="highlight"><span class="nb">change</span> (<span class="mi">1</span>/b &lt;= c).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">1</span> &lt;= c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> / b &lt;= c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qle_shift_div_r; <span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1cc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1cc"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qinv_lt_0_compat</span> : <span class="kr">forall</span> <span class="nv">a</span>, <span class="mi">0</span> &lt; a -&gt; <span class="mi">0</span> &lt; /a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : Q, <span class="mi">0</span> &lt; a -&gt; <span class="mi">0</span> &lt; / a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1cd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1cd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : Q, <span class="mi">0</span> &lt; a -&gt; <span class="mi">0</span> &lt; / a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> [[|n|n] d] Ha; <span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ce" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ce"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_shift_div_l</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; c -&gt; a*c &lt; b -&gt; a &lt; b/c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt; b -&gt; a &lt; b / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1cf" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1cf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt; b -&gt; a &lt; b / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d0"><span class="highlight"><span class="nb">intros</span> a b c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt; b / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d1"><span class="highlight"><span class="nb">apply</span> Qnot_le_lt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ b / c &lt;= a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d2"><span class="highlight"><span class="nb">intros</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d3"><span class="highlight"><span class="nb">apply</span> (Qlt_not_le _ _ H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b &lt;= a * c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d4"><span class="highlight"><span class="nb">apply</span> Qmult_lt_0_le_reg_r <span class="kr">with</span> (/c).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; / c</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1d5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1d5"><hr></label><div class="goal-conclusion"><span class="highlight">b * / c &lt;= a * c * / c</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d6"><span class="highlight"><span class="nb">apply</span> Qinv_lt_0_compat.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; c</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1d7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1d7"><hr></label><div class="goal-conclusion"><span class="highlight">b * / c &lt;= a * c * / c</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d8"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b * / c &lt;= a * c * / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1d9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1d9"><span class="highlight"><span class="nb">setoid_replace</span> (a*c/c) <span class="kr">with</span> (a) <span class="bp">by</span> (<span class="nb">apply</span> Qdiv_mult_l; <span class="nb">auto with</span> *).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b / c &lt;= a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b * / c &lt;= a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1da" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1da"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_shift_inv_l</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; c -&gt; a*c &lt; <span class="mi">1</span> -&gt; a &lt; /c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt; <span class="mi">1</span> -&gt; a &lt; / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1db" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1db"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; c -&gt; a * c &lt; <span class="mi">1</span> -&gt; a &lt; / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1dc" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1dc"><span class="highlight"><span class="nb">intros</span> a c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt; / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1dd" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1dd"><span class="highlight"><span class="nb">setoid_replace</span> (/c) <span class="kr">with</span> (<span class="mi">1</span>*/c) <span class="bp">by</span> (<span class="nb">symmetry</span>; <span class="nb">apply</span> Qmult_1_l).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt; <span class="mi">1</span> * / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1de" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1de"><span class="highlight"><span class="nb">change</span> (a &lt; <span class="mi">1</span>/c).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; c</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a * c &lt; <span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt; <span class="mi">1</span> / c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qlt_shift_div_l; <span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1df" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1df"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_shift_div_r</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; b -&gt; a &lt; c*b -&gt; a/b &lt; c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; a &lt; c * b -&gt; a / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; a &lt; c * b -&gt; a / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e1"><span class="highlight"><span class="nb">intros</span> a b c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e2"><span class="highlight"><span class="nb">apply</span> Qnot_le_lt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ c &lt;= a / b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e3"><span class="highlight"><span class="nb">intros</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e4"><span class="highlight"><span class="nb">apply</span> (Qlt_not_le _ _ H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">c * b &lt;= a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e5"><span class="highlight"><span class="nb">apply</span> Qmult_lt_0_le_reg_r <span class="kr">with</span> (/b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; / b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1e6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1e6"><hr></label><div class="goal-conclusion"><span class="highlight">c * b * / b &lt;= a * / b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e7"><span class="highlight"><span class="nb">apply</span> Qinv_lt_0_compat.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="QArith-base-v-chk1e8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="QArith-base-v-chk1e8"><hr></label><div class="goal-conclusion"><span class="highlight">c * b * / b &lt;= a * / b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1e9" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1e9"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">c * b * / b &lt;= a * / b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ea" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ea"><span class="highlight"><span class="nb">setoid_replace</span> (c*b/b) <span class="kr">with</span> (c) <span class="bp">by</span> (<span class="nb">apply</span> Qdiv_mult_l; <span class="nb">auto with</span> *).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a &lt; c * b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">c &lt;= a / b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">c &lt;= a * / b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1eb" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1eb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Qlt_shift_inv_r</span> : <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c</span>,
 <span class="mi">0</span> &lt; b -&gt; <span class="mi">1</span> &lt; c*b -&gt; /b &lt; c.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; <span class="mi">1</span> &lt; c * b -&gt; / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ec" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ec"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c</span> : Q, <span class="mi">0</span> &lt; b -&gt; <span class="mi">1</span> &lt; c * b -&gt; / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ed" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ed"><span class="highlight"><span class="nb">intros</span> b c Hc H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">1</span> &lt; c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">/ b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ee" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ee"><span class="highlight"><span class="nb">setoid_replace</span> (/b) <span class="kr">with</span> (<span class="mi">1</span>*/b) <span class="bp">by</span> (<span class="nb">symmetry</span>; <span class="nb">apply</span> Qmult_1_l).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">1</span> &lt; c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> * / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1ef" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1ef"><span class="highlight"><span class="nb">change</span> (<span class="mi">1</span>/b &lt; c).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">1</span> &lt; c * b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> / b &lt; c</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Qlt_shift_div_r; <span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab11"></a><h1 class="section">Rational to the n-th power</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qpower_positive</span> : Q -&gt; positive -&gt; Q :=
 pow_pos Qmult.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f0" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f0"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qpower_positive_comp</span> : Proper (Qeq==&gt;eq==&gt;Qeq) Qpower_positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; eq ==&gt; Qeq) Qpower_positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f1" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; eq ==&gt; Qeq) Qpower_positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f2" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f2"><span class="highlight"><span class="nb">intros</span> x x&#39; Hx y y&#39; Hy.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y = y&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qpower_positive x y == Qpower_positive x&#39; y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f3" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f3"><span class="highlight"><span class="nb">rewrite</span> &lt;-Hy; <span class="nb">clear</span> y&#39; Hy.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Qpower_positive x y == Qpower_positive x&#39; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f4" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f4"><span class="highlight"><span class="nb">unfold</span> Qpower_positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pow_pos Qmult x y == pow_pos Qmult x&#39; y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> y; <span class="nb">simpl</span>;
<span class="kp">try</span> <span class="nb">rewrite</span> IHy;
<span class="kp">try</span> <span class="nb">rewrite</span> Hx;
<span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Qpower</span> (<span class="nv">q</span>:Q) (<span class="nv">z</span>:Z) :=
    <span class="kr">match</span> z <span class="kr">with</span>
      | Zpos p =&gt; Qpower_positive q p
      | Z0 =&gt; <span class="mi">1</span>
      | Zneg p =&gt; /Qpower_positive q p
    <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot; q ^ z &quot;</span> := (Qpower q z) : Q_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f5" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f5"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Qpower_comp</span> : Proper (Qeq==&gt;eq==&gt;Qeq) Qpower.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; eq ==&gt; Qeq) Qpower</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f6" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Proper (Qeq ==&gt; eq ==&gt; Qeq) Qpower</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f7" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f7"><span class="highlight"><span class="nb">intros</span> x x&#39; Hx y y&#39; Hy.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">y = y&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ y == x&#39; ^ y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="QArith-base-v-chk1f8" style="display: none" type="checkbox"><label class="coq-input" for="QArith-base-v-chk1f8"><span class="highlight"><span class="nb">rewrite</span> &lt;- Hy; <span class="nb">clear</span> y&#39; Hy.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, x'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">x == x&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x ^ y == x&#39; ^ y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> y; <span class="nb">simpl</span>; <span class="nb">rewrite</span> ?Hx; <span class="nb">auto with</span> *.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></article></body></html>