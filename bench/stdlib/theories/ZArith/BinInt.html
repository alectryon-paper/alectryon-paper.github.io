<!DOCTYPE html>
<html><head><title>BinInt.v</title><meta charset="utf-8"><meta content="Alectryon v0.2" name="generator"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"><link href="https://unpkg.com/firacode/distr/fira_code.css" rel="stylesheet"><link href="alectryon.css" rel="stylesheet"><script src="alectryon.js"></script><style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-standalone alectryon-centered alectryon-coqdoc"><div class="alectryon-header">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running <a href="https://coq.inria.fr/">Coq</a>+<a href="https://github.com/ejgallego/coq-serapi">SerAPI</a> v8.10.0+0.7.0. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight"><span class="c">(* -*- coding: utf-8 -*- *)</span>
<span class="sd">(************************************************************************)</span>
<span class="c">(*         *   The Coq Proof Assistant / The Coq Development Team       *)</span>
<span class="c">(*  v      *   INRIA, CNRS and contributors - Copyright 1999-2018       *)</span>
<span class="c">(* &lt;O___,, *       (see CREDITS file for the list of authors)           *)</span>
<span class="c">(*   \VV/  **************************************************************)</span>
<span class="c">(*    //   *    This file is distributed under the terms of the         *)</span>
<span class="c">(*         *     GNU Lesser General Public License Version 2.1          *)</span>
<span class="c">(*         *     (see LICENSE file for the text of the license)         *)</span>
<span class="sd">(************************************************************************)</span>

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Export</span> BinNums BinPos Pnat.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> BinNat Bool Equalities GenericMinMax
 OrdersFacts ZAxioms ZProperties.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require</span> BinIntDef.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
<span class="sd">(***********************************************************)</span></span></span></pre><div class="doc">
<a name="lab1"></a><h1 class="section">Binary Integers</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight"><span class="sd">(***********************************************************)</span></span></span></pre><div class="doc">
Initial author: Pierre Cr√©gut, CNET, Lannion, France 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
The type <span class="inlinecode"><span class="id" title="var">Z</span></span> and its constructors <span class="inlinecode"><span class="id" title="var">Z0</span></span> and <span class="inlinecode"><span class="id" title="var">Zpos</span></span> and <span class="inlinecode"><span class="id" title="var">Zneg</span></span>
    are now defined in <span class="inlinecode"><span class="id" title="var">BinNums.v</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Open Scope</span> Z_scope.</span></span></span></pre><div class="doc">
Every definitions and early properties about binary integers
    are placed in a module <span class="inlinecode"><span class="id" title="var">Z</span></span> for qualification purpose. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Z</span>
 &lt;: ZAxiomsSig
 &lt;: UsualOrderedTypeFull
 &lt;: UsualDecidableTypeFull
 &lt;: TotalOrder.</span></span></span></pre><div class="doc">
<a name="lab2"></a><h1 class="section">Definitions of operations, now in a separate file</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Include</span> BinIntDef.Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> add <span class="kr">as</span> num.Z.add.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> opp <span class="kr">as</span> num.Z.opp.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> succ <span class="kr">as</span> num.Z.succ.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> pred <span class="kr">as</span> num.Z.pred.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> sub <span class="kr">as</span> num.Z.sub.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> mul <span class="kr">as</span> num.Z.mul.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> of_nat <span class="kr">as</span> num.Z.of_nat.</span></span></span></pre><div class="doc">
When including property functors, only inline t eq zero one two 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kt">Set</span> <span class="kn">Inline</span> Level <span class="mi">30</span>.</span></span></span></pre><div class="doc">
<a name="lab3"></a><h1 class="section">Logic Predicates</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eq</span> := @Logic.eq Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eq_equiv</span> := @eq_equivalence Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lt</span> <span class="nv">x</span> <span class="nv">y</span> := (x ?= y) = Lt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">gt</span> <span class="nv">x</span> <span class="nv">y</span> := (x ?= y) = Gt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">le</span> <span class="nv">x</span> <span class="nv">y</span> := (x ?= y) &lt;&gt; Gt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ge</span> <span class="nv">x</span> <span class="nv">y</span> := (x ?= y) &lt;&gt; Lt.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;=&quot;</span> := le : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;&quot;</span> := lt : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&gt;=&quot;</span> := ge : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&gt;&quot;</span> := gt : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := (x &lt;= y /\ y &lt;= z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt; z&quot;</span> := (x &lt;= y /\ y &lt; z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt; z&quot;</span> := (x &lt; y /\ y &lt; z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt;= z&quot;</span> := (x &lt; y /\ y &lt;= z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">divide</span> <span class="nv">x</span> <span class="nv">y</span> := <span class="kr">exists</span> <span class="nv">z</span>, y = z*x.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;( x | y )&quot;</span> := (divide x y) (<span class="kn">at level</span> <span class="mi">0</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Even</span> <span class="nv">a</span> := <span class="kr">exists</span> <span class="nv">b</span>, a = <span class="mi">2</span>*b.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Odd</span> <span class="nv">a</span> := <span class="kr">exists</span> <span class="nv">b</span>, a = <span class="mi">2</span>*b+<span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> le <span class="kr">as</span> num.Z.le.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> lt <span class="kr">as</span> num.Z.lt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> ge <span class="kr">as</span> num.Z.ge.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> gt <span class="kr">as</span> num.Z.gt.</span></span></span></pre><div class="doc">
<a name="lab4"></a><h1 class="section">Decidability of equality.</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk0"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eq_dec</span> (<span class="nv">x</span> <span class="nv">y</span> : Z) : {x = y} + {x &lt;&gt; y}.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">{x = y} + {x &lt;&gt; y}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">{x = y} + {x &lt;&gt; y}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">decide equality</span>; <span class="nb">apply</span> Pos.eq_dec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span></span></pre><div class="doc">
<a name="lab5"></a><h1 class="section">Proofs of morphisms, obvious since eq is Leibniz</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Obligation Tactic</span> := simpl_relation.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">succ_wd</span> : Proper (eq==&gt;eq) succ := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">pred_wd</span> : Proper (eq==&gt;eq) pred := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">opp_wd</span> : Proper (eq==&gt;eq) opp := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">add_wd</span> : Proper (eq==&gt;eq==&gt;eq) add := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">sub_wd</span> : Proper (eq==&gt;eq==&gt;eq) sub := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mul_wd</span> : Proper (eq==&gt;eq==&gt;eq) mul := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lt_wd</span> : Proper (eq==&gt;eq==&gt;iff) lt := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">div_wd</span> : Proper (eq==&gt;eq==&gt;eq) div := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mod_wd</span> : Proper (eq==&gt;eq==&gt;eq) modulo := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">quot_wd</span> : Proper (eq==&gt;eq==&gt;eq) quot := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">rem_wd</span> : Proper (eq==&gt;eq==&gt;eq) rem := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">pow_wd</span> : Proper (eq==&gt;eq==&gt;eq) pow := _.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">testbit_wd</span> : Proper (eq==&gt;eq==&gt;Logic.eq) testbit := _.</span></span></span></pre><div class="doc">
<a name="lab6"></a><h1 class="section">Properties of <span class="inlinecode"><span class="id" title="var">pos_sub</span></span></h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">pos_sub</span></span> can be written in term of positive comparison
    and subtraction (cf. earlier definition of addition of Z) 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_spec</span> <span class="nv">p</span> <span class="nv">q</span> :
 pos_sub p q =
 <span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
   | Eq =&gt; <span class="mi">0</span>
   | Lt =&gt; neg (q - p)
   | Gt =&gt; pos (p - q)
 <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p q =
<span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (q - p)
| Gt =&gt; pos (p - q)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p q =
<span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (q - p)
| Gt =&gt; pos (p - q)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk4"><span class="highlight"><span class="nb">revert</span> q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">q</span> : positive,
pos_sub p q =
<span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (q - p)
| Gt =&gt; pos (p - q)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> p; <span class="nb">destruct</span> q; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
 <span class="nb">rewrite</span> ?Pos.compare_xI_xI, ?Pos.compare_xO_xI,
  ?Pos.compare_xI_xO, ?Pos.compare_xO_xO, IHp; <span class="nb">simpl</span>;
 <span class="nb">case</span> Pos.compare_spec; <span class="nb">intros</span>; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
  (<span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_xI_xI) || (<span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_xO_xO) ||
  (<span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_xO_xI) || (<span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_xI_xO) ||
  <span class="nb">subst</span>; <span class="nb">unfold</span> Pos.sub; <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_mask_diag.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_discr</span> <span class="nv">p</span> <span class="nv">q</span> :
  <span class="kr">match</span> pos_sub p q <span class="kr">with</span>
  | Z0 =&gt; p = q
  | pos k =&gt; p = q + k
  | neg k =&gt; q = p + k
  <span class="kr">end</span>%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> pos_sub p q <span class="kr">with</span>
| <span class="mi">0</span> =&gt; p = q
| pos k =&gt; p = (q + k)%positive
| neg k =&gt; q = (p + k)%positive
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> pos_sub p q <span class="kr">with</span>
| <span class="mi">0</span> =&gt; p = q
| pos k =&gt; p = (q + k)%positive
| neg k =&gt; q = (p + k)%positive
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7"><span class="highlight"><span class="nb">rewrite</span> pos_sub_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span>
  <span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (q - p)
  | Gt =&gt; pos (p - q)
  <span class="kr">end</span>
<span class="kr">with</span>
| <span class="mi">0</span> =&gt; p = q
| pos k =&gt; p = (q + k)%positive
| neg k =&gt; q = (p + k)%positive
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">case</span> Pos.compare_spec; <span class="nb">auto</span>; <span class="nb">intros</span>;
  <span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_comm, Pos.sub_add.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Particular cases of the previous result 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_diag</span> <span class="nv">p</span> : pos_sub p p = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p p = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p p = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> pos_sub_spec, Pos.compare_refl.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_lt</span> <span class="nv">p</span> <span class="nv">q</span> : (p &lt; q)%positive -&gt; pos_sub p q = neg (q - p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt; q)%positive -&gt; pos_sub p q = neg (q - p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt; q)%positive -&gt; pos_sub p q = neg (q - p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkc"><span class="highlight"><span class="nb">intros</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p q = neg (q - p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> pos_sub_spec, H.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_gt</span> <span class="nv">p</span> <span class="nv">q</span> : (q &lt; p)%positive -&gt; pos_sub p q = pos (p - q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt; p)%positive -&gt; pos_sub p q = pos (p - q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt; p)%positive -&gt; pos_sub p q = pos (p - q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf"><span class="highlight"><span class="nb">intros</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p q = pos (p - q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> pos_sub_spec, Pos.compare_antisym, H.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
The opposite of <span class="inlinecode"><span class="id" title="var">pos_sub</span></span> is <span class="inlinecode"><span class="id" title="var">pos_sub</span></span> with reversed arguments 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk10" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk10"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_opp</span> <span class="nv">p</span> <span class="nv">q</span> : - pos_sub p q = pos_sub q p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- pos_sub p q = pos_sub q p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk11" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk11"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- pos_sub p q = pos_sub q p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">revert</span> q; <span class="nb">induction</span> p; <span class="nb">destruct</span> q; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
 <span class="nb">rewrite</span> &lt;- IHp; <span class="bp">now</span> <span class="nb">destruct</span> pos_sub.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
In the following module, we group results that are needed now
  to prove specifications of operations, but will also be provided
  later by the generic functor of properties. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Import</span> Private_BootStrap.</span></span></span></pre><div class="doc">
<a name="lab7"></a><h2 class="section">Operations and constants</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk12" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk12"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_0_r</span> <span class="nv">n</span> : n + <span class="mi">0</span> = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + <span class="mi">0</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk13" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk13"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + <span class="mi">0</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk14" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk14"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_0_r</span> <span class="nv">n</span> : n * <span class="mi">0</span> = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n * <span class="mi">0</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n * <span class="mi">0</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk16" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk16"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_1_l</span> <span class="nv">n</span> : <span class="mi">1</span> * n = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> * n = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk17" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk17"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> * n = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab8"></a><h2 class="section">Addition is commutative</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk18" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk18"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_comm</span> <span class="nv">n</span> <span class="nv">m</span> : n + m = m + n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + m = m + n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk19" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk19"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + m = m + n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="nb">trivial</span>; <span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab9"></a><h2 class="section">Opposite distributes over addition</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_add_distr</span> <span class="nv">n</span> <span class="nv">m</span> : - (n + m) = - n + - m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- (n + m) = - n + - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- (n + m) = - n + - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="nb">trivial using</span> pos_sub_opp.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab10"></a><h2 class="section">Opposite is injective</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_inj</span> <span class="nv">n</span> <span class="nv">m</span> : -n = -m -&gt; n = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- n = - m -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- n = - m -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="nb">intros</span> H; destr_eq H; <span class="bp">now</span> <span class="nb">f_equal</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab11"></a><h2 class="section">Addition is associative</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_sub_add</span> <span class="nv">p</span> <span class="nv">q</span> <span class="nv">r</span> :
  pos_sub (p + q) r = pos p + pos_sub q r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub (p + q) r = pos p + pos_sub q r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub (p + q) r = pos p + pos_sub q r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk20" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk20"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub (p + q) r =
<span class="kr">match</span> pos_sub q r <span class="kr">with</span>
| <span class="mi">0</span> =&gt; pos p
| pos y&#39; =&gt; pos (p + y&#39;)
| neg y&#39; =&gt; pos_sub p y&#39;
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21"><span class="highlight"><span class="nb">rewrite</span> !pos_sub_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> =
<span class="kr">match</span>
  <span class="kr">match</span> (q ?= r)%positive <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (r - q)
  | Gt =&gt; pos (q - r)
  <span class="kr">end</span>
<span class="kr">with</span>
| <span class="mi">0</span> =&gt; pos p
| pos y&#39; =&gt; pos (p + y&#39;)
| neg y&#39; =&gt; pos_sub p y&#39;
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22"><span class="highlight"><span class="nb">case</span> (Pos.compare_spec q r); <span class="nb">intros</span> E0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">q = r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk23" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk23"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos_sub p (r - q)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk24" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk24"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos (p + (q - r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk25" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk25"><span class="highlight">- <span class="c">(* q = r *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">q = r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26"><span class="highlight"><span class="nb">subst</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + r ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + r))
| Gt =&gt; pos (p + r - r)
<span class="kr">end</span> = pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk27" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk27"><span class="highlight"><span class="nb">assert</span> (H := Pos.lt_add_r r p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; r + p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + r ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + r))
| Gt =&gt; pos (p + r - r)
<span class="kr">end</span> = pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28"><span class="highlight"><span class="nb">rewrite</span> Pos.add_comm <span class="kr">in</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; p + r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + r ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + r))
| Gt =&gt; pos (p + r - r)
<span class="kr">end</span> = pos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk29" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk29"><span class="highlight"><span class="nb">apply</span> Pos.lt_gt <span class="kr">in</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p + r &gt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + r ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + r))
| Gt =&gt; pos (p + r - r)
<span class="kr">end</span> = pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> H, Pos.add_sub.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a"><span class="highlight">- <span class="c">(* q &lt; r *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos_sub p (r - q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2b"><span class="highlight"><span class="nb">rewrite</span> pos_sub_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> =
<span class="kr">match</span> (p ?= r - q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - q - p)
| Gt =&gt; pos (p - (r - q))
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c"><span class="highlight"><span class="nb">assert</span> (Hr : (r = (r-q)+q)%positive) <span class="bp">by</span> (<span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_add).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> =
<span class="kr">match</span> (p ?= r - q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - q - p)
| Gt =&gt; pos (p - (r - q))
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2d"><span class="highlight"><span class="nb">rewrite</span> Hr <span class="nb">at</span> <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r - q + q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> =
<span class="kr">match</span> (p ?= r - q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - q - p)
| Gt =&gt; pos (p - (r - q))
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2e"><span class="highlight"><span class="nb">rewrite</span> Pos.add_compare_mono_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p ?= r - q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> =
<span class="kr">match</span> (p ?= r - q)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - q - p)
| Gt =&gt; pos (p - (r - q))
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2f"><span class="highlight"><span class="nb">case</span> Pos.compare_spec; <span class="nb">intros</span> E1; <span class="nb">trivial</span>; <span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; r - q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(r - (p + q))%positive = (r - q - p)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk30" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r - q &lt; p)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk30"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q - r)%positive = (p - (r - q))%positive</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk31" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk31"><span class="highlight"><span class="nb">rewrite</span> Pos.add_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; r - q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(r - (q + p))%positive = (r - q - p)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk32" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r - q &lt; p)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk32"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q - r)%positive = (p - (r - q))%positive</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk33" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk33"><span class="highlight"><span class="nb">apply</span> Pos.sub_add_distr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; r - q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q + p &lt; r)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk34" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r - q &lt; p)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk34"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q - r)%positive = (p - (r - q))%positive</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk35" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk35"><span class="highlight"><span class="nb">rewrite</span> Hr, Pos.add_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; r - q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q &lt; r - q + q)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk36" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r - q &lt; p)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk36"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q - r)%positive = (p - (r - q))%positive</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.add_lt_mono_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r - q &lt; p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q - r)%positive = (p - (r - q))%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; r)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = (r - q + q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r - q &lt; p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p - (r - q))%positive = (p + q - r)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Pos.sub_sub_distr; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39"><span class="highlight">- <span class="c">(* r &lt; q *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos (p + (q - r))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a"><span class="highlight"><span class="nb">assert</span> (LT : (r &lt; p + q)%positive).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(r &lt; p + q)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk3b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; p + q)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk3b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos (p + (q - r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c"><span class="highlight">{</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(r &lt; p + q)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d"><span class="highlight"><span class="nb">apply</span> Pos.lt_trans <span class="kr">with</span> q; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt; p + q)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e"><span class="highlight"><span class="nb">rewrite</span> Pos.add_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt; q + p)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Pos.lt_add_r.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f"><span class="highlight">}</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; p + q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos (p + (q - r))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40"><span class="highlight"><span class="nb">apply</span> Pos.lt_gt <span class="kr">in</span> LT.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p + q &gt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> (p + q ?= r)%positive <span class="kr">with</span>
| Eq =&gt; <span class="mi">0</span>
| Lt =&gt; neg (r - (p + q))
| Gt =&gt; pos (p + q - r)
<span class="kr">end</span> = pos (p + (q - r))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41"><span class="highlight"><span class="nb">rewrite</span> LT.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p + q &gt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (p + q - r) = pos (p + (q - r))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p + q &gt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p + q - r)%positive = (p + (q - r))%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">E0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r &lt; q)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p + q &gt; r)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p + (q - r))%positive = (p + q - r)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.add_sub_assoc.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Arguments</span> add !x !y.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_assoc_pos</span> <span class="nv">p</span> <span class="nv">n</span> <span class="nv">m</span> : pos p + (n + m) = pos p + n + m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p + (n + m) = pos p + n + m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p + (n + m) = pos p + n + m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk46" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk46"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|n|n], m <span class="kr">as</span> [|m|m]; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (p + (n + m)) = pos (p + n + m)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk47" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk47"><hr></label><div class="goal-conclusion"><span class="highlight">pos p + pos_sub n m = pos_sub (p + n) m</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk48" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk48"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p n = pos_sub p n + <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk49" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk49"><hr></label><div class="goal-conclusion"><span class="highlight">pos p + pos_sub m n = pos_sub p n + pos m</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk4a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk4a"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p (n + m) = pos_sub p n + neg m</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk4b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk4b"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (p + (n + m)) = pos (p + n + m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_assoc.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk4c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk4c"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p + pos_sub n m = pos_sub (p + n) m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk4d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk4d"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub (p + n) m = pos p + pos_sub n m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> pos_sub_add.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk4e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk4e"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p n = pos_sub p n + <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk4f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk4f"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p n + <span class="mi">0</span> = pos_sub p n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> add_0_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk50" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk50"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p + pos_sub m n = pos_sub p n + pos m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- pos_sub_add, add_comm, &lt;- pos_sub_add, Pos.add_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk51" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk51"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub p (n + m) = pos_sub p n + neg m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk52" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk52"><span class="highlight"><span class="nb">apply</span> opp_inj.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- pos_sub p (n + m) = - (pos_sub p n + neg m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk53" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk53"><span class="highlight"><span class="nb">rewrite</span> !opp_add_distr, !pos_sub_opp.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub (n + m) p = pos_sub n p + - neg m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk54" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk54"><span class="highlight"><span class="nb">rewrite</span> add_comm, Pos.add_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub (m + n) p = - neg m + pos_sub n p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> pos_sub_add.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk55" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk55"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_assoc</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : n + (m + p) = n + m + p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + (m + p) = n + m + p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk56" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk56"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + (m + p) = n + m + p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk57" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk57"><span class="highlight"><span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> + (m + p) = <span class="mi">0</span> + m + p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk58" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk58"><hr></label><div class="goal-conclusion"><span class="highlight">pos p0 + (m + p) = pos p0 + m + p</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk59" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk59"><hr></label><div class="goal-conclusion"><span class="highlight">neg p0 + (m + p) = neg p0 + m + p</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5a"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> + (m + p) = <span class="mi">0</span> + m + p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5b"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p0 + (m + p) = pos p0 + m + p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> add_assoc_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5c"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg p0 + (m + p) = neg p0 + m + p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5d"><span class="highlight"><span class="nb">apply</span> opp_inj.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- (neg p0 + (m + p)) = - (neg p0 + m + p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5e"><span class="highlight"><span class="nb">rewrite</span> !opp_add_distr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- neg p0 + (- m + - p) = - neg p0 + - m + - p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk5f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk5f"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p0 + (- m + - p) = pos p0 + - m + - p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> add_assoc_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab12"></a><h2 class="section">Opposite is inverse for addition</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk60" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk60"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_opp_diag_r</span> <span class="nv">n</span> : n + - n = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + - n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk61" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk61"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + - n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n; <span class="nb">simpl</span>; <span class="nb">trivial</span>; <span class="bp">now</span> <span class="nb">rewrite</span> pos_sub_diag.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab13"></a><h2 class="section">Multiplication and Opposite</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk62" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk62"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_opp_r</span> <span class="nv">n</span> <span class="nv">m</span> : n * - m = - (n * m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n * - m = - (n * m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk63" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk63"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n * - m = - (n * m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n, m.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab14"></a><h2 class="section">Distributivity of multiplication over addition</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk64" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk64"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_add_distr_pos</span> (<span class="nv">p</span>:positive) <span class="nv">n</span> <span class="nv">m</span> :
 (n + m) * pos p = n * pos p + m * pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * pos p = n * pos p + m * pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk65" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk65"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * pos p = n * pos p + m * pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk66" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk66"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|n|n], m <span class="kr">as</span> [|m|m]; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos ((n + m) * p) = pos (n * p + m * p)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk67" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk67"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub n m * pos p = pos_sub (n * p) (m * p)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk68" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk68"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub m n * pos p = pos_sub (m * p) (n * p)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk69" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk69"><hr></label><div class="goal-conclusion"><span class="highlight">neg ((n + m) * p) = neg (n * p + m * p)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6a"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos ((n + m) * p) = pos (n * p + m * p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.mul_add_distr_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6b"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub n m * pos p = pos_sub (n * p) (m * p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> ?pos_sub_spec, ?Pos.mul_compare_mono_r; <span class="nb">case</span> Pos.compare_spec;
   <span class="nb">simpl</span>; <span class="nb">trivial</span>; <span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">rewrite</span> Pos.mul_sub_distr_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6c"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos_sub m n * pos p = pos_sub (m * p) (n * p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> ?pos_sub_spec, ?Pos.mul_compare_mono_r; <span class="nb">case</span> Pos.compare_spec;
   <span class="nb">simpl</span>; <span class="nb">trivial</span>; <span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">rewrite</span> Pos.mul_sub_distr_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6d"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg ((n + m) * p) = neg (n * p + m * p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.mul_add_distr_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_add_distr_r</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : (n + m) * p = n * p + m * p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * p = n * p + m * p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk6f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk6f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * p = n * p + m * p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk70" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk70"><span class="highlight"><span class="nb">destruct</span> p <span class="kr">as</span> [|p|p].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * <span class="mi">0</span> = n * <span class="mi">0</span> + m * <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk71" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk71"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * pos p = n * pos p + m * pos p</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk72" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk72"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * neg p = n * neg p + m * neg p</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk73" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk73"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * <span class="mi">0</span> = n * <span class="mi">0</span> + m * <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> !mul_0_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk74" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk74"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * pos p = n * pos p + m * pos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> mul_add_distr_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk75" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk75"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * neg p = n * neg p + m * neg p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk76" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk76"><span class="highlight"><span class="nb">apply</span> opp_inj.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- ((n + m) * neg p) = - (n * neg p + m * neg p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk77" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk77"><span class="highlight"><span class="nb">rewrite</span> opp_add_distr, &lt;- !mul_opp_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m) * - neg p = n * - neg p + m * - neg p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> mul_add_distr_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Private_BootStrap</span>.</span></span></span></pre><div class="doc">
<a name="lab15"></a><h1 class="section">Proofs of specifications</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<a name="lab16"></a><h2 class="section">Specification of constants</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk78" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk78"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">one_succ</span> : <span class="mi">1</span> = succ <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = succ <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk79" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk79"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = succ <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">two_succ</span> : <span class="mi">2</span> = succ <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> = succ <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> = succ <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab17"></a><h2 class="section">Specification of addition</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_0_l</span> <span class="nv">n</span> : <span class="mi">0</span> + n = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> + n = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> + n = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_succ_l</span> <span class="nv">n</span> <span class="nv">m</span> : succ n + m = succ (n + m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ n + m = succ (n + m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk7f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk7f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ n + m = succ (n + m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk80" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk80"><span class="highlight"><span class="nb">unfold</span> succ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + <span class="mi">1</span> + m = n + m + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> <span class="mi">2</span> (add_comm _ <span class="mi">1</span>), add_assoc.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab18"></a><h2 class="section">Specification of opposite</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk81" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk81"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_0</span> : -<span class="mi">0</span> = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- <span class="mi">0</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk82" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk82"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- <span class="mi">0</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk83" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk83"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_succ</span> <span class="nv">n</span> : -(succ n) = pred (-n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- succ n = pred (- n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk84" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk84"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- succ n = pred (- n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk85" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk85"><span class="highlight"><span class="nb">unfold</span> succ, pred.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- (n + <span class="mi">1</span>) = - n + -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> opp_add_distr.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab19"></a><h2 class="section">Specification of successor and predecessor</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Arguments</span> pos_sub : <span class="nb">simpl</span> nomatch.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk86" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk86"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">succ_pred</span> <span class="nv">n</span> : succ (pred n) = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ (pred n) = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk87" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk87"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ (pred n) = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk88" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk88"><span class="highlight"><span class="nb">unfold</span> succ, pred.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + -<span class="mi">1</span> + <span class="mi">1</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- add_assoc, add_opp_diag_r, add_0_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk89" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk89"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pred_succ</span> <span class="nv">n</span> : pred (succ n) = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pred (succ n) = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pred (succ n) = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8b"><span class="highlight"><span class="nb">unfold</span> succ, pred.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + <span class="mi">1</span> + -<span class="mi">1</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- add_assoc, add_opp_diag_r, add_0_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab20"></a><h2 class="section">Specification of subtraction</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sub_0_r</span> <span class="nv">n</span> : n - <span class="mi">0</span> = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n - <span class="mi">0</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n - <span class="mi">0</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> add_0_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sub_succ_r</span> <span class="nv">n</span> <span class="nv">m</span> : n - succ m = pred (n - m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n - succ m = pred (n - m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk8f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk8f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n - succ m = pred (n - m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk90" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk90"><span class="highlight"><span class="nb">unfold</span> sub, succ, pred.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + - (m + <span class="mi">1</span>) = n + - m + -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> opp_add_distr, add_assoc.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab21"></a><h2 class="section">Specification of multiplication</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk91" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk91"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_0_l</span> <span class="nv">n</span> : <span class="mi">0</span> * n = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> * n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk92" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk92"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> * n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk93" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk93"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_succ_l</span> <span class="nv">n</span> <span class="nv">m</span> : succ n * m = n * m + m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ n * m = n * m + m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk94" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk94"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ n * m = n * m + m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk95" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk95"><span class="highlight"><span class="nb">unfold</span> succ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + <span class="mi">1</span>) * m = n * m + m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> mul_add_distr_r, mul_1_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab22"></a><h2 class="section">Specification of comparisons and order</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk96" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk96"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eqb_eq</span> <span class="nv">n</span> <span class="nv">m</span> : (n =? m) = true &lt;-&gt; n = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n =? m) = true &lt;-&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk97" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk97"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n =? m) = true &lt;-&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="kp">try</span> (<span class="bp">now</span> <span class="nb">split</span>); <span class="nb">rewrite</span> Pos.eqb_eq;
 <span class="nb">split</span>; (<span class="bp">now</span> <span class="nb">injection</span> <span class="mi">1</span>) || (<span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">f_equal</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk98" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk98"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ltb_lt</span> <span class="nv">n</span> <span class="nv">m</span> : (n &lt;? m) = true &lt;-&gt; n &lt; m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &lt;? m) = true &lt;-&gt; n &lt; m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk99" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk99"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &lt;? m) = true &lt;-&gt; n &lt; m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9a"><span class="highlight"><span class="nb">unfold</span> ltb, lt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> n ?= m <span class="kr">with</span>
| Lt =&gt; true
| _ =&gt; false
<span class="kr">end</span> = true &lt;-&gt; (n ?= m) = Lt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> <span class="nb">compare</span>; easy&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">leb_le</span> <span class="nv">n</span> <span class="nv">m</span> : (n &lt;=? m) = true &lt;-&gt; n &lt;= m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &lt;=? m) = true &lt;-&gt; n &lt;= m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &lt;=? m) = true &lt;-&gt; n &lt;= m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9d"><span class="highlight"><span class="nb">unfold</span> leb, le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> n ?= m <span class="kr">with</span>
| Gt =&gt; false
| _ =&gt; true
<span class="kr">end</span> = true &lt;-&gt; (n ?= m) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> <span class="nb">compare</span>; easy&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_eq_iff</span> <span class="nv">n</span> <span class="nv">m</span> : (n ?= m) = Eq &lt;-&gt; n = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = Eq &lt;-&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk9f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk9f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = Eq &lt;-&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="nb">rewrite</span> ?CompOpp_iff, ?Pos.compare_eq_iff;
 <span class="nb">split</span>; <span class="bp">congruence</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_sub</span> <span class="nv">n</span> <span class="nv">m</span> : (n ?= m) = (n - m ?= <span class="mi">0</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = (n - m ?= <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = (n - m ?= <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|n|n], m <span class="kr">as</span> [|m|m]; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
 <span class="nb">rewrite</span> &lt;- ? Pos.compare_antisym, ?pos_sub_spec;
 <span class="nb">case</span> Pos.compare_spec; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_antisym</span> <span class="nv">n</span> <span class="nv">m</span> : (m ?= n) = CompOpp (n ?= m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m ?= n) = CompOpp (n ?= m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m ?= n) = CompOpp (n ?= m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="nb">trivial</span>; <span class="bp">now</span> <span class="nb">rewrite</span> &lt;- ?Pos.compare_antisym.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_lt_iff</span> <span class="nv">n</span> <span class="nv">m</span> : (n ?= m) = Lt &lt;-&gt; n &lt; m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = Lt &lt;-&gt; n &lt; m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = Lt &lt;-&gt; n &lt; m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_le_iff</span> <span class="nv">n</span> <span class="nv">m</span> : (n ?= m) &lt;&gt; Gt &lt;-&gt; n &lt;= m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) &lt;&gt; Gt &lt;-&gt; n &lt;= m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) &lt;&gt; Gt &lt;-&gt; n &lt;= m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Some more advanced properties of comparison and orders,
    including <span class="inlinecode"><span class="id" title="var">compare_spec</span></span> and <span class="inlinecode"><span class="id" title="var">lt_irrefl</span></span> and <span class="inlinecode"><span class="id" title="var">lt_eq_cases</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Include</span> BoolOrderFacts.</span></span></span></pre><div class="doc">
Remaining specification of <span class="inlinecode"><span class="id" title="var">lt</span></span> and <span class="inlinecode"><span class="id" title="var">le</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_succ_r</span> <span class="nv">n</span> <span class="nv">m</span> : n &lt; succ m &lt;-&gt; n&lt;=m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; succ m &lt;-&gt; n &lt;= m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chka9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chka9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; succ m &lt;-&gt; n &lt;= m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkaa" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkaa"><span class="highlight"><span class="nb">unfold</span> lt, le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= succ m) = Lt &lt;-&gt; (n ?= m) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkab" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkab"><span class="highlight"><span class="nb">rewrite</span> compare_sub, sub_succ_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pred (n - m) ?= <span class="mi">0</span>) = Lt &lt;-&gt; (n ?= m) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkac" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkac"><span class="highlight"><span class="nb">rewrite</span> (compare_sub n m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pred (n - m) ?= <span class="mi">0</span>) = Lt &lt;-&gt; (n - m ?= <span class="mi">0</span>) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (n-m) <span class="kr">as</span> [|[ | | ]|]; easy&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab23"></a><h2 class="section">Specification of minimum and maximum</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkad" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkad"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">max_l</span> <span class="nv">n</span> <span class="nv">m</span> : m&lt;=n -&gt; max n m = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; max n m = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkae" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkae"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; max n m = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkaf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkaf"><span class="highlight"><span class="nb">unfold</span> le, max.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m ?= n) &lt;&gt; Gt -&gt;
<span class="kr">match</span> n ?= m <span class="kr">with</span>
| Lt =&gt; m
| _ =&gt; n
<span class="kr">end</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb0"><span class="highlight"><span class="nb">rewrite</span> (compare_antisym n m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">CompOpp (n ?= m) &lt;&gt; Gt -&gt;
<span class="kr">match</span> n ?= m <span class="kr">with</span>
| Lt =&gt; m
| _ =&gt; n
<span class="kr">end</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">case</span> <span class="nb">compare</span>; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">max_r</span> <span class="nv">n</span> <span class="nv">m</span> :  n&lt;=m -&gt; max n m = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= m -&gt; max n m = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= m -&gt; max n m = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb3"><span class="highlight"><span class="nb">unfold</span> le, max.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) &lt;&gt; Gt -&gt;
<span class="kr">match</span> n ?= m <span class="kr">with</span>
| Lt =&gt; m
| _ =&gt; n
<span class="kr">end</span> = m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">case</span> compare_spec; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">min_l</span> <span class="nv">n</span> <span class="nv">m</span> : n&lt;=m -&gt; min n m = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= m -&gt; min n m = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= m -&gt; min n m = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb6"><span class="highlight"><span class="nb">unfold</span> le, min.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) &lt;&gt; Gt -&gt;
<span class="kr">match</span> n ?= m <span class="kr">with</span>
| Gt =&gt; m
| _ =&gt; n
<span class="kr">end</span> = n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">case</span> compare_spec; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">min_r</span> <span class="nv">n</span> <span class="nv">m</span> : m&lt;=n -&gt; min n m = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; min n m = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; min n m = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkb9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkb9"><span class="highlight"><span class="nb">unfold</span> le, min.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m ?= n) &lt;&gt; Gt -&gt;
<span class="kr">match</span> n ?= m <span class="kr">with</span>
| Gt =&gt; m
| _ =&gt; n
<span class="kr">end</span> = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkba" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkba"><span class="highlight"><span class="nb">rewrite</span> (compare_antisym n m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">CompOpp (n ?= m) &lt;&gt; Gt -&gt;
<span class="kr">match</span> n ?= m <span class="kr">with</span>
| Gt =&gt; m
| _ =&gt; n
<span class="kr">end</span> = m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">case</span> compare_spec; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab24"></a><h2 class="section">Induction principles based on successor / predecessor</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkbb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkbb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">peano_ind</span> (<span class="nv">P</span> : Z -&gt; <span class="kt">Prop</span>) :
  P <span class="mi">0</span> -&gt;
  (<span class="kr">forall</span> <span class="nv">x</span>, P x -&gt; P (succ x)) -&gt;
  (<span class="kr">forall</span> <span class="nv">x</span>, P x -&gt; P (pred x)) -&gt;
  <span class="kr">forall</span> <span class="nv">z</span>, P z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P <span class="mi">0</span> -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)) -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)) -&gt; <span class="kr">forall</span> <span class="nv">z</span> : Z, P z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkbc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkbc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P <span class="mi">0</span> -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)) -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)) -&gt; <span class="kr">forall</span> <span class="nv">z</span> : Z, P z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkbd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkbd"><span class="highlight"><span class="nb">intros</span> H0 Hs Hp z; <span class="nb">destruct</span> z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkbe" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkbe"><hr></label><div class="goal-conclusion"><span class="highlight">P (pos p)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chkbf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkbf"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg p)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkc0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkc0"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (pos p)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkc1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkc1"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg p)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkc2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkc2"><span class="highlight"><span class="nb">induction</span> p <span class="nb">using</span> Pos.peano_ind.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkc3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P (pos p)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkc3"><hr></label><div class="goal-conclusion"><span class="highlight">P (pos (Pos.succ p))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chkc4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkc4"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg p)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkc5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkc5"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (Hs <span class="mi">0</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P (pos p)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (pos (Pos.succ p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkc6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkc6"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg p)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkc7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkc7"><span class="highlight"><span class="nb">rewrite</span> &lt;- Pos.add_1_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P (pos p)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (pos (p + <span class="mi">1</span>))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkc8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkc8"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg p)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkc9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkc9"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (Hs (pos p)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkca" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkca"><span class="highlight"><span class="nb">induction</span> p <span class="nb">using</span> Pos.peano_ind.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (-<span class="mi">1</span>)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkcb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P (neg p)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkcb"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg (Pos.succ p))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkcc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkcc"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (Hp <span class="mi">0</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P (neg p)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg (Pos.succ p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkcd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkcd"><span class="highlight"><span class="nb">rewrite</span> &lt;- Pos.add_1_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x -&gt; P (pred x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P (neg p)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (neg (p + <span class="mi">1</span>))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (Hp (neg p)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkce" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkce"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bi_induction</span> (<span class="nv">P</span> : Z -&gt; <span class="kt">Prop</span>) :
  Proper (eq ==&gt; iff) P -&gt;
  P <span class="mi">0</span> -&gt;
  (<span class="kr">forall</span> <span class="nv">x</span>, P x &lt;-&gt; P (succ x)) -&gt;
  <span class="kr">forall</span> <span class="nv">z</span>, P z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Proper (eq ==&gt; iff) P -&gt;
P <span class="mi">0</span> -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)) -&gt;
<span class="kr">forall</span> <span class="nv">z</span> : Z, P z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkcf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkcf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Proper (eq ==&gt; iff) P -&gt;
P <span class="mi">0</span> -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)) -&gt;
<span class="kr">forall</span> <span class="nv">z</span> : Z, P z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd0"><span class="highlight"><span class="nb">intros</span> _ H0 Hs.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, P z</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd1"><span class="highlight"><span class="nb">induction</span> z <span class="nb">using</span> peano_ind.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkd2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHz</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkd2"><hr></label><div class="goal-conclusion"><span class="highlight">P (succ z)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chkd3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHz</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkd3"><hr></label><div class="goal-conclusion"><span class="highlight">P (pred z)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd4"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHz</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (succ z)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkd5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHz</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkd5"><hr></label><div class="goal-conclusion"><span class="highlight">P (pred z)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd6"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> -&gt; Hs.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHz</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (pred z)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd7"><span class="highlight"><span class="nb">apply</span> Hs.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; <span class="kt">Prop</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Z, P x &lt;-&gt; P (succ x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHz</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">P z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">P (succ (pred z))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> succ_pred.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
We can now derive all properties of basic functions and orders,
    and use these properties for proving the specs of more advanced
    functions. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Include</span> ZBasicProp &lt;+ UsualMinMaxLogicalProperties &lt;+ UsualMinMaxDecProperties.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> eq_decidable <span class="kr">as</span> num.Z.eq_decidable.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> le_decidable <span class="kr">as</span> num.Z.le_decidable.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> lt_decidable <span class="kr">as</span> num.Z.lt_decidable.</span></span></span></pre><div class="doc">
<a name="lab25"></a><h2 class="section">Specification of absolute value</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">abs_eq</span> <span class="nv">n</span> : <span class="mi">0</span> &lt;= n -&gt; abs n = n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; abs n = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkd9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkd9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; abs n = n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkda" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkda"><span class="highlight"><span class="nb">destruct</span> n; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt; abs (neg p) = neg p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkdb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkdb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">abs_neq</span> <span class="nv">n</span> : n &lt;= <span class="mi">0</span> -&gt; abs n = - n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= <span class="mi">0</span> -&gt; abs n = - n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkdc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkdc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= <span class="mi">0</span> -&gt; abs n = - n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkdd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkdd"><span class="highlight"><span class="nb">destruct</span> n; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p &lt;= <span class="mi">0</span> -&gt; abs (pos p) = - pos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab26"></a><h2 class="section">Specification of sign</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkde" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkde"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sgn_null</span> <span class="nv">n</span> : n = <span class="mi">0</span> -&gt; sgn n = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n = <span class="mi">0</span> -&gt; sgn n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkdf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkdf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n = <span class="mi">0</span> -&gt; sgn n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke0"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n = <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">sgn n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">subst</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sgn_pos</span> <span class="nv">n</span> : <span class="mi">0</span> &lt; n -&gt; sgn n = <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; n -&gt; sgn n = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; n -&gt; sgn n = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sgn_neg</span> <span class="nv">n</span> : n &lt; <span class="mi">0</span> -&gt; sgn n = -<span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; <span class="mi">0</span> -&gt; sgn n = -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; <span class="mi">0</span> -&gt; sgn n = -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab27"></a><h2 class="section">Specification of power</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pow_0_r</span> <span class="nv">n</span> : n^<span class="mi">0</span> = <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n ^ <span class="mi">0</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n ^ <span class="mi">0</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pow_succ_r</span> <span class="nv">n</span> <span class="nv">m</span> : <span class="mi">0</span>&lt;=m -&gt; n^(succ m) = n * n^m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= m -&gt; n ^ succ m = n * n ^ m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= m -&gt; n ^ succ m = n * n ^ m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chke9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chke9"><span class="highlight"><span class="nb">destruct</span> m <span class="kr">as</span> [|m|m]; (<span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>) || (<span class="nb">intros</span> _); <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pow_pos n (m + <span class="mi">1</span>) = n * pow_pos n m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkea" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkea"><span class="highlight"><span class="nb">unfold</span> pow_pos.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Pos.iter (mul n) <span class="mi">1</span> (m + <span class="mi">1</span>) = n * Pos.iter (mul n) <span class="mi">1</span> m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_comm, Pos.iter_add.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkeb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkeb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pow_neg_r</span> <span class="nv">n</span> <span class="nv">m</span> : m&lt;<span class="mi">0</span> -&gt; n^m = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt; <span class="mi">0</span> -&gt; n ^ m = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkec" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkec"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt; <span class="mi">0</span> -&gt; n ^ m = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> m.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
For folding back a <span class="inlinecode"><span class="id" title="var">pow_pos</span></span> into a <span class="inlinecode"><span class="id" title="var">pow</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chked" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chked"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pow_pos_fold</span> <span class="nv">n</span> <span class="nv">p</span> : pow_pos n p = n ^ (pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pow_pos n p = n ^ pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkee" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkee"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pow_pos n p = n ^ pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab28"></a><h2 class="section">Specification of square</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkef" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkef"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">square_spec</span> <span class="nv">n</span> : square n = n * n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">square n = n * n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">square n = n * n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n; <span class="nb">trivial</span>; <span class="nb">simpl</span>; <span class="nb">f_equal</span>; <span class="nb">apply</span> Pos.square_spec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab29"></a><h2 class="section">Specification of square root</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sqrtrem_spec</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 <span class="kr">let</span> (<span class="nv">s</span>,r) := sqrtrem n <span class="kr">in</span> n = s*s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span>*s.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem n <span class="kr">in</span>
n = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem n <span class="kr">in</span>
n = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf3"><span class="highlight"><span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">0</span> -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem <span class="mi">0</span> <span class="kr">in</span>
<span class="mi">0</span> = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkf4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkf4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (pos p) <span class="kr">in</span>
pos p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chkf5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkf5"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (neg p) <span class="kr">in</span>
neg p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf6"><span class="highlight"><span class="bp">now</span> <span class="kp">repeat</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (pos p) <span class="kr">in</span>
pos p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkf7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkf7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (neg p) <span class="kr">in</span>
neg p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkf8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkf8"><span class="highlight"><span class="nb">generalize</span> (Pos.sqrtrem_spec p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Pos.SqrtSpec (Pos.sqrtrem p) p -&gt;
<span class="mi">0</span> &lt;= pos p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (pos p) <span class="kr">in</span>
pos p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkf9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkf9"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (neg p) <span class="kr">in</span>
neg p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkfa" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkfa"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Pos.SqrtSpec (Pos.sqrtrem p) p -&gt;
<span class="mi">0</span> &lt;= pos p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) :=
  <span class="kr">let</span> (<span class="nv">s</span>, m) := Pos.sqrtrem p <span class="kr">in</span>
  <span class="kr">match</span> m <span class="kr">with</span>
  | Pos.IsPos r =&gt; (pos s, pos r)
  | _ =&gt; (pos s, <span class="mi">0</span>)
  <span class="kr">end</span> <span class="kr">in</span>
pos p = s * s + r /\
<span class="mi">0</span> &lt;= r &lt;=
<span class="kr">match</span> s <span class="kr">with</span>
| <span class="mi">0</span> =&gt; <span class="mi">0</span>
| pos y&#39; =&gt; pos y&#39;~<span class="mi">0</span>
| neg y&#39; =&gt; neg y&#39;~<span class="mi">0</span>
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chkfb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chkfb"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (neg p) <span class="kr">in</span>
neg p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkfc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkfc"><span class="highlight"><span class="nb">destruct</span> <span class="mi">1</span>; <span class="nb">simpl</span>; <span class="nb">subst</span>; <span class="bp">now</span> <span class="kp">repeat</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> (<span class="nv">s</span>, r) := sqrtrem (neg p) <span class="kr">in</span>
neg p = s * s + r /\ <span class="mi">0</span> &lt;= r &lt;= <span class="mi">2</span> * s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkfd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkfd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sqrt_spec</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 <span class="kr">let</span> <span class="nv">s</span> := sqrt n <span class="kr">in</span> s*s &lt;= n &lt; (succ s)*(succ s).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt n <span class="kr">in</span> s * s &lt;= n &lt; succ s * succ s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkfe" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkfe"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt n <span class="kr">in</span> s * s &lt;= n &lt; succ s * succ s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chkff" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chkff"><span class="highlight"><span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">0</span> -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt <span class="mi">0</span> <span class="kr">in</span> s * s &lt;= <span class="mi">0</span> &lt; succ s * succ s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk100" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk100"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (pos p) <span class="kr">in</span>
s * s &lt;= pos p &lt; succ s * succ s</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk101" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk101"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk102" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk102"><span class="highlight"><span class="bp">now</span> <span class="kp">repeat</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (pos p) <span class="kr">in</span>
s * s &lt;= pos p &lt; succ s * succ s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk103" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk103"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk104" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk104"><span class="highlight"><span class="nb">unfold</span> sqrt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos p -&gt;
pos (Pos.sqrt p) * pos (Pos.sqrt p) &lt;= pos p &lt;
succ (pos (Pos.sqrt p)) * succ (pos (Pos.sqrt p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk105" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk105"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk106" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk106"><span class="highlight"><span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (Pos.sqrt p) * pos (Pos.sqrt p) &lt;= pos p &lt;
succ (pos (Pos.sqrt p)) * succ (pos (Pos.sqrt p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk107" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk107"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk108" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk108"><span class="highlight"><span class="nb">simpl</span> succ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (Pos.sqrt p) * pos (Pos.sqrt p) &lt;= pos p &lt;
pos (Pos.sqrt p + <span class="mi">1</span>) * pos (Pos.sqrt p + <span class="mi">1</span>)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk109" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk109"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk10a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk10a"><span class="highlight"><span class="nb">rewrite</span> Pos.add_1_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (Pos.sqrt p) * pos (Pos.sqrt p) &lt;= pos p &lt;
pos (Pos.succ (Pos.sqrt p)) *
pos (Pos.succ (Pos.sqrt p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk10b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk10b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk10c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk10c"><span class="highlight"><span class="nb">apply</span> (Pos.sqrt_spec p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= neg p -&gt;
<span class="kr">let</span> <span class="nv">s</span> := sqrt (neg p) <span class="kr">in</span>
s * s &lt;= neg p &lt; succ s * succ s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk10d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk10d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sqrt_neg</span> <span class="nv">n</span> : n&lt;<span class="mi">0</span> -&gt; sqrt n = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; <span class="mi">0</span> -&gt; sqrt n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk10e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk10e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; <span class="mi">0</span> -&gt; sqrt n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk10f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk10f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sqrtrem_sqrt</span> <span class="nv">n</span> : fst (sqrtrem n) = sqrt n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst (sqrtrem n) = sqrt n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk110" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk110"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst (sqrtrem n) = sqrt n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk111" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk111"><span class="highlight"><span class="nb">destruct</span> n; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst (sqrtrem (pos p)) = sqrt (pos p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk112" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk112"><span class="highlight"><span class="nb">unfold</span> sqrtrem, sqrt, Pos.sqrt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst
  (<span class="kr">let</span> (<span class="nv">s</span>, m) := Pos.sqrtrem p <span class="kr">in</span>
   <span class="kr">match</span> m <span class="kr">with</span>
   | Pos.IsPos r =&gt; (pos s, pos r)
   | _ =&gt; (pos s, <span class="mi">0</span>)
   <span class="kr">end</span>) = pos (fst (Pos.sqrtrem p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk113" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk113"><span class="highlight"><span class="nb">destruct</span> (Pos.sqrtrem p) <span class="kr">as</span> (s,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Pos.mask</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst
  <span class="kr">match</span> r <span class="kr">with</span>
  | Pos.IsPos r0 =&gt; (pos s, pos r0)
  | _ =&gt; (pos s, <span class="mi">0</span>)
  <span class="kr">end</span> = pos (fst (s, r))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab30"></a><h2 class="section">Specification of logarithm</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk114" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk114"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">log2_spec</span> <span class="nv">n</span> : <span class="mi">0</span> &lt; n -&gt; <span class="mi">2</span>^(log2 n) &lt;= n &lt; <span class="mi">2</span>^(succ (log2 n)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; n -&gt; <span class="mi">2</span> ^ log2 n &lt;= n &lt; <span class="mi">2</span> ^ succ (log2 n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk115" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk115"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; n -&gt; <span class="mi">2</span> ^ log2 n &lt;= n &lt; <span class="mi">2</span> ^ succ (log2 n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk116" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk116"><span class="highlight"><span class="nb">assert</span> (Pow : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, pos (p^q) = (pos p)^(pos q)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive, pos (p ^ q) = pos p ^ pos q</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk117" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive, pos (p ^ q) = pos p ^ pos q</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk117"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; n -&gt; <span class="mi">2</span> ^ log2 n &lt;= n &lt; <span class="mi">2</span> ^ succ (log2 n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk118" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk118"><span class="highlight">{</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive, pos (p ^ q) = pos p ^ pos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk119" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk119"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (p ^ q) = pos p ^ pos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.iter_swap_gen.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk11a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk11a"><span class="highlight">}</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive, pos (p ^ q) = pos p ^ pos q</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; n -&gt; <span class="mi">2</span> ^ log2 n &lt;= n &lt; <span class="mi">2</span> ^ succ (log2 n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk11b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk11b"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|[p|p|]|]; <span class="nb">intros</span> Hn; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">unfold</span> log2;
  <span class="nb">simpl</span> succ; <span class="nb">rewrite</span> ?Pos.add_1_r, &lt;- Pow.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (<span class="mi">2</span> ^ Pos.size p) &lt;= pos p~<span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk11c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk11c"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">1</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk11d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk11d"><hr></label><div class="goal-conclusion"><span class="highlight">pos (<span class="mi">2</span> ^ Pos.size p) &lt;= pos p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk11e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk11e"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">0</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk11f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk11f"><span class="highlight"><span class="nb">change</span> (<span class="mi">2</span>^Pos.size p &lt;= Pos.succ (p~<span class="mi">0</span>))%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">2</span> ^ Pos.size p &lt;= Pos.succ p~<span class="mi">0</span>)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk120" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk120"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">1</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk121" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk121"><hr></label><div class="goal-conclusion"><span class="highlight">pos (<span class="mi">2</span> ^ Pos.size p) &lt;= pos p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk122" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk122"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">0</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk123" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk123"><span class="highlight"><span class="nb">apply</span> Pos.lt_le_incl, Pos.lt_succ_r, Pos.size_le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">1</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk124" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk124"><hr></label><div class="goal-conclusion"><span class="highlight">pos (<span class="mi">2</span> ^ Pos.size p) &lt;= pos p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk125" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk125"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">0</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk126" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk126"><span class="highlight"><span class="nb">apply</span> Pos.size_gt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos (<span class="mi">2</span> ^ Pos.size p) &lt;= pos p~<span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk127" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk127"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">0</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk128" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk128"><span class="highlight"><span class="nb">apply</span> Pos.size_le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Pow</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p0</span> <span class="nv">q</span> : positive, pos (p0 ^ q) = pos p0 ^ pos q</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos p~<span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos p~<span class="mi">0</span> &lt; pos (<span class="mi">2</span> ^ Pos.succ (Pos.size p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Pos.size_gt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk129" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk129"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">log2_nonpos</span> <span class="nv">n</span> : n&lt;=<span class="mi">0</span> -&gt; log2 n = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= <span class="mi">0</span> -&gt; log2 n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk12a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk12a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= <span class="mi">0</span> -&gt; log2 n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|p|p]; <span class="nb">trivial</span>; <span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Specification of parity functions 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk12b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk12b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">even_spec</span> <span class="nv">n</span> : even n = true &lt;-&gt; Even n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">even n = true &lt;-&gt; Even n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk12c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk12c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">even n = true &lt;-&gt; Even n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk12d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk12d"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">even n = true -&gt; Even n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk12e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk12e"><hr></label><div class="goal-conclusion"><span class="highlight">Even n -&gt; even n = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk12f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk12f"><span class="highlight"><span class="kr">exists</span> (<span class="nv">div2</span> <span class="nv">n</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">even n = true</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n = <span class="mi">2</span> * div2 n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk130" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk130"><hr></label><div class="goal-conclusion"><span class="highlight">Even n -&gt; even n = true</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk131" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk131"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n <span class="kr">as</span> [|[ | | ]|[ | | ]].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Even n -&gt; even n = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk132" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk132"><span class="highlight"><span class="nb">intros</span> (m,-&gt;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">even (<span class="mi">2</span> * m) = true</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> m.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk133" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk133"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">odd_spec</span> <span class="nv">n</span> : odd n = true &lt;-&gt; Odd n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">odd n = true &lt;-&gt; Odd n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk134" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk134"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">odd n = true &lt;-&gt; Odd n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk135" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk135"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">odd n = true -&gt; Odd n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk136" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk136"><hr></label><div class="goal-conclusion"><span class="highlight">Odd n -&gt; odd n = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk137" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk137"><span class="highlight"><span class="kr">exists</span> (<span class="nv">div2</span> <span class="nv">n</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">odd n = true</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n = <span class="mi">2</span> * div2 n + <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk138" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk138"><hr></label><div class="goal-conclusion"><span class="highlight">Odd n -&gt; odd n = true</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk139" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk139"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|[ | | ]|[ | | ]]; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">odd (neg p~<span class="mi">1</span>) = true</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg p~<span class="mi">1</span> = neg (Pos.pred_double (Pos.succ p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk13a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk13a"><hr></label><div class="goal-conclusion"><span class="highlight">Odd n -&gt; odd n = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk13b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk13b"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.pred_double_succ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Odd n -&gt; odd n = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk13c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk13c"><span class="highlight"><span class="nb">intros</span> (m,-&gt;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">odd (<span class="mi">2</span> * m + <span class="mi">1</span>) = true</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> m <span class="kr">as</span> [|[ | | ]|[ | | ]].</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab31"></a><h2 class="section">Multiplication and Doubling</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk13d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk13d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">double_spec</span> <span class="nv">n</span> : double n = <span class="mi">2</span>*n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">double n = <span class="mi">2</span> * n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk13e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk13e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">double n = <span class="mi">2</span> * n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk13f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk13f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">succ_double_spec</span> <span class="nv">n</span> : succ_double n = <span class="mi">2</span>*n + <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ_double n = <span class="mi">2</span> * n + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk140" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk140"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ_double n = <span class="mi">2</span> * n + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk141" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk141"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pred_double_spec</span> <span class="nv">n</span> : pred_double n = <span class="mi">2</span>*n - <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pred_double n = <span class="mi">2</span> * n - <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk142" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk142"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pred_double n = <span class="mi">2</span> * n - <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab32"></a><h2 class="section">Correctness proofs for Trunc division</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk143" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk143"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_div_eucl_eq</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="mi">0</span> &lt; b -&gt;
  <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt;
<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk144" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk144"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt;
<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk145" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk145"><span class="highlight"><span class="nb">intros</span> Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk146" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk146"><span class="highlight"><span class="nb">induction</span> a; <span class="nb">unfold</span> pos_div_eucl; <span class="nb">fold</span> pos_div_eucl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) :=
  <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span>
  <span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - b) <span class="kr">in</span>
pos a~<span class="mi">1</span> = q * b + r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk147" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk147"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) :=
  <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span>
  <span class="kr">if</span> <span class="mi">2</span> * r &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - b) <span class="kr">in</span>
pos a~<span class="mi">0</span> = q * b + r</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk148" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk148"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := <span class="kr">if</span> <span class="mi">2</span> &lt;=? b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>) <span class="kr">in</span>
<span class="mi">1</span> = q * b + r</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk149" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk149"><span class="highlight">- <span class="c">(* ~1 *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) :=
  <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span>
  <span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - b) <span class="kr">in</span>
pos a~<span class="mi">1</span> = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk14a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk14a"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - b) <span class="kr">in</span>
pos a~<span class="mi">1</span> = q0 * b + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk14b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk14b"><span class="highlight"><span class="nb">change</span> (pos a~<span class="mi">1</span>) <span class="kr">with</span> (<span class="mi">2</span>*(pos a)+<span class="mi">1</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - b) <span class="kr">in</span>
<span class="mi">2</span> * pos a + <span class="mi">1</span> = q0 * b + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk14c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk14c"><span class="highlight"><span class="nb">rewrite</span> IHa, mul_add_distr_l, mul_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - b) <span class="kr">in</span>
<span class="mi">2</span> * q * b + <span class="mi">2</span> * r + <span class="mi">1</span> = q0 * b + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk14d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk14d"><span class="highlight"><span class="nb">destruct</span> ltb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r + <span class="mi">1</span> = <span class="mi">2</span> * q * b + (<span class="mi">2</span> * r + <span class="mi">1</span>)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk14e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk14e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r + <span class="mi">1</span> =
(<span class="mi">2</span> * q + <span class="mi">1</span>) * b + (<span class="mi">2</span> * r + <span class="mi">1</span> - b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk14f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk14f"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> add_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r + <span class="mi">1</span> =
(<span class="mi">2</span> * q + <span class="mi">1</span>) * b + (<span class="mi">2</span> * r + <span class="mi">1</span> - b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk150" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk150"><span class="highlight"><span class="nb">rewrite</span> mul_add_distr_r, mul_1_l, &lt;- !add_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + (<span class="mi">2</span> * r + <span class="mi">1</span>) =
<span class="mi">2</span> * q * b + (b + (<span class="mi">2</span> * r + <span class="mi">1</span> - b))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk151" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk151"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> = b + (<span class="mi">2</span> * r + <span class="mi">1</span> - b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk152" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk152"><span class="highlight"><span class="nb">unfold</span> sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> = b + (<span class="mi">2</span> * r + <span class="mi">1</span> + - b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> (add_comm _ (-b)), add_assoc, add_opp_diag_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk153" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk153"><span class="highlight">- <span class="c">(* ~0 *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span> pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) :=
  <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a b <span class="kr">in</span>
  <span class="kr">if</span> <span class="mi">2</span> * r &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - b) <span class="kr">in</span>
pos a~<span class="mi">0</span> = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk154" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk154"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">if</span> <span class="mi">2</span> * r &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - b) <span class="kr">in</span>
pos a~<span class="mi">0</span> = q0 * b + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk155" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk155"><span class="highlight"><span class="nb">change</span> (pos a~<span class="mi">0</span>) <span class="kr">with</span> (<span class="mi">2</span>*pos a).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">if</span> <span class="mi">2</span> * r &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - b) <span class="kr">in</span>
<span class="mi">2</span> * pos a = q0 * b + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk156" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk156"><span class="highlight"><span class="nb">rewrite</span> IHa, mul_add_distr_l, mul_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">if</span> <span class="mi">2</span> * r &lt;? b
  <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
  <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - b) <span class="kr">in</span>
<span class="mi">2</span> * q * b + <span class="mi">2</span> * r = q0 * b + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk157" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk157"><span class="highlight"><span class="nb">destruct</span> ltb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r = <span class="mi">2</span> * q * b + <span class="mi">2</span> * r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk158" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk158"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r = (<span class="mi">2</span> * q + <span class="mi">1</span>) * b + (<span class="mi">2</span> * r - b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk159" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk159"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r = (<span class="mi">2</span> * q + <span class="mi">1</span>) * b + (<span class="mi">2</span> * r - b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15a"><span class="highlight"><span class="nb">rewrite</span> mul_add_distr_r, mul_1_l, &lt;- !add_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * q * b + <span class="mi">2</span> * r = <span class="mi">2</span> * q * b + (b + (<span class="mi">2</span> * r - b))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15b"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r = b + (<span class="mi">2</span> * r - b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15c"><span class="highlight"><span class="nb">unfold</span> sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos a = q * b + r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r = b + (<span class="mi">2</span> * r + - b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> (add_comm _ (-b)), add_assoc, add_opp_diag_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15d"><span class="highlight">- <span class="c">(* 1 *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := <span class="kr">if</span> <span class="mi">2</span> &lt;=? b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>) <span class="kr">in</span>
<span class="mi">1</span> = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15e"><span class="highlight"><span class="nb">case</span> leb_spec; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt; <span class="mi">2</span> -&gt; <span class="mi">1</span> = <span class="mi">1</span> * b + <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk15f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk15f"><span class="highlight"><span class="nb">intros</span> Hb&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b &lt; <span class="mi">2</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = <span class="mi">1</span> * b + <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk160" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk160"><span class="highlight"><span class="nb">destruct</span> b <span class="kr">as</span> [|b|b]; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">clear</span> Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt; <span class="mi">2</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = <span class="mi">1</span> * pos b + <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk161" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk161"><span class="highlight"><span class="nb">replace</span> b <span class="kr">with</span> <span class="mi">1</span>%positive; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt; <span class="mi">2</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span>%positive = b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk162" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk162"><span class="highlight"><span class="nb">apply</span> Pos.le_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt; <span class="mi">2</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> &lt;= b)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk163" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt; <span class="mi">2</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk163"><hr></label><div class="goal-conclusion"><span class="highlight">(b &lt;= <span class="mi">1</span>)%positive</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk164" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk164"><span class="highlight"><span class="nb">apply</span> Pos.le_1_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt; <span class="mi">2</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(b &lt;= <span class="mi">1</span>)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.lt_succ_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk165" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk165"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">div_eucl_eq</span> <span class="nv">a</span> <span class="nv">b</span> : b&lt;&gt;<span class="mi">0</span> -&gt;
 <span class="kr">let</span> (<span class="nv">q</span>, r) := div_eucl a b <span class="kr">in</span> a = b * q + r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; <span class="kr">let</span> (<span class="nv">q</span>, r) := div_eucl a b <span class="kr">in</span> a = b * q + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk166" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk166"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; <span class="kr">let</span> (<span class="nv">q</span>, r) := div_eucl a b <span class="kr">in</span> a = b * q + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk167" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk167"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a], b <span class="kr">as</span> [ |b|b]; <span class="nb">unfold</span> div_eucl; <span class="nb">trivial</span>;
  (<span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>) || <span class="nb">intros</span> _;
  <span class="nb">generalize</span> (pos_div_eucl_eq a (pos b) Logic.eq_refl);
  <span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r); <span class="nb">rewrite</span> mul_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt; pos a = pos b * q + r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk168" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk168"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt;
<span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
  <span class="kr">end</span> <span class="kr">in</span>
pos a = neg b * q0 + r0</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk169" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk169"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt;
<span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
  <span class="kr">end</span> <span class="kr">in</span>
neg a = pos b * q0 + r0</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk16a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk16a"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt; neg a = neg b * q + - r</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk16b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk16b"><span class="highlight">- <span class="c">(* pos pos *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt; pos a = pos b * q + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk16c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk16c"><span class="highlight">- <span class="c">(* pos neg *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt;
<span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
  <span class="kr">end</span> <span class="kr">in</span>
pos a = neg b * q0 + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk16d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk16d"><span class="highlight"><span class="nb">intros</span> -&gt;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
  <span class="kr">end</span> <span class="kr">in</span>
pos b * q + r = neg b * q0 + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> r <span class="kr">as</span> [ |r|r]; <span class="nb">rewrite</span> &lt;- !mul_opp_comm; <span class="nb">trivial</span>;
    <span class="nb">rewrite</span> mul_add_distr_l, mul_1_r, &lt;- add_assoc; <span class="nb">f_equal</span>;
   <span class="bp">now</span> <span class="nb">rewrite</span> add_assoc, add_opp_diag_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk16e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk16e"><span class="highlight">- <span class="c">(* neg pos *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt;
<span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
  <span class="kr">end</span> <span class="kr">in</span>
neg a = pos b * q0 + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk16f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk16f"><span class="highlight"><span class="nb">change</span> (neg a) <span class="kr">with</span> (- pos a).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt;
<span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
  <span class="kr">end</span> <span class="kr">in</span>
- pos a = pos b * q0 + r0</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk170" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk170"><span class="highlight"><span class="nb">intros</span> -&gt;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
  <span class="kr">end</span> <span class="kr">in</span>
- (pos b * q + r) = pos b * q0 + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk171" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk171"><span class="highlight"><span class="nb">rewrite</span> (opp_add_distr _ r), &lt;- mul_opp_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q0</span>, r0) :=
  <span class="kr">match</span> r <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
  | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
  <span class="kr">end</span> <span class="kr">in</span>
pos b * - q + - r = pos b * q0 + r0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> r <span class="kr">as</span> [ |r|r]; <span class="nb">trivial</span>;
    <span class="nb">rewrite</span> opp_add_distr, mul_add_distr_l, &lt;- add_assoc; <span class="nb">f_equal</span>;
    <span class="nb">unfold</span> sub; <span class="bp">now</span> <span class="nb">rewrite</span> add_assoc, mul_opp_r, mul_1_r, add_opp_diag_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk172" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk172"><span class="highlight">- <span class="c">(* neg neg *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt; neg a = neg b * q + - r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk173" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk173"><span class="highlight"><span class="nb">change</span> (neg a) <span class="kr">with</span> (- pos a).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos a = pos b * q + r -&gt; - pos a = neg b * q + - r</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk174" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk174"><span class="highlight"><span class="nb">intros</span> -&gt;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- (pos b * q + r) = neg b * q + - r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> opp_add_distr, &lt;- mul_opp_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk175" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk175"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">div_mod</span> <span class="nv">a</span> <span class="nv">b</span> : b&lt;&gt;<span class="mi">0</span> -&gt; a = b*(a/b) + (a mod b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; a = b * (a / b) + a mod b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk176" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk176"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; a = b * (a / b) + a mod b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk177" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk177"><span class="highlight"><span class="nb">intros</span> Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b &lt;&gt; <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = b * (a / b) + a mod b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk178" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk178"><span class="highlight"><span class="nb">generalize</span> (div_eucl_eq a b Hb).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b &lt;&gt; <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span> (<span class="nv">q</span>, r) := div_eucl a b <span class="kr">in</span> a = b * q + r) -&gt;
a = b * (a / b) + a mod b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk179" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk179"><span class="highlight"><span class="nb">unfold</span> div, modulo.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b &lt;&gt; <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span> (<span class="nv">q</span>, r) := div_eucl a b <span class="kr">in</span> a = b * q + r) -&gt;
a =
b * (<span class="kr">let</span> (<span class="nv">q</span>, _) := div_eucl a b <span class="kr">in</span> q) +
(<span class="kr">let</span> (<span class="nv">_</span>, r) := div_eucl a b <span class="kr">in</span> r)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> div_eucl.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk17a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk17a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_div_eucl_bound</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="mi">0</span>&lt;b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk17b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk17b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk17c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk17c"><span class="highlight"><span class="nb">assert</span> (AUX : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">p</span>, m &lt; pos (p~<span class="mi">0</span>) -&gt; m - pos p &lt; pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive),
m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk17d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk17d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk17e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk17e"><span class="highlight"><span class="nb">intros</span> m p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk17f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk17f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk180" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk180"><span class="highlight"><span class="nb">unfold</span> lt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m ?= pos p~<span class="mi">0</span>) = Lt -&gt; (m - pos p ?= pos p) = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk181" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk181"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk182" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk182"><span class="highlight"><span class="nb">rewrite</span> (compare_sub m), (compare_sub _ (pos _)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m - pos p~<span class="mi">0</span> ?= <span class="mi">0</span>) = Lt -&gt;
(m - pos p - pos p ?= <span class="mi">0</span>) = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk183" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk183"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk184" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk184"><span class="highlight"><span class="nb">unfold</span> sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m + - pos p~<span class="mi">0</span> ?= <span class="mi">0</span>) = Lt -&gt;
(m + - pos p + - pos p ?= <span class="mi">0</span>) = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk185" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk185"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk186" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk186"><span class="highlight"><span class="nb">rewrite</span> &lt;- add_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m + - pos p~<span class="mi">0</span> ?= <span class="mi">0</span>) = Lt -&gt;
(m + (- pos p + - pos p) ?= <span class="mi">0</span>) = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk187" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk187"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk188" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk188"><span class="highlight"><span class="nb">simpl</span> opp; <span class="nb">simpl</span> (neg _ + _).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m + neg p~<span class="mi">0</span> ?= <span class="mi">0</span>) = Lt -&gt; (m + neg (p + p) ?= <span class="mi">0</span>) = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk189" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk189"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk18a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk18a"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_diag.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk18b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk18b"><span class="highlight"><span class="nb">intros</span> Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a b) &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk18c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk18c"><span class="highlight"><span class="nb">destruct</span> b <span class="kr">as</span> [|b|b]; <span class="bp">discriminate</span> Hb || <span class="nb">clear</span> Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk18d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk18d"><span class="highlight"><span class="nb">induction</span> a; <span class="nb">unfold</span> pos_div_eucl; <span class="nb">fold</span> pos_div_eucl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - pos b)) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk18e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk18e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk18f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk18f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* ~1 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk190" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk190"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (q, r) &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - pos b)) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk191" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk191"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk192" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk192"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk193" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk193"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> IHa; <span class="nb">destruct</span> IHa <span class="kr">as</span> (Hr,Hr&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">if</span> <span class="mi">2</span> * r + <span class="mi">1</span> &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r + <span class="mi">1</span>)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r + <span class="mi">1</span> - pos b)) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk194" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk194"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk195" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk195"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk196" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk196"><span class="highlight"><span class="nb">case</span> ltb_spec; <span class="nb">intros</span> H; <span class="nb">unfold</span> snd.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r + <span class="mi">1</span> &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk197" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk197"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r + <span class="mi">1</span> - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk198" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk198"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk199" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk199"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk19a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk19a"><span class="highlight"><span class="nb">split</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk19b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk19b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r + <span class="mi">1</span> - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk19c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk19c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk19d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk19d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk19e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk19e"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r + <span class="mi">1</span> - pos b &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk19f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk19f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a0"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1a1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1a1"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r + <span class="mi">1</span> - pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a2"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1a5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1a5"><span class="highlight"><span class="nb">unfold</span> le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> ?= <span class="mi">2</span> * r + <span class="mi">1</span> - pos b) &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a6"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1a8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1a8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1a9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1a9"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> compare_antisym, &lt;- compare_sub, &lt;- compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> - pos b &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1aa" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1aa"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ab" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ab"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1ac" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1ac"><span class="highlight"><span class="nb">apply</span> AUX.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r + <span class="mi">1</span> &lt; pos b~<span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ad" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ad"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ae" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ae"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1af" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1af"><span class="highlight"><span class="nb">rewrite</span> &lt;- succ_double_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ_double r &lt; pos b~<span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b0"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b1"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1b2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1b2"><span class="highlight"><span class="nb">destruct</span> r; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p0</span> : positive), m &lt; pos p0~<span class="mi">0</span> -&gt; m - pos p0 &lt; pos p0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos p &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * pos p + <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">succ_double (pos p) &lt; pos b~<span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1b5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1b5"><span class="highlight"><span class="nb">unfold</span> lt <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p0</span> : positive),
(m ?= pos p0~<span class="mi">0</span>) = Lt -&gt; (m - pos p0 ?= pos p0) = Lt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p ?= b)%positive = Lt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= pos p~<span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p~<span class="mi">1</span> ?= b~<span class="mi">0</span>)%positive = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b6"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1b8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1b8"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.compare_xI_xO, Hr&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1b9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1b9"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* ~0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1ba" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1ba"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHa</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= snd (q, r) &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1bb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1bb"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1bc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1bc"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> IHa; <span class="nb">destruct</span> IHa <span class="kr">as</span> (Hr,Hr&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">if</span> <span class="mi">2</span> * r &lt;? pos b
   <span class="kr">then</span> (<span class="mi">2</span> * q, <span class="mi">2</span> * r)
   <span class="kr">else</span> (<span class="mi">2</span> * q + <span class="mi">1</span>, <span class="mi">2</span> * r - pos b)) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1bd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1bd"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1be" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1be"><span class="highlight"><span class="nb">case</span> ltb_spec; <span class="nb">intros</span> H; <span class="nb">unfold</span> snd.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">2</span> * r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1bf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1bf"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1c0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1c0"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1c1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1c1"><span class="highlight"><span class="nb">split</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">2</span> * r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1c2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1c2"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1c3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1c3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1c4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1c4"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r - pos b &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1c5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1c5"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1c6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1c6"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">2</span> * r - pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1c7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1c7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1c8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1c8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1c9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1c9"><span class="highlight"><span class="nb">unfold</span> le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> ?= <span class="mi">2</span> * r - pos b) &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ca" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ca"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r - pos b &lt; pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1cb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1cb"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1cc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1cc"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> compare_antisym, &lt;- compare_sub, &lt;- compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r - pos b &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1cd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1cd"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1ce" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1ce"><span class="highlight"><span class="nb">apply</span> AUX.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos b &lt;= <span class="mi">2</span> * r</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span> * r &lt; pos b~<span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1cf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1cf"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d0"><span class="highlight"><span class="nb">destruct</span> r; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (<span class="kr">if</span> <span class="mi">2</span> &lt;=? pos b <span class="kr">then</span> (<span class="mi">0</span>, <span class="mi">1</span>) <span class="kr">else</span> (<span class="mi">1</span>, <span class="mi">0</span>)) &lt;
pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* 1 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d1"><span class="highlight"><span class="nb">case</span> leb_spec; <span class="nb">intros</span> H; <span class="nb">simpl</span>; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">2</span> &lt;= pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d2"><span class="highlight"><span class="nb">red</span>; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">AUX</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : Z) (<span class="nv">p</span> : positive), m &lt; pos p~<span class="mi">0</span> -&gt; m - pos p &lt; pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">2</span> &lt;= pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> ?= b)%positive = Lt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.le_succ_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mod_pos_bound</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= a mod b &lt; b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= a mod b &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= a mod b &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d5"><span class="highlight"><span class="nb">destruct</span> b <span class="kr">as</span> [|b|b]; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= a mod pos b &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d6"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a|a]; <span class="nb">unfold</span> modulo, div_eucl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">0</span> &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1d7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1d7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= (<span class="kr">let</span> (<span class="nv">_</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> r) &lt;
pos b</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1d8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1d8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1d9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1d9"><span class="highlight"><span class="bp">now</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= (<span class="kr">let</span> (<span class="nv">_</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> r) &lt;
pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1da" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1da"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1db" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1db"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> pos_div_eucl_bound.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1dc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1dc"><span class="highlight"><span class="nb">generalize</span> (pos_div_eucl_bound a (pos b) Logic.eq_refl).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b -&gt;
<span class="mi">0</span> &lt;=
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1dd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1dd"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r); <span class="nb">unfold</span> snd; <span class="nb">intros</span> (Hr,Hr&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
(<span class="kr">let</span> (<span class="nv">_</span>, r0) :=
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), pos b - r)
   <span class="kr">end</span> <span class="kr">in</span>
 r0) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1de" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1de"><span class="highlight"><span class="nb">destruct</span> r <span class="kr">as</span> [|r|r]; (<span class="bp">now</span> <span class="nb">destruct</span> Hr) || <span class="nb">clear</span> Hr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">0</span> &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1df" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1df"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos b - pos r &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e0"><span class="highlight"><span class="bp">now</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos b - pos r &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e1"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos b - pos r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1e2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1e2"><hr></label><div class="goal-conclusion"><span class="highlight">pos b - pos r &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e3"><span class="highlight"><span class="nb">unfold</span> le.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> ?= pos b - pos r) &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1e4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1e4"><hr></label><div class="goal-conclusion"><span class="highlight">pos b - pos r &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e5"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> compare_antisym, &lt;- compare_sub, &lt;- compare_antisym, Hr&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos b - pos r &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e6"><span class="highlight"><span class="nb">unfold</span> lt <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos_sub b r ?= pos b) = Lt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e7"><span class="highlight"><span class="nb">rewrite</span> pos_sub_gt <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos (b - r) ?= pos b) = Lt</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e8"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(b - r ?= b)%positive = Lt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.sub_decr.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mod_bound_pos</span> <span class="nv">a</span> <span class="nv">b</span> (<span class="nv">_</span>:<span class="mi">0</span>&lt;=a) := mod_pos_bound a b.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1e9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1e9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mod_neg_bound</span> <span class="nv">a</span> <span class="nv">b</span> : b &lt; <span class="mi">0</span> -&gt; b &lt; a mod b &lt;= <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt; <span class="mi">0</span> -&gt; b &lt; a mod b &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1ea" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1ea"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt; <span class="mi">0</span> -&gt; b &lt; a mod b &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1eb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1eb"><span class="highlight"><span class="nb">destruct</span> b <span class="kr">as</span> [|b|b]; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; a mod neg b &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1ec" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1ec"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a|a]; <span class="nb">unfold</span> modulo, div_eucl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; <span class="mi">0</span> &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ed" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ed"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ee" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ee"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1ef" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1ef"><span class="highlight"><span class="bp">now</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1f0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1f0"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1f1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1f1"><span class="highlight"><span class="nb">generalize</span> (pos_div_eucl_bound a (pos b) Logic.eq_refl).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b -&gt;
neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span>
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
   <span class="kr">end</span> <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1f2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1f2"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1f3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1f3"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r); <span class="nb">unfold</span> snd; <span class="nb">intros</span> (Hr,Hr&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r0) :=
   <span class="kr">match</span> r <span class="kr">with</span>
   | <span class="mi">0</span> =&gt; (- q, <span class="mi">0</span>)
   | _ =&gt; (- (q + <span class="mi">1</span>), neg b + r)
   <span class="kr">end</span> <span class="kr">in</span>
 r0) &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1f4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1f4"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1f5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1f5"><span class="highlight"><span class="nb">destruct</span> r <span class="kr">as</span> [|r|r]; (<span class="bp">now</span> <span class="nb">destruct</span> Hr) || <span class="nb">clear</span> Hr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; <span class="mi">0</span> &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1f6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1f6"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1f7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1f7"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1f8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1f8"><span class="highlight"><span class="bp">now</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1f9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1f9"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1fa" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1fa"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; neg b + pos r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1fb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1fb"><hr></label><div class="goal-conclusion"><span class="highlight">neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1fc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1fc"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk1fd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk1fd"><span class="highlight"><span class="nb">unfold</span> lt <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> pos_sub r b <span class="kr">with</span>
| neg y&#39; =&gt; CompOpp (b ?= y&#39;)%positive
| _ =&gt; Lt
<span class="kr">end</span> = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk1fe" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1fe"><hr></label><div class="goal-conclusion"><span class="highlight">neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk1ff" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk1ff"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk200" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk200"><span class="highlight"><span class="nb">rewrite</span> pos_sub_lt <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">CompOpp (b ?= b - r)%positive = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk201" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk201"><hr></label><div class="goal-conclusion"><span class="highlight">neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk202" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk202"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk203" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk203"><span class="highlight"><span class="nb">rewrite</span> &lt;- Pos.compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(b - r ?= b)%positive = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk204" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk204"><hr></label><div class="goal-conclusion"><span class="highlight">neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk205" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk205"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk206" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk206"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.sub_decr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b + pos r &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk207" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk207"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk208" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk208"><span class="highlight"><span class="nb">change</span> (neg b - neg r &lt;= <span class="mi">0</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b - neg r &lt;= <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk209" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk209"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk20a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk20a"><span class="highlight"><span class="nb">unfold</span> le, lt <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos r ?= pos b) = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(neg b - neg r ?= <span class="mi">0</span>) &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk20b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk20b"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk20c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk20c"><span class="highlight"><span class="nb">rewrite</span> &lt;- compare_sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos r ?= pos b) = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(neg b ?= neg r) &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk20d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk20d"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk20e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk20e"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(r ?= b)%positive = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">CompOpp (b ?= r)%positive &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk20f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk20f"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk210" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk210"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Pos.compare_antisym, Hr&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk211" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk211"><span class="highlight"><span class="nb">generalize</span> (pos_div_eucl_bound a (pos b) Logic.eq_refl).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= snd (pos_div_eucl a (pos b)) &lt; pos b -&gt;
neg b &lt;
(<span class="kr">let</span> (<span class="nv">_</span>, r) :=
   <span class="kr">let</span> (<span class="nv">q</span>, r) := pos_div_eucl a (pos b) <span class="kr">in</span> (q, - r) <span class="kr">in</span>
 r) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk212" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk212"><span class="highlight"><span class="nb">destruct</span> pos_div_eucl <span class="kr">as</span> (q,r); <span class="nb">unfold</span> snd; <span class="nb">intros</span> (Hr,Hr&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; - r &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk213" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk213"><span class="highlight"><span class="nb">split</span>; <span class="nb">destruct</span> r; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos p &lt; pos b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">neg b &lt; - pos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">red</span>; <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Pos.compare_antisym.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab33"></a><h2 class="section">Correctness proofs for Floor division</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk214" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk214"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">quotrem_eq</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="kr">let</span> (<span class="nv">q</span>,r) := quotrem a b <span class="kr">in</span> a = q * b + r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := quotrem a b <span class="kr">in</span> a = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk215" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk215"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span> (<span class="nv">q</span>, r) := quotrem a b <span class="kr">in</span> a = q * b + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a|a], b <span class="kr">as</span> [|b|b]; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
 <span class="nb">generalize</span> (N.pos_div_eucl_spec a (N.pos b)); <span class="nb">case</span> N.pos_div_eucl; <span class="nb">trivial</span>;
  <span class="nb">intros</span> q r;
  <span class="kp">try</span> <span class="nb">change</span> (neg a) <span class="kr">with</span> (-pos a);
  <span class="nb">change</span> (pos a) <span class="kr">with</span> (of_N (N.pos a)); <span class="nb">intros</span> -&gt;; <span class="bp">now</span> <span class="nb">destruct</span> q, r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk216" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk216"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">quot_rem&#39;</span> <span class="nv">a</span> <span class="nv">b</span> : a = b*(a√∑b) + rem a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = b * (a √∑ b) + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk217" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk217"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = b * (a √∑ b) + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk218" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk218"><span class="highlight"><span class="nb">rewrite</span> mul_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = a √∑ b * b + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk219" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk219"><span class="highlight"><span class="nb">generalize</span> (quotrem_eq a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span> (<span class="nv">q</span>, r) := quotrem a b <span class="kr">in</span> a = q * b + r) -&gt;
a = a √∑ b * b + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21a"><span class="highlight"><span class="nb">unfold</span> quot, rem.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span> (<span class="nv">q</span>, r) := quotrem a b <span class="kr">in</span> a = q * b + r) -&gt;
a = fst (quotrem a b) * b + snd (quotrem a b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> quotrem.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">quot_rem</span> <span class="nv">a</span> <span class="nv">b</span> : b&lt;&gt;<span class="mi">0</span> -&gt; a = b*(a√∑b) + rem a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; a = b * (a √∑ b) + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; a = b * (a √∑ b) + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21d"><span class="highlight"><span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = b * (a √∑ b) + rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> quot_rem&#39;.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rem_bound_pos</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="mi">0</span>&lt;=a -&gt; <span class="mi">0</span>&lt;b -&gt; <span class="mi">0</span> &lt;= rem a b &lt; b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= rem a b &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk21f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk21f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= a -&gt; <span class="mi">0</span> &lt; b -&gt; <span class="mi">0</span> &lt;= rem a b &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk220" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk220"><span class="highlight"><span class="nb">intros</span> Ha Hb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; b</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= rem a b &lt; b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk221" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk221"><span class="highlight"><span class="nb">destruct</span> b <span class="kr">as</span> [|b|b]; (<span class="bp">now</span> <span class="bp">discriminate</span> Hb) || <span class="nb">clear</span> Hb;
 <span class="nb">destruct</span> a <span class="kr">as</span> [|a|a]; (<span class="bp">now</span> <span class="nb">destruct</span> Ha) || <span class="nb">clear</span> Ha.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= rem <span class="mi">0</span> (pos b) &lt; pos b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk222" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk222"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= rem (pos a) (pos b) &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk223" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk223"><span class="highlight"><span class="nb">compute</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Eq = Gt -&gt; <span class="kt">False</span>) /\ Lt = Lt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk224" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk224"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= rem (pos a) (pos b) &lt; pos b</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk225" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk225"><span class="highlight"><span class="bp">now</span> <span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= rem (pos a) (pos b) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk226" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk226"><span class="highlight"><span class="nb">unfold</span> rem, quotrem.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := N.pos_div_eucl a (N.pos b) <span class="kr">in</span>
   (of_N q, of_N r)) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk227" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk227"><span class="highlight"><span class="nb">assert</span> (H := N.pos_div_eucl_remainder a (N.pos b)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N.pos b &lt;&gt; <span class="mi">0</span>%N -&gt;
(snd (N.pos_div_eucl a (N.pos b)) &lt; N.pos b)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;=
snd
  (<span class="kr">let</span> (<span class="nv">q</span>, r) := N.pos_div_eucl a (N.pos b) <span class="kr">in</span>
   (of_N q, of_N r)) &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk228" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk228"><span class="highlight"><span class="nb">destruct</span> N.pos_div_eucl <span class="kr">as</span> (q,[|r]); <span class="nb">simpl</span>; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N.pos b &lt;&gt; <span class="mi">0</span>%N -&gt; (snd (q, N.pos r) &lt; N.pos b)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">pos r &lt; pos b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> H.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk229" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk229"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rem_opp_l&#39;</span> <span class="nv">a</span> <span class="nv">b</span> : rem (-a) b = - (rem a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">rem (- a) b = - rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">rem (- a) b = - rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a, b; <span class="nb">trivial</span>; <span class="nb">unfold</span> rem; <span class="nb">simpl</span>;
  <span class="bp">now</span> <span class="nb">destruct</span> N.pos_div_eucl <span class="kr">as</span> (q,[|r]).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rem_opp_r&#39;</span> <span class="nv">a</span> <span class="nv">b</span> : rem a (-b) = rem a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">rem a (- b) = rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">rem a (- b) = rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a, b; <span class="nb">trivial</span>; <span class="nb">unfold</span> rem; <span class="nb">simpl</span>;
  <span class="bp">now</span> <span class="nb">destruct</span> N.pos_div_eucl <span class="kr">as</span> (q,[|r]).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rem_opp_l</span> <span class="nv">a</span> <span class="nv">b</span> : b&lt;&gt;<span class="mi">0</span> -&gt; rem (-a) b = - (rem a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; rem (- a) b = - rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; rem (- a) b = - rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk22f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk22f"><span class="highlight"><span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">rem (- a) b = - rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> rem_opp_l&#39;.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk230" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk230"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rem_opp_r</span> <span class="nv">a</span> <span class="nv">b</span> : b&lt;&gt;<span class="mi">0</span> -&gt; rem a (-b) = rem a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; rem a (- b) = rem a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk231" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk231"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b &lt;&gt; <span class="mi">0</span> -&gt; rem a (- b) = rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk232" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk232"><span class="highlight"><span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">rem a (- b) = rem a b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> rem_opp_r&#39;.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab34"></a><h2 class="section">Extra properties about <span class="inlinecode"><span class="id" title="var">divide</span></span></h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk233" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk233"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">divide_Zpos</span> <span class="nv">p</span> <span class="nv">q</span> : (pos p|pos q) &lt;-&gt; (p|q)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos p | pos q) &lt;-&gt; (p | q)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk234" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk234"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos p | pos q) &lt;-&gt; (p | q)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk235" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk235"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos p | pos q) -&gt; (p | q)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk236" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk236"><hr></label><div class="goal-conclusion"><span class="highlight">(p | q)%positive -&gt; (pos p | pos q)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk237" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk237"><span class="highlight"><span class="nb">intros</span> ([ |r|r],H); <span class="nb">simpl</span> <span class="kr">in</span> *; destr_eq H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">q = (r * p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p | q)%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk238" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk238"><hr></label><div class="goal-conclusion"><span class="highlight">(p | q)%positive -&gt; (pos p | pos q)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk239" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk239"><span class="highlight"><span class="kr">exists</span> <span class="nv">r</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p | q)%positive -&gt; (pos p | pos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk23a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk23a"><span class="highlight"><span class="nb">intros</span> (r,H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">q = (r * p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos p | pos q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kr">exists</span> (<span class="nv">pos</span> <span class="nv">r</span>); <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">f_equal</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk23b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk23b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">divide_Zpos_Zneg_r</span> <span class="nv">n</span> <span class="nv">p</span> : (n|pos p) &lt;-&gt; (n|neg p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n | pos p) &lt;-&gt; (n | neg p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk23c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk23c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n | pos p) &lt;-&gt; (n | neg p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span> (m,H); <span class="kr">exists</span> (-m); <span class="bp">now</span> <span class="nb">rewrite</span> mul_opp_l, &lt;- H.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk23d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk23d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">divide_Zpos_Zneg_l</span> <span class="nv">n</span> <span class="nv">p</span> : (pos p|n) &lt;-&gt; (neg p|n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos p | n) &lt;-&gt; (neg p | n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk23e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk23e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos p | n) &lt;-&gt; (neg p | n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span> (m,H); <span class="kr">exists</span> (-m); <span class="bp">now</span> <span class="nb">rewrite</span> mul_opp_l, &lt;- mul_opp_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab35"></a><h2 class="section">Correctness proofs for gcd</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk23f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk23f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ggcd_gcd</span> <span class="nv">a</span> <span class="nv">b</span> : fst (ggcd a b) = gcd a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst (ggcd a b) = gcd a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk240" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk240"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">fst (ggcd a b) = gcd a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |p|p], b <span class="kr">as</span> [ |q|q]; <span class="nb">simpl</span>; <span class="nb">auto</span>;
  <span class="nb">generalize</span> (Pos.ggcd_gcd p q); <span class="nb">destruct</span> Pos.ggcd <span class="kr">as</span> (g,(aa,bb));
  <span class="nb">simpl</span>; <span class="bp">congruence</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk241" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk241"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ggcd_correct_divisors</span> <span class="nv">a</span> <span class="nv">b</span> :
  <span class="kr">let</span> &#39;(g,(aa,bb)) := ggcd a b <span class="kr">in</span>
  a = g*aa /\ b = g*bb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span>
&#39;(g, (aa, bb)) := ggcd a b <span class="kr">in</span> a = g * aa /\ b = g * bb</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk242" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk242"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">let</span>
&#39;(g, (aa, bb)) := ggcd a b <span class="kr">in</span> a = g * aa /\ b = g * bb</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |p|p], b <span class="kr">as</span> [ |q|q]; <span class="nb">simpl</span>; <span class="nb">rewrite</span> ?Pos.mul_1_r; <span class="nb">auto</span>;
  <span class="nb">generalize</span> (Pos.ggcd_correct_divisors p q);
  <span class="nb">destruct</span> Pos.ggcd <span class="kr">as</span> (g,(aa,bb)); <span class="nb">simpl</span>; <span class="nb">destruct</span> <span class="mi">1</span>; <span class="bp">now</span> <span class="nb">subst</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk243" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk243"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gcd_divide_l</span> <span class="nv">a</span> <span class="nv">b</span> : (gcd a b | a).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(gcd a b | a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk244" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk244"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(gcd a b | a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk245" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk245"><span class="highlight"><span class="nb">rewrite</span> &lt;- ggcd_gcd.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(fst (ggcd a b) | a)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk246" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk246"><span class="highlight"><span class="nb">generalize</span> (ggcd_correct_divisors a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span>
 &#39;(g, (aa, bb)) := ggcd a b <span class="kr">in</span>
  a = g * aa /\ b = g * bb) -&gt; (fst (ggcd a b) | a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk247" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk247"><span class="highlight"><span class="nb">destruct</span> ggcd <span class="kr">as</span> (g,(aa,bb)); <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, g, aa, bb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = g * aa /\ b = g * bb -&gt; (g | a)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk248" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk248"><span class="highlight"><span class="nb">intros</span> (H,_).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, g, aa, bb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a = g * aa</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(g | a)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk249" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk249"><span class="highlight"><span class="kr">exists</span> <span class="nv">aa</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, g, aa, bb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">a = g * aa</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = aa * g</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> mul_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk24a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk24a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gcd_divide_r</span> <span class="nv">a</span> <span class="nv">b</span> : (gcd a b | b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(gcd a b | b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk24b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk24b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(gcd a b | b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk24c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk24c"><span class="highlight"><span class="nb">rewrite</span> &lt;- ggcd_gcd.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(fst (ggcd a b) | b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk24d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk24d"><span class="highlight"><span class="nb">generalize</span> (ggcd_correct_divisors a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span>
 &#39;(g, (aa, bb)) := ggcd a b <span class="kr">in</span>
  a = g * aa /\ b = g * bb) -&gt; (fst (ggcd a b) | b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk24e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk24e"><span class="highlight"><span class="nb">destruct</span> ggcd <span class="kr">as</span> (g,(aa,bb)); <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, g, aa, bb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">a = g * aa /\ b = g * bb -&gt; (g | b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk24f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk24f"><span class="highlight"><span class="nb">intros</span> (_,H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, g, aa, bb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = g * bb</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(g | b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk250" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk250"><span class="highlight"><span class="kr">exists</span> <span class="nv">bb</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, g, aa, bb</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = g * bb</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">b = bb * g</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> mul_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk251" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk251"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gcd_greatest</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : (c|a) -&gt; (c|b) -&gt; (c | gcd a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(c | a) -&gt; (c | b) -&gt; (c | gcd a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk252" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk252"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(c | a) -&gt; (c | b) -&gt; (c | gcd a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk253" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk253"><span class="highlight"><span class="nb">assert</span> (H : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> <span class="nv">r</span>, (r|pos p) -&gt; (r|pos q) -&gt; (r|pos (Pos.gcd p q))).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">p</span> <span class="nv">q</span> : positive) (<span class="nv">r</span> : Z),
(r | pos p) -&gt; (r | pos q) -&gt; (r | pos (Pos.gcd p q))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk254" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">p</span> <span class="nv">q</span> : positive) (<span class="nv">r</span> : Z),
(r | pos p) -&gt;
(r | pos q) -&gt; (r | pos (Pos.gcd p q))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk254"><hr></label><div class="goal-conclusion"><span class="highlight">(c | a) -&gt; (c | b) -&gt; (c | gcd a b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk255" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk255"><span class="highlight">{</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">p</span> <span class="nv">q</span> : positive) (<span class="nv">r</span> : Z),
(r | pos p) -&gt; (r | pos q) -&gt; (r | pos (Pos.gcd p q))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk256" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk256"><span class="highlight"><span class="nb">intros</span> p q [|r|r] H H&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">0</span> | pos p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">0</span> | pos q)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> | pos (Pos.gcd p q))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk257" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos r | pos p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos r | pos q)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk257"><hr></label><div class="goal-conclusion"><span class="highlight">(pos r | pos (Pos.gcd p q))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk258" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(neg r | pos p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(neg r | pos q)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk258"><hr></label><div class="goal-conclusion"><span class="highlight">(neg r | pos (Pos.gcd p q))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk259" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk259"><span class="highlight"><span class="nb">destruct</span> H; <span class="bp">now</span> <span class="nb">rewrite</span> mul_comm <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos r | pos p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos r | pos q)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(pos r | pos (Pos.gcd p q))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk25a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(neg r | pos p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(neg r | pos q)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk25a"><hr></label><div class="goal-conclusion"><span class="highlight">(neg r | pos (Pos.gcd p q))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk25b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk25b"><span class="highlight"><span class="nb">apply</span> divide_Zpos, Pos.gcd_greatest; <span class="bp">now</span> <span class="nb">apply</span> divide_Zpos.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(neg r | pos p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(neg r | pos q)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(neg r | pos (Pos.gcd p q))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> divide_Zpos_Zneg_l, divide_Zpos, Pos.gcd_greatest;
    <span class="bp">now</span> <span class="nb">apply</span> divide_Zpos, divide_Zpos_Zneg_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk25c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk25c"><span class="highlight">}</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">p</span> <span class="nv">q</span> : positive) (<span class="nv">r</span> : Z),
(r | pos p) -&gt;
(r | pos q) -&gt; (r | pos (Pos.gcd p q))</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(c | a) -&gt; (c | b) -&gt; (c | gcd a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a, b; <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="nb">intros</span>; <span class="kp">try</span> <span class="nb">apply</span> H; <span class="nb">trivial</span>;
  <span class="bp">now</span> <span class="nb">apply</span> divide_Zpos_Zneg_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk25d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk25d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gcd_nonneg</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="mi">0</span> &lt;= gcd a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= gcd a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk25e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk25e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= gcd a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a, b.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
ggcd and opp : an auxiliary result used in QArith 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk25f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk25f"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">ggcd_opp</span> <span class="nv">a</span> <span class="nv">b</span> :
  ggcd (-a) b = (<span class="kr">let</span> &#39;(g,(aa,bb)) := ggcd a b <span class="kr">in</span> (g,(-aa,bb))).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">ggcd (- a) b =
(<span class="kr">let</span> &#39;(g, (aa, bb)) := ggcd a b <span class="kr">in</span> (g, (- aa, bb)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk260" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk260"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">ggcd (- a) b =
(<span class="kr">let</span> &#39;(g, (aa, bb)) := ggcd a b <span class="kr">in</span> (g, (- aa, bb)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a|a], b <span class="kr">as</span> [|b|b]; <span class="nb">unfold</span> ggcd, opp; <span class="nb">auto</span>;
  <span class="nb">destruct</span> (Pos.ggcd a b) <span class="kr">as</span> (g,(aa,bb)); <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab36"></a><h2 class="section">Extra properties about <span class="inlinecode"><span class="id" title="var">testbit</span></span></h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk261" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk261"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_of_N</span> <span class="nv">a</span> <span class="nv">n</span> :
 testbit (of_N a) (of_N n) = N.testbit a n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (of_N a) (of_N n) = N.testbit a n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk262" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk262"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (of_N a) (of_N n) = N.testbit a n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk263" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk263"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a], n; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> a <span class="kr">with</span>
| (_~<span class="mi">0</span>)%positive =&gt; false
| _ =&gt; true
<span class="kr">end</span> = Pos.testbit a <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk264" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk264"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_of_N&#39;</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 testbit (of_N a) n = N.testbit a (to_N n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; testbit (of_N a) n = N.testbit a (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk265" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk265"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; testbit (of_N a) n = N.testbit a (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk266" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk266"><span class="highlight"><span class="nb">intro</span> Hn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (of_N a) n = N.testbit a (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk267" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk267"><span class="highlight"><span class="nb">rewrite</span> &lt;- testbit_of_N.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (of_N a) n = testbit (of_N a) (of_N (to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk268" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk268"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n = of_N (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n; <span class="nb">trivial</span>; <span class="bp">now</span> <span class="nb">destruct</span> Hn.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk269" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk269"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_Zpos</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 testbit (pos a) n = N.testbit (N.pos a) (to_N n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
testbit (pos a) n = N.testbit (N.pos a) (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
testbit (pos a) n = N.testbit (N.pos a) (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26b"><span class="highlight"><span class="nb">intro</span> Hn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (pos a) n = N.testbit (N.pos a) (to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- testbit_of_N&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_Zneg</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 testbit (neg a) n = negb (N.testbit (Pos.pred_N a) (to_N n)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
testbit (neg a) n =
negb (N.testbit (Pos.pred_N a) (to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
testbit (neg a) n =
negb (N.testbit (Pos.pred_N a) (to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26e"><span class="highlight"><span class="nb">intro</span> Hn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (neg a) n =
negb (N.testbit (Pos.pred_N a) (to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk26f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk26f"><span class="highlight"><span class="nb">rewrite</span> &lt;- testbit_of_N&#39; <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (neg a) n =
negb (testbit (of_N (Pos.pred_N a)) n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk270" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk270"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |n|n];
  [ | <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">destruct</span> (Pos.pred_N a) | <span class="bp">now</span> <span class="nb">destruct</span> Hn].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (neg a) <span class="mi">0</span> =
negb (testbit (of_N (Pos.pred_N a)) <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk271" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk271"><span class="highlight"><span class="nb">unfold</span> testbit.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">odd (neg a) = negb (odd (of_N (Pos.pred_N a)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a <span class="kr">as</span> [|[ | | ]| ].</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab37"></a><h2 class="section">Proofs of specifications for bitwise operations</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk272" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk272"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">div2_spec</span> <span class="nv">a</span> : div2 a = shiftr a <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">div2 a = shiftr a <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk273" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk273"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">div2 a = shiftr a <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk274" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk274"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_0_l</span> <span class="nv">n</span> : testbit <span class="mi">0</span> n = false.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit <span class="mi">0</span> n = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk275" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk275"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit <span class="mi">0</span> n = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk276" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk276"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_neg_r</span> <span class="nv">a</span> <span class="nv">n</span> : n&lt;<span class="mi">0</span> -&gt; testbit a n = false.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; <span class="mi">0</span> -&gt; testbit a n = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk277" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk277"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; <span class="mi">0</span> -&gt; testbit a n = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk278" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk278"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_odd_0</span> <span class="nv">a</span> : testbit (<span class="mi">2</span>*a+<span class="mi">1</span>) <span class="mi">0</span> = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) <span class="mi">0</span> = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk279" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk279"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) <span class="mi">0</span> = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a <span class="kr">as</span> [|a|[a|a|]].</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk27a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk27a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_even_0</span> <span class="nv">a</span> : testbit (<span class="mi">2</span>*a) <span class="mi">0</span> = false.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a) <span class="mi">0</span> = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk27b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk27b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a) <span class="mi">0</span> = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk27c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk27c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_odd_succ</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 testbit (<span class="mi">2</span>*a+<span class="mi">1</span>) (succ n) = testbit a n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) (succ n) = testbit a n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk27d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk27d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) (succ n) = testbit a n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk27e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk27e"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|n|n]; (<span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>) || <span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) (succ <span class="mi">0</span>) = testbit a <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk27f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk27f"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) (succ (pos n)) = testbit a (pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk280" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk280"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|[a|a|]|[a|a|]]; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb (Pos.testbit (Pos.pred_double a) <span class="mi">0</span>) = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk281" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk281"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) (succ (pos n)) = testbit a (pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk282" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk282"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a + <span class="mi">1</span>) (succ (pos n)) = testbit a (pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk283" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk283"><span class="highlight"><span class="nb">unfold</span> testbit; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span>
  <span class="kr">match</span> a <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; <span class="mi">0</span>
  | pos y&#39; =&gt; pos y&#39;~<span class="mi">0</span>
  | neg y&#39; =&gt; neg y&#39;~<span class="mi">0</span>
  <span class="kr">end</span> + <span class="mi">1</span>
<span class="kr">with</span>
| <span class="mi">0</span> =&gt; false
| pos a0 =&gt; Pos.testbit a0 (N.pos (n + <span class="mi">1</span>))
| neg a0 =&gt;
    negb (N.testbit (Pos.pred_N a0) (N.pos (n + <span class="mi">1</span>)))
<span class="kr">end</span> =
<span class="kr">match</span> a <span class="kr">with</span>
| <span class="mi">0</span> =&gt; false
| pos a0 =&gt; Pos.testbit a0 (N.pos n)
| neg a0 =&gt; negb (N.testbit (Pos.pred_N a0) (N.pos n))
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a|[a|a|]]; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
  <span class="nb">rewrite</span> ?Pos.add_1_r, ?Pos.pred_N_succ; <span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk284" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk284"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_even_succ</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 testbit (<span class="mi">2</span>*a) (succ n) = testbit a n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; testbit (<span class="mi">2</span> * a) (succ n) = testbit a n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk285" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk285"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt; testbit (<span class="mi">2</span> * a) (succ n) = testbit a n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk286" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk286"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|n|n]; (<span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>) || <span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a) (succ <span class="mi">0</span>) = testbit a <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk287" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk287"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a) (succ (pos n)) = testbit a (pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk288" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk288"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|[a|a|]|[a|a|]]; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb (Pos.testbit (Pos.pred_double a) <span class="mi">0</span>) = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk289" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk289"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a) (succ (pos n)) = testbit a (pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28a"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (<span class="mi">2</span> * a) (succ (pos n)) = testbit a (pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28b"><span class="highlight"><span class="nb">unfold</span> testbit; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span>
  <span class="kr">match</span> a <span class="kr">with</span>
  | <span class="mi">0</span> =&gt; <span class="mi">0</span>
  | pos y&#39; =&gt; pos y&#39;~<span class="mi">0</span>
  | neg y&#39; =&gt; neg y&#39;~<span class="mi">0</span>
  <span class="kr">end</span>
<span class="kr">with</span>
| <span class="mi">0</span> =&gt; false
| pos a0 =&gt; Pos.testbit a0 (N.pos (n + <span class="mi">1</span>))
| neg a0 =&gt;
    negb (N.testbit (Pos.pred_N a0) (N.pos (n + <span class="mi">1</span>)))
<span class="kr">end</span> =
<span class="kr">match</span> a <span class="kr">with</span>
| <span class="mi">0</span> =&gt; false
| pos a0 =&gt; Pos.testbit a0 (N.pos n)
| neg a0 =&gt; negb (N.testbit (Pos.pred_N a0) (N.pos n))
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [|a|[a|a|]]; <span class="nb">simpl</span>; <span class="nb">trivial</span>;
  <span class="nb">rewrite</span> ?Pos.add_1_r, ?Pos.pred_N_succ; <span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Correctness proofs about <span class="inlinecode"><span class="id" title="var">Z.shiftr</span></span> and <span class="inlinecode"><span class="id" title="var">Z.shiftl</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">shiftr_spec_aux</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">m</span> : <span class="mi">0</span>&lt;=n -&gt; <span class="mi">0</span>&lt;=m -&gt;
 testbit (shiftr a n) m = testbit a (m+n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
<span class="mi">0</span> &lt;= m -&gt; testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
<span class="mi">0</span> &lt;= m -&gt; testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28e"><span class="highlight"><span class="nb">intros</span> Hn Hm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk28f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk28f"><span class="highlight"><span class="nb">unfold</span> shiftr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (- n)) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk290" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk290"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |n|n]; (<span class="bp">now</span> <span class="nb">destruct</span> Hn) || <span class="nb">clear</span> Hn; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit a m = testbit a (m + <span class="mi">0</span>)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk291" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk291"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk292" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk292"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> add_0_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk293" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk293"><span class="highlight"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">p</span>, to_N (m + pos p) = (to_N m + N.pos p)%N).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk294" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk294"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk295" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk295"><span class="highlight"><span class="nb">destruct</span> m; <span class="nb">trivial</span>; <span class="bp">now</span> <span class="nb">destruct</span> Hm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk296" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk296"><span class="highlight"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">p</span>, <span class="mi">0</span> &lt;= m + pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk297" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk297"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk298" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk298"><span class="highlight"><span class="nb">destruct</span> m; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> Hm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk299" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk299"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 <span class="mi">0</span> n) m = testbit <span class="mi">0</span> (m + pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk29a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk29a"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (pos a) n) m =
testbit (pos a) (m + pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk29b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk29b"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* a = 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk29c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk29c"><span class="highlight"><span class="nb">replace</span> (Pos.iter div2 <span class="mi">0</span> n) <span class="kr">with</span> <span class="mi">0</span>
  <span class="bp">by</span> (<span class="nb">apply</span> Pos.iter_invariant; <span class="nb">intros</span>; <span class="nb">subst</span>; <span class="nb">trivial</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit <span class="mi">0</span> m = testbit <span class="mi">0</span> (m + pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk29d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk29d"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (pos a) n) m =
testbit (pos a) (m + pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk29e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk29e"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk29f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk29f"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> <span class="mi">2</span> testbit_0_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (pos a) n) m =
testbit (pos a) (m + pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2a0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2a0"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* a &gt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a1"><span class="highlight"><span class="nb">change</span> (pos a) <span class="kr">with</span> (of_N (N.pos a)) <span class="nb">at</span> <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (of_N (N.pos a)) n) m =
testbit (pos a) (m + pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2a2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2a2"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a3"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.iter_swap_gen _ _ _ N.div2) <span class="bp">by</span> <span class="bp">now</span> <span class="nb">intros</span> [|[ | | ]].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (of_N (Pos.iter N.div2 (N.pos a) n)) m =
testbit (pos a) (m + pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2a4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2a4"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a5"><span class="highlight"><span class="nb">rewrite</span> testbit_Zpos, testbit_of_N&#39;, H; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.iter N.div2 (N.pos a) n) (to_N m) =
N.testbit (N.pos a) (to_N m + N.pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2a6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2a6"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a7"><span class="highlight"><span class="bp">exact</span> (N.shiftr_spec&#39; (N.pos a) (N.pos n) (to_N m)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 (neg a) n) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* a &lt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a8"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.iter_swap_gen _ _ _ Pos.div2_up) <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (neg (Pos.iter Pos.div2_up a n)) m =
testbit (neg a) (m + pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2a9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2a9"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> testbit_Zneg, H; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (Pos.pred_N (Pos.iter Pos.div2_up a n))
     (to_N m)) =
negb (N.testbit (Pos.pred_N a) (to_N m + N.pos n))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2aa" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2aa"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.pred_N (Pos.iter Pos.div2_up a n))
  (to_N m) =
N.testbit (Pos.pred_N a) (to_N m + N.pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ab" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ab"><span class="highlight"><span class="nb">rewrite</span> (Pos.iter_swap_gen _ _ _ _ N.div2) <span class="bp">by</span> <span class="bp">exact</span> N.pred_div2_up.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive,
to_N (m + pos p) = (to_N m + N.pos p)%N</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> : positive, <span class="mi">0</span> &lt;= m + pos p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.iter N.div2 (Pos.pred_N a) n) (to_N m) =
N.testbit (Pos.pred_N a) (to_N m + N.pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (N.shiftr_spec&#39; (Pos.pred_N a) (N.pos n) (to_N m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ac" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ac"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">shiftl_spec_low</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">m</span> : m&lt;n -&gt;
 testbit (shiftl a n) m = false.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt; n -&gt; testbit (shiftl a n) m = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ad" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ad"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt; n -&gt; testbit (shiftl a n) m = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ae" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ae"><span class="highlight"><span class="nb">intros</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a n) m = false</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2af" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2af"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [|n|n], m <span class="kr">as</span> [|m|m]; <span class="kp">try</span> <span class="bp">easy</span>; <span class="nb">simpl</span> shiftl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) a n) <span class="mi">0</span> = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2b0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2b0"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) a n) (pos m) = false</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2b1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2b1"><span class="highlight"><span class="nb">destruct</span> (Pos.succ_pred_or n) <span class="kr">as</span> [-&gt; | &lt;-];
  <span class="nb">rewrite</span> ?Pos.iter_succ; <span class="nb">apply</span> testbit_even_0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) a n) (pos m) = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2b2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2b2"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) <span class="mi">0</span> n) (pos m) = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2b3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2b3"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (pos a) n) (pos m) = false</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2b4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2b4"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg a) n) (pos m) = false</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* a = 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2b5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2b5"><span class="highlight"><span class="nb">replace</span> (Pos.iter (mul <span class="mi">2</span>) <span class="mi">0</span> n) <span class="kr">with</span> <span class="mi">0</span>
  <span class="bp">by</span> (<span class="nb">apply</span> Pos.iter_invariant; <span class="nb">intros</span>; <span class="nb">subst</span>; <span class="nb">trivial</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit <span class="mi">0</span> (pos m) = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2b6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2b6"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (pos a) n) (pos m) = false</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2b7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2b7"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg a) n) (pos m) = false</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2b8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2b8"><span class="highlight"><span class="nb">apply</span> testbit_0_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (pos a) n) (pos m) = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2b9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2b9"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg a) n) (pos m) = false</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* a &gt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ba" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ba"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.iter_swap_gen _ _ _ xO) <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (pos (Pos.iter xO a n)) (pos m) = false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2bb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2bb"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg a) n) (pos m) = false</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2bc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2bc"><span class="highlight"><span class="nb">rewrite</span> testbit_Zpos <span class="bp">by</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.pos (Pos.iter xO a n)) (to_N (pos m)) =
false</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2bd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2bd"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg a) n) (pos m) = false</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2be" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2be"><span class="highlight"><span class="bp">exact</span> (N.shiftl_spec_low (N.pos a) (N.pos n) (N.pos m) H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg a) n) (pos m) = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* a &lt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2bf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2bf"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.iter_swap_gen _ _ _ xO) <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (neg (Pos.iter xO a n)) (pos m) = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c0"><span class="highlight"><span class="nb">rewrite</span> testbit_Zneg <span class="bp">by</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos m &lt; pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (Pos.pred_N (Pos.iter xO a n))
     (to_N (pos m))) = false</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> (N.pos_pred_shiftl_low a (N.pos n)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">shiftl_spec_high</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">m</span> : <span class="mi">0</span>&lt;=m -&gt; n&lt;=m -&gt;
 testbit (shiftl a n) m = testbit a (m-n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= m -&gt;
n &lt;= m -&gt; testbit (shiftl a n) m = testbit a (m - n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= m -&gt;
n &lt;= m -&gt; testbit (shiftl a n) m = testbit a (m - n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c3"><span class="highlight"><span class="nb">intros</span> Hm H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a n) m = testbit a (m - n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c4"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |n|n].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm, H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a <span class="mi">0</span>) m = testbit a (m - <span class="mi">0</span>)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2c5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2c5"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) m = testbit a (m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2c6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2c6"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2c7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2c7"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm, H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit a m = testbit a (m - <span class="mi">0</span>)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2c8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2c8"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) m = testbit a (m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2c9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2c9"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ca" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ca"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> sub_0_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) m = testbit a (m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2cb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2cb"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* n &gt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2cc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2cc"><span class="highlight"><span class="nb">destruct</span> m <span class="kr">as</span> [ |m|m]; <span class="kp">try</span> (<span class="bp">now</span> <span class="nb">destruct</span> H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2cd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2cd"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ce" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ce"><span class="highlight"><span class="nb">assert</span> (<span class="mi">0</span> &lt;= pos m - pos n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2cf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2cf"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2d0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2d0"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2d1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2d1"><span class="highlight"><span class="nb">red</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> ?= pos m - pos n) &lt;&gt; Gt</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2d2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2d2"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2d3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2d3"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2d4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2d4"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> compare_antisym, &lt;- compare_sub, &lt;- compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2d5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2d5"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2d6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2d6"><span class="highlight"><span class="nb">assert</span> (EQ : to_N (pos m - pos n) = (N.pos m - N.pos n)%N).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2d7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2d7"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2d8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2d8"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2d9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2d9"><span class="highlight"><span class="nb">red</span> <span class="kr">in</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(pos n ?= pos m) &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2da" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2da"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2db" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2db"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2dc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2dc"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n ?= m)%positive &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2dd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2dd"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2de" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2de"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2df" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2df"><span class="highlight"><span class="nb">simpl</span> to_N.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n ?= m)%positive &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N (pos_sub m n) = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e0"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e1"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2e2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2e2"><span class="highlight"><span class="nb">rewrite</span> pos_sub_spec, Pos.compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n ?= m)%positive &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N
  <span class="kr">match</span> CompOpp (n ?= m)%positive <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (n - m)
  | Gt =&gt; pos (m - n)
  <span class="kr">end</span> = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e3"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e4"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2e5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2e5"><span class="highlight"><span class="nb">destruct</span> (Pos.compare_spec n m) <span class="kr">as</span> [H&#39;|H&#39;|H&#39;]; <span class="kp">try</span> (<span class="bp">now</span> <span class="nb">destruct</span> H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Eq &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n = m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N
  <span class="kr">match</span> CompOpp Eq <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (n - m)
  | Gt =&gt; pos (m - n)
  <span class="kr">end</span> = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Lt &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; m)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e6"><hr></label><div class="goal-conclusion"><span class="highlight">to_N
  <span class="kr">match</span> CompOpp Lt <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (n - m)
  | Gt =&gt; pos (m - n)
  <span class="kr">end</span> = (N.pos m - N.pos n)%N</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e7"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2e8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2e8"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2e9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2e9"><span class="highlight"><span class="nb">subst</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Eq &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N
  <span class="kr">match</span> CompOpp Eq <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (m - m)
  | Gt =&gt; pos (m - m)
  <span class="kr">end</span> = (N.pos m - N.pos m)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2ea" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Lt &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; m)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2ea"><hr></label><div class="goal-conclusion"><span class="highlight">to_N
  <span class="kr">match</span> CompOpp Lt <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (n - m)
  | Gt =&gt; pos (m - n)
  <span class="kr">end</span> = (N.pos m - N.pos n)%N</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2eb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2eb"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2ec" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2ec"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ed" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ed"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.sub_diag.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Lt &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; m)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">to_N
  <span class="kr">match</span> CompOpp Lt <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; neg (n - m)
  | Gt =&gt; pos (m - n)
  <span class="kr">end</span> = (N.pos m - N.pos n)%N</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2ee" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2ee"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2ef" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2ef"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2f0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2f0"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Lt &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; m)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.pos (m - n) =
<span class="kr">match</span> Pos.sub_mask m n <span class="kr">with</span>
| Pos.IsPos p =&gt; N.pos p
| _ =&gt; <span class="mi">0</span>%N
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2f1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2f1"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2f2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2f2"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2f3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2f3"><span class="highlight"><span class="nb">destruct</span> (Pos.sub_mask_pos&#39; m n H&#39;) <span class="kr">as</span> (p &amp; -&gt; &amp; &lt;-).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos (n + p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Lt &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; n + p)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos (n + p) - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.pos (n + p - n) = N.pos p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2f4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2f4"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2f5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2f5"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2f6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2f6"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos (n + p)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Lt &lt;&gt; Gt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; n + p)%positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos (n + p) - pos n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + p - n)%positive = p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2f7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2f7"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2f8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2f8"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2f9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2f9"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_comm, Pos.add_sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (pos n)) (pos m) =
testbit a (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2fa" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2fa"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2fb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2fb"><span class="highlight"><span class="nb">destruct</span> a; <span class="nb">unfold</span> shiftl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) <span class="mi">0</span> n) (pos m) =
testbit <span class="mi">0</span> (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk2fc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2fc"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (pos p) n) (pos m) =
testbit (pos p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2fd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2fd"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg p) n) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk2fe" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk2fe"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* ... a = 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk2ff" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk2ff"><span class="highlight"><span class="nb">replace</span> (Pos.iter (mul <span class="mi">2</span>) <span class="mi">0</span> n) <span class="kr">with</span> <span class="mi">0</span>
  <span class="bp">by</span> (<span class="nb">apply</span> Pos.iter_invariant; <span class="nb">intros</span>; <span class="nb">subst</span>; <span class="nb">trivial</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit <span class="mi">0</span> (pos m) = testbit <span class="mi">0</span> (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk300" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk300"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (pos p) n) (pos m) =
testbit (pos p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk301" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk301"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg p) n) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk302" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk302"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk303" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk303"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> <span class="mi">2</span> testbit_0_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (pos p) n) (pos m) =
testbit (pos p) (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk304" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk304"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg p) n) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk305" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk305"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* ... a &gt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk306" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk306"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.iter_swap_gen _ _ _ xO) <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (pos (Pos.iter xO p n)) (pos m) =
testbit (pos p) (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk307" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk307"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg p) n) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk308" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk308"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk309" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk309"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> testbit_Zpos, EQ <span class="bp">by</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.pos (Pos.iter xO p n)) (to_N (pos m)) =
N.testbit (N.pos p) (N.pos m - N.pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk30a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk30a"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg p) n) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk30b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk30b"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk30c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk30c"><span class="highlight"><span class="bp">exact</span> (N.shiftl_spec_high&#39; (N.pos p) (N.pos n) (N.pos m) H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter (mul <span class="mi">2</span>) (neg p) n) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk30d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk30d"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* ... a &lt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk30e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk30e"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.iter_swap_gen _ _ _ xO) <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (neg (Pos.iter xO p n)) (pos m) =
testbit (neg p) (pos m - pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk30f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk30f"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk310" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk310"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> testbit_Zneg, EQ <span class="bp">by</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (Pos.pred_N (Pos.iter xO p n))
     (to_N (pos m))) =
negb (N.testbit (Pos.pred_N p) (N.pos m - N.pos n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk311" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk311"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk312" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk312"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.pred_N (Pos.iter xO p n))
  (to_N (pos m)) =
N.testbit (Pos.pred_N p) (N.pos m - N.pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk313" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk313"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk314" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk314"><span class="highlight"><span class="nb">simpl</span> to_N.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.pred_N (Pos.iter xO p n)) (N.pos m) =
N.testbit (Pos.pred_N p) (N.pos m - N.pos n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk315" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk315"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk316" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk316"><span class="highlight"><span class="nb">rewrite</span> &lt;- N.shiftl_spec_high <span class="bp">by</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">pos n &lt;= pos m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= pos m - pos n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">to_N (pos m - pos n) = (N.pos m - N.pos n)%N</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.pred_N (Pos.iter xO p n)) (N.pos m) =
N.testbit (N.shiftl (Pos.pred_N p) (N.pos n))
  (N.pos m)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk317" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk317"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk318" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk318"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (N.pos_pred_shiftl_high p (N.pos n)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m - neg n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight"> <span class="c">(* n &lt; 0 *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk319" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk319"><span class="highlight"><span class="nb">unfold</span> sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (neg n)) m = testbit a (m + - neg n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk31a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk31a"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">neg n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (Pos.iter div2 a n) m = testbit a (m + pos n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (shiftr_spec_aux a (pos n) m).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk31b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk31b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">shiftr_spec</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">m</span> : <span class="mi">0</span>&lt;=m -&gt;
 testbit (shiftr a n) m = testbit a (m+n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= m -&gt; testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk31c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk31c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= m -&gt; testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk31d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk31d"><span class="highlight"><span class="nb">intros</span> Hm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk31e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk31e"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk31f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk31f"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk320" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk320"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> shiftr_spec_aux.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk321" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk321"><span class="highlight"><span class="nb">destruct</span> (leb_spec (-n) m) <span class="kr">as</span> [LE|GT].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">- n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk322" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk322"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk323" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk323"><span class="highlight"><span class="nb">unfold</span> shiftr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">- n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (- n)) m = testbit a (m + n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk324" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk324"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk325" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk325"><span class="highlight"><span class="nb">rewrite</span> (shiftl_spec_high a (-n) m); <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">- n &lt;= m</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit a (m - - n) = testbit a (m + n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk326" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk326"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk327" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk327"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftr a n) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk328" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk328"><span class="highlight"><span class="nb">unfold</span> shiftr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (shiftl a (- n)) m = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk329" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk329"><span class="highlight"><span class="nb">rewrite</span> (shiftl_spec_low a (-n) m); <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">false = testbit a (m + n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk32a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk32a"><span class="highlight"><span class="nb">rewrite</span> testbit_neg_r; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m &lt; - n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m + n &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk32b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk32b"><span class="highlight"><span class="nb">red</span> <span class="kr">in</span> GT.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m ?= - n) = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m + n &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk32c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk32c"><span class="highlight"><span class="nb">rewrite</span> compare_sub <span class="kr">in</span> GT.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt; <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m - - n ?= <span class="mi">0</span>) = Lt</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m + n &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Correctness proofs for bitwise operations 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk32d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk32d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lor_spec</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span> :
 testbit (lor a b) n = testbit a n || testbit b n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (lor a b) n = testbit a n || testbit b n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk32e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk32e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (lor a b) n = testbit a n || testbit b n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk32f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk32f"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> n) <span class="kr">as</span> [Hn|Hn]; [|<span class="bp">now</span> <span class="nb">rewrite</span> !testbit_neg_r].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (lor a b) n = testbit a n || testbit b n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk330" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk330"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a], b <span class="kr">as</span> [ |b|b];
  <span class="nb">rewrite</span> ?testbit_0_l, ?orb_false_r; <span class="nb">trivial</span>; <span class="nb">unfold</span> lor;
  <span class="nb">rewrite</span> ?testbit_Zpos, ?testbit_Zneg, ?N.pos_pred_succ <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.pos (Pos.lor a b)) (to_N n) =
N.testbit (N.pos a) (to_N n)
|| N.testbit (N.pos b) (to_N n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk331" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk331"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.ldiff (Pos.pred_N b) (N.pos a))
     (to_N n)) =
N.testbit (N.pos a) (to_N n)
|| negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk332" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk332"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.ldiff (Pos.pred_N a) (N.pos b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| N.testbit (N.pos b) (to_N n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk333" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk333"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.land (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk334" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk334"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- N.lor_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.ldiff (Pos.pred_N b) (N.pos a))
     (to_N n)) =
N.testbit (N.pos a) (to_N n)
|| negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk335" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk335"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.ldiff (Pos.pred_N a) (N.pos b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| N.testbit (N.pos b) (to_N n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk336" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk336"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.land (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk337" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk337"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.ldiff_spec, negb_andb, negb_involutive, orb_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.ldiff (Pos.pred_N a) (N.pos b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| N.testbit (N.pos b) (to_N n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk338" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk338"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.land (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk339" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk339"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.ldiff_spec, negb_andb, negb_involutive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.land (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n))
|| negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.land_spec, negb_andb.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk33a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk33a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">land_spec</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span> :
 testbit (land a b) n = testbit a n &amp;&amp; testbit b n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (land a b) n = testbit a n &amp;&amp; testbit b n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk33b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk33b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (land a b) n = testbit a n &amp;&amp; testbit b n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk33c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk33c"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> n) <span class="kr">as</span> [Hn|Hn]; [|<span class="bp">now</span> <span class="nb">rewrite</span> !testbit_neg_r].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (land a b) n = testbit a n &amp;&amp; testbit b n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk33d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk33d"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a], b <span class="kr">as</span> [ |b|b];
  <span class="nb">rewrite</span> ?testbit_0_l, ?andb_false_r; <span class="nb">trivial</span>; <span class="nb">unfold</span> land;
  <span class="nb">rewrite</span> ?testbit_Zpos, ?testbit_Zneg, ?testbit_of_N&#39;, ?N.pos_pred_succ
   <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.land a b) (to_N n) =
N.testbit (N.pos a) (to_N n) &amp;&amp;
N.testbit (N.pos b) (to_N n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk33e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk33e"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (N.pos a) (Pos.pred_N b)) (to_N n) =
N.testbit (N.pos a) (to_N n) &amp;&amp;
negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk33f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk33f"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (N.pos b) (Pos.pred_N a)) (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
N.testbit (N.pos b) (to_N n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk340" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk340"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk341" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk341"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- N.land_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (N.pos a) (Pos.pred_N b)) (to_N n) =
N.testbit (N.pos a) (to_N n) &amp;&amp;
negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk342" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk342"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (N.pos b) (Pos.pred_N a)) (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
N.testbit (N.pos b) (to_N n)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk343" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk343"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk344" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk344"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.ldiff_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (N.pos b) (Pos.pred_N a)) (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
N.testbit (N.pos b) (to_N n)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk345" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk345"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk346" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk346"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.ldiff_spec, andb_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (Pos.pred_N b))
     (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (Pos.pred_N b) (to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.lor_spec, negb_orb.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk347" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk347"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ldiff_spec</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span> :
 testbit (ldiff a b) n = testbit a n &amp;&amp; negb (testbit b n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ldiff a b) n =
testbit a n &amp;&amp; negb (testbit b n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk348" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk348"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ldiff a b) n =
testbit a n &amp;&amp; negb (testbit b n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk349" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk349"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> n) <span class="kr">as</span> [Hn|Hn]; [|<span class="bp">now</span> <span class="nb">rewrite</span> !testbit_neg_r].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ldiff a b) n =
testbit a n &amp;&amp; negb (testbit b n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk34a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk34a"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a], b <span class="kr">as</span> [ |b|b];
  <span class="nb">rewrite</span> ?testbit_0_l, ?andb_true_r; <span class="nb">trivial</span>; <span class="nb">unfold</span> ldiff;
  <span class="nb">rewrite</span> ?testbit_Zpos, ?testbit_Zneg, ?testbit_of_N&#39;, ?N.pos_pred_succ
   <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.ldiff a b) (to_N n) =
N.testbit (N.pos a) (to_N n) &amp;&amp;
negb (N.testbit (N.pos b) (to_N n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk34b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk34b"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.land (N.pos a) (Pos.pred_N b)) (to_N n) =
N.testbit (N.pos a) (to_N n) &amp;&amp;
negb (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk34c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk34c"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (N.pos b)) (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (N.pos b) (to_N n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk34d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk34d"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (Pos.pred_N b) (Pos.pred_N a))
  (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk34e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk34e"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- N.ldiff_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.land (N.pos a) (Pos.pred_N b)) (to_N n) =
N.testbit (N.pos a) (to_N n) &amp;&amp;
negb (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk34f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk34f"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (N.pos b)) (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (N.pos b) (to_N n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk350" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk350"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (Pos.pred_N b) (Pos.pred_N a))
  (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk351" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk351"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.land_spec, negb_involutive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lor (Pos.pred_N a) (N.pos b)) (to_N n)) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (N.testbit (N.pos b) (to_N n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk352" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk352"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (Pos.pred_N b) (Pos.pred_N a))
  (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk353" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk353"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.lor_spec, negb_orb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.ldiff (Pos.pred_N b) (Pos.pred_N a))
  (to_N n) =
negb (N.testbit (Pos.pred_N a) (to_N n)) &amp;&amp;
negb (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.ldiff_spec, negb_involutive, andb_comm.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk354" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk354"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lxor_spec</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span> :
 testbit (lxor a b) n = xorb (testbit a n) (testbit b n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (lxor a b) n =
xorb (testbit a n) (testbit b n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk355" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk355"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (lxor a b) n =
xorb (testbit a n) (testbit b n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk356" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk356"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> n) <span class="kr">as</span> [Hn|Hn]; [|<span class="bp">now</span> <span class="nb">rewrite</span> !testbit_neg_r].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (lxor a b) n =
xorb (testbit a n) (testbit b n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk357" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk357"><span class="highlight"><span class="nb">destruct</span> a <span class="kr">as</span> [ |a|a], b <span class="kr">as</span> [ |b|b];
  <span class="nb">rewrite</span> ?testbit_0_l, ?xorb_false_l, ?xorb_false_r; <span class="nb">trivial</span>; <span class="nb">unfold</span> lxor;
  <span class="nb">rewrite</span> ?testbit_Zpos, ?testbit_Zneg, ?testbit_of_N&#39;, ?N.pos_pred_succ
   <span class="bp">by</span> <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (Pos.lxor a b) (to_N n) =
xorb (N.testbit (N.pos a) (to_N n))
  (N.testbit (N.pos b) (to_N n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk358" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk358"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lxor (N.pos a) (Pos.pred_N b))
     (to_N n)) =
xorb (N.testbit (N.pos a) (to_N n))
  (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk359" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk359"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lxor (Pos.pred_N a) (N.pos b))
     (to_N n)) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (N.testbit (N.pos b) (to_N n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk35a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk35a"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.lxor (Pos.pred_N a) (Pos.pred_N b))
  (to_N n) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk35b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk35b"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- N.lxor_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lxor (N.pos a) (Pos.pred_N b))
     (to_N n)) =
xorb (N.testbit (N.pos a) (to_N n))
  (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk35c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk35c"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lxor (Pos.pred_N a) (N.pos b))
     (to_N n)) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (N.testbit (N.pos b) (to_N n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk35d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk35d"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.lxor (Pos.pred_N a) (Pos.pred_N b))
  (to_N n) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk35e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk35e"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.lxor_spec, negb_xorb_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">negb
  (N.testbit (N.lxor (Pos.pred_N a) (N.pos b))
     (to_N n)) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (N.testbit (N.pos b) (to_N n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk35f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk35f"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.lxor (Pos.pred_N a) (Pos.pred_N b))
  (to_N n) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk360" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk360"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.lxor_spec, negb_xorb_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">N.testbit (N.lxor (Pos.pred_N a) (Pos.pred_N b))
  (to_N n) =
xorb (negb (N.testbit (Pos.pred_N a) (to_N n)))
  (negb (N.testbit (Pos.pred_N b) (to_N n)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> N.lxor_spec, xorb_negb_negb.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Generic properties of advanced functions. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Include</span> ZExtraProp.</span></span></span></pre><div class="doc">
In generic statements, the predicates <span class="inlinecode"><span class="id" title="var">lt</span></span> and <span class="inlinecode"><span class="id" title="var">le</span></span> have been
  favored, whereas <span class="inlinecode"><span class="id" title="var">gt</span></span> and <span class="inlinecode"><span class="id" title="var">ge</span></span> don't even exist in the abstract
  layers. The use of <span class="inlinecode"><span class="id" title="var">gt</span></span> and <span class="inlinecode"><span class="id" title="var">ge</span></span> is hence not recommended. We provide
  here the bare minimal results to related them with <span class="inlinecode"><span class="id" title="var">lt</span></span> and <span class="inlinecode"><span class="id" title="var">le</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk361" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk361"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_lt_iff</span> <span class="nv">n</span> <span class="nv">m</span> : n &gt; m &lt;-&gt; m &lt; n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt; m &lt;-&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk362" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk362"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt; m &lt;-&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk363" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk363"><span class="highlight"><span class="nb">unfold</span> lt, gt.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) = Gt &lt;-&gt; (m ?= n) = Lt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> compare_antisym, CompOpp_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk364" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk364"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_lt</span> <span class="nv">n</span> <span class="nv">m</span> : n &gt; m -&gt; m &lt; n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt; m -&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk365" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk365"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt; m -&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> gt_lt_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk366" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk366"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_gt</span> <span class="nv">n</span> <span class="nv">m</span> : n &lt; m -&gt; m &gt; n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; m -&gt; m &gt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk367" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk367"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt; m -&gt; m &gt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> gt_lt_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk368" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk368"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ge_le_iff</span> <span class="nv">n</span> <span class="nv">m</span> : n &gt;= m &lt;-&gt; m &lt;= n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt;= m &lt;-&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk369" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk369"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt;= m &lt;-&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk36a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk36a"><span class="highlight"><span class="nb">unfold</span> le, ge.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n ?= m) &lt;&gt; Lt &lt;-&gt; (m ?= n) &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> compare_antisym, CompOpp_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk36b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk36b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ge_le</span> <span class="nv">n</span> <span class="nv">m</span> : n &gt;= m -&gt; m &lt;= n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt;= m -&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk36c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk36c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &gt;= m -&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> ge_le_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk36d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk36d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">le_ge</span> <span class="nv">n</span> <span class="nv">m</span> : n &lt;= m -&gt; m &gt;= n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= m -&gt; m &gt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk36e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk36e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n &lt;= m -&gt; m &gt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> ge_le_iff.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
We provide a tactic converting from one style to the other. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">swap_greater</span> := <span class="nb">rewrite</span> ?gt_lt_iff <span class="kr">in</span> *; <span class="nb">rewrite</span> ?ge_le_iff <span class="kr">in</span> *.</span></span></span></pre><div class="doc">
Similarly, the boolean comparisons <span class="inlinecode"><span class="id" title="var">ltb</span></span> and <span class="inlinecode"><span class="id" title="var">leb</span></span> are favored
  over their dual <span class="inlinecode"><span class="id" title="var">gtb</span></span> and <span class="inlinecode"><span class="id" title="var">geb</span></span>. We prove here the equivalence
  and a few minimal results. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk36f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk36f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gtb_ltb</span> <span class="nv">n</span> <span class="nv">m</span> : (n &gt;? m) = (m &lt;? n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;? m) = (m &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk370" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk370"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;? m) = (m &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk371" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk371"><span class="highlight"><span class="nb">unfold</span> gtb, ltb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> n ?= m <span class="kr">with</span>
| Gt =&gt; true
| _ =&gt; false
<span class="kr">end</span> = <span class="kr">match</span> m ?= n <span class="kr">with</span>
      | Lt =&gt; true
      | _ =&gt; false
      <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk372" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk372"><span class="highlight"><span class="nb">rewrite</span> compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> CompOpp (m ?= n) <span class="kr">with</span>
| Gt =&gt; true
| _ =&gt; false
<span class="kr">end</span> = <span class="kr">match</span> m ?= n <span class="kr">with</span>
      | Lt =&gt; true
      | _ =&gt; false
      <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">case</span> <span class="nb">compare</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk373" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk373"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">geb_leb</span> <span class="nv">n</span> <span class="nv">m</span> : (n &gt;=? m) = (m &lt;=? n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;=? m) = (m &lt;=? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk374" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk374"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;=? m) = (m &lt;=? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk375" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk375"><span class="highlight"><span class="nb">unfold</span> geb, leb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> n ?= m <span class="kr">with</span>
| Lt =&gt; false
| _ =&gt; true
<span class="kr">end</span> = <span class="kr">match</span> m ?= n <span class="kr">with</span>
      | Gt =&gt; false
      | _ =&gt; true
      <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk376" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk376"><span class="highlight"><span class="nb">rewrite</span> compare_antisym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> CompOpp (m ?= n) <span class="kr">with</span>
| Lt =&gt; false
| _ =&gt; true
<span class="kr">end</span> = <span class="kr">match</span> m ?= n <span class="kr">with</span>
      | Gt =&gt; false
      | _ =&gt; true
      <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">case</span> <span class="nb">compare</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk377" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk377"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gtb_lt</span> <span class="nv">n</span> <span class="nv">m</span> : (n &gt;? m) = true &lt;-&gt; m &lt; n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;? m) = true &lt;-&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk378" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk378"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;? m) = true &lt;-&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk379" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk379"><span class="highlight"><span class="nb">rewrite</span> gtb_ltb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m &lt;? n) = true &lt;-&gt; m &lt; n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> ltb_lt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">geb_le</span> <span class="nv">n</span> <span class="nv">m</span> : (n &gt;=? m) = true &lt;-&gt; m &lt;= n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;=? m) = true &lt;-&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n &gt;=? m) = true &lt;-&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37c"><span class="highlight"><span class="nb">rewrite</span> geb_leb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(m &lt;=? n) = true &lt;-&gt; m &lt;= n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> leb_le.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gtb_spec</span> <span class="nv">n</span> <span class="nv">m</span> : BoolSpec (m&lt;n) (n&lt;=m) (n &gt;? m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">BoolSpec (m &lt; n) (n &lt;= m) (n &gt;? m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">BoolSpec (m &lt; n) (n &lt;= m) (n &gt;? m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk37f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk37f"><span class="highlight"><span class="nb">rewrite</span> gtb_ltb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">BoolSpec (m &lt; n) (n &lt;= m) (m &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> ltb_spec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk380" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk380"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">geb_spec</span> <span class="nv">n</span> <span class="nv">m</span> : BoolSpec (m&lt;=n) (n&lt;m) (n &gt;=? m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">BoolSpec (m &lt;= n) (n &lt; m) (n &gt;=? m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk381" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk381"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">BoolSpec (m &lt;= n) (n &lt; m) (n &gt;=? m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk382" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk382"><span class="highlight"><span class="nb">rewrite</span> geb_leb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">BoolSpec (m &lt;= n) (n &lt; m) (m &lt;=? n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> leb_spec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
TODO : to add in Numbers ? 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk383" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk383"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_reg_l</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : n + m = n + p -&gt; m = p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + m = n + p -&gt; m = p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk384" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk384"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + m = n + p -&gt; m = p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (proj1 (add_cancel_l m p n)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk385" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk385"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_reg_l</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : p &lt;&gt; <span class="mi">0</span> -&gt; p * n = p * m -&gt; n = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;&gt; <span class="mi">0</span> -&gt; p * n = p * m -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk386" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk386"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;&gt; <span class="mi">0</span> -&gt; p * n = p * m -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">Hp</span> =&gt; proj1 (mul_cancel_l n m p Hp)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk387" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk387"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mul_reg_r</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : p &lt;&gt; <span class="mi">0</span> -&gt; n * p = m * p -&gt; n = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;&gt; <span class="mi">0</span> -&gt; n * p = m * p -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk388" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk388"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;&gt; <span class="mi">0</span> -&gt; n * p = m * p -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">Hp</span> =&gt; proj1 (mul_cancel_r n m p Hp)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk389" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk389"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_eq_mul_m1</span> <span class="nv">n</span> : - n = n * -<span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- n = n * -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- n = n * -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38b"><span class="highlight"><span class="nb">rewrite</span> mul_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- n = -<span class="mi">1</span> * n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> n.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_diag</span> <span class="nv">n</span> : n + n = <span class="mi">2</span> * n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + n = <span class="mi">2</span> * n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + n = <span class="mi">2</span> * n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38e"><span class="highlight"><span class="nb">change</span> <span class="mi">2</span> <span class="kr">with</span> (<span class="mi">1</span>+<span class="mi">1</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + n = (<span class="mi">1</span> + <span class="mi">1</span>) * n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> mul_add_distr_r, !mul_1_l.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab38"></a><h1 class="section">Comparison and opposite</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk38f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk38f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_opp</span> <span class="nv">n</span> <span class="nv">m</span> : (- n ?= - m) = (m ?= n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(- n ?= - m) = (m ?= n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk390" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk390"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(- n ?= - m) = (m ?= n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> n, m; <span class="nb">simpl</span>; <span class="nb">trivial</span>; <span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Pos.compare_antisym.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab39"></a><h1 class="section">Comparison and addition</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk391" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk391"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_compare_mono_l</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : (n + m ?= n + p) = (m ?= p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m ?= n + p) = (m ?= p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk392" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk392"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m ?= n + p) = (m ?= p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk393" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk393"><span class="highlight"><span class="nb">rewrite</span> (compare_sub m p), compare_sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n + m - (n + p) ?= <span class="mi">0</span>) = (m - p ?= <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk394" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk394"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + m - (n + p) = m - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk395" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk395"><span class="highlight"><span class="nb">unfold</span> sub.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + m + - (n + p) = m + - p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk396" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk396"><span class="highlight"><span class="nb">rewrite</span> opp_add_distr, (add_comm n m), add_assoc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m + n + - n + - p = m + - p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk397" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk397"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m + n + - n = m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- add_assoc, add_opp_diag_r, add_0_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab40"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">testbit</span></span> in terms of comparison.</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk398" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk398"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_mod_pow2</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">i</span> (<span class="nv">H</span> : <span class="mi">0</span> &lt;= n)
  : testbit (a mod <span class="mi">2</span> ^ n) i = ((i &lt;? n) &amp;&amp; testbit a i)%bool.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (a mod <span class="mi">2</span> ^ n) i = (i &lt;? n) &amp;&amp; testbit a i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk399" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk399"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (a mod <span class="mi">2</span> ^ n) i = (i &lt;? n) &amp;&amp; testbit a i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (ltb_spec i n); <span class="nb">rewrite</span>
    ?mod_pow2_bits_low, ?mod_pow2_bits_high <span class="bp">by</span> <span class="nb">auto</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_ones</span> <span class="nv">n</span> <span class="nv">i</span> (<span class="nv">H</span> : <span class="mi">0</span> &lt;= n)
  : testbit (ones n) i = ((<span class="mi">0</span> &lt;=? i) &amp;&amp; (i &lt;? n))%bool.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ones n) i = (<span class="mi">0</span> &lt;=? i) &amp;&amp; (i &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ones n) i = (<span class="mi">0</span> &lt;=? i) &amp;&amp; (i &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> i), (ltb_spec i n); <span class="nb">cbn</span>;
    <span class="nb">rewrite</span> ?testbit_neg_r, ?ones_spec_low, ?ones_spec_high <span class="bp">by</span> <span class="nb">auto</span>; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_ones_nonneg</span> <span class="nv">n</span> <span class="nv">i</span> (<span class="nv">Hn</span> : <span class="mi">0</span> &lt;= n) (<span class="nv">Hi</span>: <span class="mi">0</span> &lt;= i)
  : testbit (ones n) i = (i &lt;? n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= i</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ones n) i = (i &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= i</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">testbit (ones n) i = (i &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39e"><span class="highlight"><span class="nb">rewrite</span> testbit_ones <span class="bp">by</span> <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= i</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt;=? i) &amp;&amp; (i &lt;? n) = (i &lt;? n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (leb_spec <span class="mi">0</span> i); <span class="nb">cbn</span>; <span class="kp">solve</span>
   [ <span class="nb">trivial</span> | <span class="nb">destruct</span> (proj1 (Z.le_ngt _ _) Hi <span class="kp">ltac</span>:(<span class="bp">eassumption</span>)) ].</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Z</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Bind Scope</span> Z_scope <span class="kr">with</span> Z.t Z.</span></span></span></pre><div class="doc">
Re-export Notations 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Numeral Notation</span> <span class="nf">Z</span> Z.of_int Z.to_int : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;+&quot;</span> := Z.add : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;- x&quot;</span> := (Z.opp x) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;-&quot;</span> := Z.sub : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;*&quot;</span> := Z.mul : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;^&quot;</span> := Z.pow : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;/&quot;</span> := Z.div : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;mod&quot;</span> := Z.modulo (<span class="kn">at level</span> <span class="mi">40</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;√∑&quot;</span> := Z.quot (<span class="kn">at level</span> <span class="mi">40</span>, <span class="kn">left associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;?=&quot;</span> := Z.<span class="nb">compare</span> (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;=?&quot;</span> := Z.eqb (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;=?&quot;</span> := Z.leb (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;?&quot;</span> := Z.ltb (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&gt;=?&quot;</span> := Z.geb (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&gt;?&quot;</span> := Z.gtb (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">no associativity</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;( x | y )&quot;</span> := (Z.divide x y) (<span class="kn">at level</span> <span class="mi">0</span>) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;=&quot;</span> := Z.le : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&lt;&quot;</span> := Z.lt : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&gt;=&quot;</span> := Z.ge : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Infix</span> <span class="s2">&quot;&gt;&quot;</span> := Z.gt : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt;= z&quot;</span> := (x &lt;= y /\ y &lt;= z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt;= y &lt; z&quot;</span> := (x &lt;= y /\ y &lt; z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt; z&quot;</span> := (x &lt; y /\ y &lt; z) : Z_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;x &lt; y &lt;= z&quot;</span> := (x &lt; y /\ y &lt;= z) : Z_scope.</span></span></span></pre><div class="doc">
Conversions from / to positive numbers 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Pos2Z</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk39f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk39f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">id</span> <span class="nv">p</span> : Z.to_pos (Z.pos p) = p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Zpos p) = p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Zpos p) = p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos p = Z.pos q -&gt; p = q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q -&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q -&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">injection</span> <span class="mi">1</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_iff</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos p = Z.pos q &lt;-&gt; p = q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q &lt;-&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q &lt;-&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a5"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q -&gt; p = q</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk3a6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk3a6"><hr></label><div class="goal-conclusion"><span class="highlight">p = q -&gt; Zpos p = Zpos q</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a7"><span class="highlight"><span class="nb">apply</span> inj.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p = q -&gt; Zpos p = Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">f_equal</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">is_pos</span> <span class="nv">p</span> : <span class="mi">0</span> &lt; Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3a9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3a9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3aa" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3aa"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">is_nonneg</span> <span class="nv">p</span> : <span class="mi">0</span> &lt;= Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ab" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ab"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ac" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ac"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_1</span> : Z.pos <span class="mi">1</span> = <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ad" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ad"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ae" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ae"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_xO</span> <span class="nv">p</span> : Z.pos p~<span class="mi">0</span> = <span class="mi">2</span> * Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">0</span> = <span class="mi">2</span> * Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3af" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3af"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">0</span> = <span class="mi">2</span> * Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_xI</span> <span class="nv">p</span> : Z.pos p~<span class="mi">1</span> = <span class="mi">2</span> * Z.pos p + <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">1</span> = <span class="mi">2</span> * Zpos p + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">1</span> = <span class="mi">2</span> * Zpos p + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_succ</span> <span class="nv">p</span> : Z.pos (Pos.succ p) = Z.succ (Z.pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.succ p) = Z.succ (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.succ p) = Z.succ (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b4"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.succ p) = Zpos (p + <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_1_r.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_add</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (p+q) = Z.pos p + Z.pos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p + q) = Zpos p + Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p + q) = Zpos p + Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_sub</span> <span class="nv">p</span> <span class="nv">q</span> : (p &lt; q)%positive -&gt;
 Z.pos (q-p) = Z.pos q - Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt; q)%positive -&gt; Zpos (q - p) = Zpos q - Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt; q)%positive -&gt; Zpos (q - p) = Zpos q - Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3b9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3b9"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (q - p) = Zpos q - Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ba" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ba"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (q - p) = Z.pos_sub q p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Z.pos_sub_gt.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3bb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3bb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_sub_max</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (p - q) = Z.max <span class="mi">1</span> (Z.pos p - Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Zpos p - Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3bc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3bc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Zpos p - Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3bd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3bd"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Z.pos_sub p q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3be" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3be"><span class="highlight"><span class="nb">rewrite</span> Z.pos_sub_spec.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) =
Z.max <span class="mi">1</span>
  <span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
  | Eq =&gt; <span class="mi">0</span>
  | Lt =&gt; Zneg (q - p)
  | Gt =&gt; Zpos (p - q)
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3bf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3bf"><span class="highlight"><span class="nb">case</span> Pos.compare_spec; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p = q</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk3c0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; q)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk3c0"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Zneg (q - p))</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk3c1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; p)%positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk3c1"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Zpos (p - q))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c2"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">p = q</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">subst</span>; <span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_diag.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c3"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(p &lt; q)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Zneg (q - p))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.sub_lt.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c4"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p - q) = Z.max <span class="mi">1</span> (Zpos (p - q))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> (p-q)%positive.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pred</span> <span class="nv">p</span> : p &lt;&gt; <span class="mi">1</span>%positive -&gt;
 Z.pos (Pos.pred p) = Z.pred (Z.pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;&gt; <span class="mi">1</span>%positive -&gt; Zpos (Pos.pred p) = Z.pred (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;&gt; <span class="mi">1</span>%positive -&gt; Zpos (Pos.pred p) = Z.pred (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> p; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_mul</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (p*q) = Z.pos p * Z.pos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p * q) = Zpos p * Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p * q) = Zpos p * Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3c9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3c9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pow_pos</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (p^q) = Z.pow_pos (Z.pos p) q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p ^ q) = Z.pow_pos (Zpos p) q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ca" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ca"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p ^ q) = Z.pow_pos (Zpos p) q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Pos.iter_swap_gen.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3cb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3cb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pow</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (p^q) = (Z.pos p)^(Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p ^ q) = Zpos p ^ Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3cc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3cc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (p ^ q) = Zpos p ^ Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> inj_pow_pos.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3cd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3cd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_square</span> <span class="nv">p</span> : Z.pos (Pos.square p) = Z.square (Z.pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.square p) = Z.square (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ce" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ce"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.square p) = Z.square (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3cf" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3cf"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_compare</span> <span class="nv">p</span> <span class="nv">q</span> : (p ?= q)%positive = (Z.pos p ?= Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p ?= q)%positive = (Zpos p ?= Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p ?= q)%positive = (Zpos p ?= Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_leb</span> <span class="nv">p</span> <span class="nv">q</span> : (p &lt;=? q)%positive = (Z.pos p &lt;=? Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt;=? q)%positive = (Zpos p &lt;=? Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt;=? q)%positive = (Zpos p &lt;=? Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_ltb</span> <span class="nv">p</span> <span class="nv">q</span> : (p &lt;? q)%positive = (Z.pos p &lt;? Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt;? q)%positive = (Zpos p &lt;? Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt;? q)%positive = (Zpos p &lt;? Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_eqb</span> <span class="nv">p</span> <span class="nv">q</span> : (p =? q)%positive = (Z.pos p =? Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p =? q)%positive = (Zpos p =? Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p =? q)%positive = (Zpos p =? Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_max</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (Pos.max p q) = Z.max (Z.pos p) (Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.max p q) = Z.max (Zpos p) (Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.max p q) = Z.max (Zpos p) (Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3d9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3d9"><span class="highlight"><span class="nb">unfold</span> Z.max, Pos.max.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos
  <span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
  | Gt =&gt; p
  | _ =&gt; q
  <span class="kr">end</span> =
<span class="kr">match</span> Zpos p ?= Zpos q <span class="kr">with</span>
| Lt =&gt; Zpos q
| _ =&gt; Zpos p
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3da" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3da"><span class="highlight"><span class="nb">rewrite</span> inj_compare.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos
  <span class="kr">match</span> Zpos p ?= Zpos q <span class="kr">with</span>
  | Gt =&gt; p
  | _ =&gt; q
  <span class="kr">end</span> =
<span class="kr">match</span> Zpos p ?= Zpos q <span class="kr">with</span>
| Lt =&gt; Zpos q
| _ =&gt; Zpos p
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">case</span> Z.compare_spec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3db" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3db"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_min</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (Pos.min p q) = Z.min (Z.pos p) (Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.min p q) = Z.min (Zpos p) (Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3dc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3dc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.min p q) = Z.min (Zpos p) (Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3dd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3dd"><span class="highlight"><span class="nb">unfold</span> Z.min, Pos.min.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos
  <span class="kr">match</span> (p ?= q)%positive <span class="kr">with</span>
  | Gt =&gt; q
  | _ =&gt; p
  <span class="kr">end</span> =
<span class="kr">match</span> Zpos p ?= Zpos q <span class="kr">with</span>
| Gt =&gt; Zpos q
| _ =&gt; Zpos p
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3de" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3de"><span class="highlight"><span class="nb">rewrite</span> inj_compare.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos
  <span class="kr">match</span> Zpos p ?= Zpos q <span class="kr">with</span>
  | Gt =&gt; q
  | _ =&gt; p
  <span class="kr">end</span> =
<span class="kr">match</span> Zpos p ?= Zpos q <span class="kr">with</span>
| Gt =&gt; Zpos q
| _ =&gt; Zpos p
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">case</span> Z.compare_spec.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3df" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3df"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_sqrt</span> <span class="nv">p</span> : Z.pos (Pos.sqrt p) = Z.sqrt (Z.pos p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.sqrt p) = Z.sqrt (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.sqrt p) = Z.sqrt (Zpos p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_gcd</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos (Pos.gcd p q) = Z.gcd (Z.pos p) (Z.pos q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.gcd p q) = Z.gcd (Zpos p) (Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Pos.gcd p q) = Z.gcd (Zpos p) (Zpos q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e3" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e3"><span class="highlight"><span class="kn">Definition</span> <span class="nf">inj_divide</span> <span class="nv">p</span> <span class="nv">q</span> : (Z.pos p|Z.pos q) &lt;-&gt; (p|q)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Zpos p | Zpos q) &lt;-&gt; (p | q)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Zpos p | Zpos q) &lt;-&gt; (p | q)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.divide_Zpos.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_testbit</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 Z.testbit (Z.pos a) n = N.testbit (N.pos a) (Z.to_N n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
Z.testbit (Zpos a) n = N.testbit (N.pos a) (Z.to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
Z.testbit (Zpos a) n = N.testbit (N.pos a) (Z.to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.testbit_Zpos.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Some results concerning Z.neg and Z.pos 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_neg</span> <span class="nv">p</span> <span class="nv">q</span> : Z.neg p = Z.neg q -&gt; p = q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p = Zneg q -&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p = Zneg q -&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">injection</span> <span class="mi">1</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3e9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3e9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_neg_iff</span> <span class="nv">p</span> <span class="nv">q</span> : Z.neg p = Z.neg q &lt;-&gt; p = q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p = Zneg q &lt;-&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ea" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ea"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p = Zneg q &lt;-&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3eb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3eb"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p = Zneg q -&gt; p = q</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk3ec" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk3ec"><hr></label><div class="goal-conclusion"><span class="highlight">p = q -&gt; Zneg p = Zneg q</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ed" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ed"><span class="highlight"><span class="nb">apply</span> inj_neg.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p = q -&gt; Zneg p = Zneg q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">f_equal</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ee" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ee"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pos</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos p = Z.pos q -&gt; p = q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q -&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ef" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ef"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q -&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">injection</span> <span class="mi">1</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f0" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pos_iff</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos p = Z.pos q &lt;-&gt; p = q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q &lt;-&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f1" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q &lt;-&gt; p = q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f2" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f2"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p = Zpos q -&gt; p = q</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk3f3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk3f3"><hr></label><div class="goal-conclusion"><span class="highlight">p = q -&gt; Zpos p = Zpos q</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f4" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f4"><span class="highlight"><span class="nb">apply</span> inj_pos.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p = q -&gt; Zpos p = Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">f_equal</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f5" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_is_neg</span> <span class="nv">p</span> : Z.neg p &lt; <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f6" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt; <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f7" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_is_nonpos</span> <span class="nv">p</span> : Z.neg p &lt;= <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f8" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3f9" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3f9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_is_pos</span> <span class="nv">p</span> : <span class="mi">0</span> &lt; Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3fa" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3fa"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3fb" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3fb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_is_nonneg</span> <span class="nv">p</span> : <span class="mi">0</span> &lt;= Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3fc" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3fc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3fd" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3fd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_le_pos</span> <span class="nv">p</span> <span class="nv">q</span> : Zneg p &lt;= Zpos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt;= Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3fe" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3fe"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt;= Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk3ff" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk3ff"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_lt_pos</span> <span class="nv">p</span> <span class="nv">q</span> : Zneg p &lt; Zpos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt; Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk400" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk400"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt; Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk401" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk401"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_le_neg</span> <span class="nv">p</span> <span class="nv">q</span> : (q &lt;= p)%positive -&gt; Zneg p &lt;= Zneg q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt;= p)%positive -&gt; Zneg p &lt;= Zneg q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk402" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk402"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt;= p)%positive -&gt; Zneg p &lt;= Zneg q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk403" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk403"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> Z.le; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt;= p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">CompOpp (p ?= q)%positive &lt;&gt; Gt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Pos.compare_antisym.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk404" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk404"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_lt_neg</span> <span class="nv">p</span> <span class="nv">q</span> : (q &lt; p)%positive -&gt; Zneg p &lt; Zneg q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt; p)%positive -&gt; Zneg p &lt; Zneg q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk405" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk405"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(q &lt; p)%positive -&gt; Zneg p &lt; Zneg q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk406" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk406"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> Z.lt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(q &lt; p)%positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">CompOpp (p ?= q)%positive = Lt</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- Pos.compare_antisym.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk407" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk407"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_le_pos</span> <span class="nv">p</span> <span class="nv">q</span> : (p &lt;= q)%positive -&gt; Zpos p &lt;= Zpos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt;= q)%positive -&gt; Zpos p &lt;= Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk408" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk408"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt;= q)%positive -&gt; Zpos p &lt;= Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk409" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk409"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_lt_pos</span> <span class="nv">p</span> <span class="nv">q</span> : (p &lt; q)%positive -&gt; Zpos p &lt; Zpos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt; q)%positive -&gt; Zpos p &lt; Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(p &lt; q)%positive -&gt; Zpos p &lt; Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">easy</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_xO</span> <span class="nv">p</span> : Z.neg p~<span class="mi">0</span> = <span class="mi">2</span> * Z.neg p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p~<span class="mi">0</span> = <span class="mi">2</span> * Zneg p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p~<span class="mi">0</span> = <span class="mi">2</span> * Zneg p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">neg_xI</span> <span class="nv">p</span> : Z.neg p~<span class="mi">1</span> = <span class="mi">2</span> * Z.neg p - <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p~<span class="mi">1</span> = <span class="mi">2</span> * Zneg p - <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p~<span class="mi">1</span> = <span class="mi">2</span> * Zneg p - <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk40f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk40f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_xO</span> <span class="nv">p</span> : Z.pos p~<span class="mi">0</span> = <span class="mi">2</span> * Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">0</span> = <span class="mi">2</span> * Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk410" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk410"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">0</span> = <span class="mi">2</span> * Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk411" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk411"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">pos_xI</span> <span class="nv">p</span> : Z.pos p~<span class="mi">1</span> = <span class="mi">2</span> * Z.pos p + <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">1</span> = <span class="mi">2</span> * Zpos p + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk412" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk412"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p~<span class="mi">1</span> = <span class="mi">2</span> * Zpos p + <span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk413" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk413"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_neg</span> <span class="nv">p</span> : - Z.neg p = Z.pos p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- Zneg p = Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk414" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk414"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- Zneg p = Zpos p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk415" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk415"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">opp_pos</span> <span class="nv">p</span> : - Z.pos p = Z.neg p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- Zpos p = Zneg p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk416" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk416"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">- Zpos p = Zneg p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk417" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk417"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_neg_neg</span> <span class="nv">p</span> <span class="nv">q</span> : Z.neg p + Z.neg q = Z.neg (p+q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p + Zneg q = Zneg (p + q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk418" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk418"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p + Zneg q = Zneg (p + q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk419" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk419"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_pos_neg</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos p + Z.neg q = Z.pos_sub p q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p + Zneg q = Z.pos_sub p q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p + Zneg q = Z.pos_sub p q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_neg_pos</span> <span class="nv">p</span> <span class="nv">q</span> : Z.neg p + Z.pos q = Z.pos_sub q p.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p + Zpos q = Z.pos_sub q p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p + Zpos q = Z.pos_sub q p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_pos_pos</span> <span class="nv">p</span> <span class="nv">q</span> : Z.pos p + Z.pos q = Z.pos (p+q).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p + Zpos q = Zpos (p + q)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p + Zpos q = Zpos (p + q)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk41f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk41f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">divide_pos_neg_r</span> <span class="nv">n</span> <span class="nv">p</span> : (n|Z.pos p) &lt;-&gt; (n|Z.neg p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n | Zpos p) &lt;-&gt; (n | Zneg p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk420" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk420"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(n | Zpos p) &lt;-&gt; (n | Zneg p)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.divide_Zpos_Zneg_r.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk421" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk421"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">divide_pos_neg_l</span> <span class="nv">n</span> <span class="nv">p</span> : (Z.pos p|n) &lt;-&gt; (Z.neg p|n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Zpos p | n) &lt;-&gt; (Zneg p | n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk422" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk422"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Zpos p | n) &lt;-&gt; (Zneg p | n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.divide_Zpos_Zneg_l.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk423" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk423"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_neg</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 Z.testbit (Z.neg a) n = negb (N.testbit (Pos.pred_N a) (Z.to_N n)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
Z.testbit (Zneg a) n =
negb (N.testbit (Pos.pred_N a) (Z.to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk424" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk424"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
Z.testbit (Zneg a) n =
negb (N.testbit (Pos.pred_N a) (Z.to_N n))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.testbit_Zneg.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk425" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk425"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">testbit_pos</span> <span class="nv">a</span> <span class="nv">n</span> : <span class="mi">0</span>&lt;=n -&gt;
 Z.testbit (Z.pos a) n = N.testbit (N.pos a) (Z.to_N n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
Z.testbit (Zpos a) n = N.testbit (N.pos a) (Z.to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk426" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk426"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= n -&gt;
Z.testbit (Zpos a) n = N.testbit (N.pos a) (Z.to_N n)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.testbit_Zpos.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Pos2Z</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Z2Pos</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk427" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk427"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">id</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x -&gt; Z.pos (Z.to_pos x) = x.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; Zpos (Z.to_pos x) = x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk428" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk428"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; Zpos (Z.to_pos x) = x</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> x.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk429" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk429"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; Z.to_pos x = Z.to_pos y -&gt; x = y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; Z.to_pos x = Z.to_pos y -&gt; x = y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; Z.to_pos x = Z.to_pos y -&gt; x = y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42b"><span class="highlight"><span class="nb">destruct</span> x; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p -&gt; <span class="mi">0</span> &lt; y -&gt; p = Z.to_pos y -&gt; Zpos p = y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42c"><span class="highlight"><span class="nb">intros</span> _ H -&gt;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Z.to_pos y) = y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> id.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_iff</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; (Z.to_pos x = Z.to_pos y &lt;-&gt; x = y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; Z.to_pos x = Z.to_pos y &lt;-&gt; x = y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt; Z.to_pos x = Z.to_pos y &lt;-&gt; x = y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk42f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk42f"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos x = Z.to_pos y -&gt; x = y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk430" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk430"><hr></label><div class="goal-conclusion"><span class="highlight">x = y -&gt; Z.to_pos x = Z.to_pos y</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk431" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk431"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> inj.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">x = y -&gt; Z.to_pos x = Z.to_pos y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">f_equal</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk432" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk432"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">to_pos_nonpos</span> <span class="nv">x</span> : x &lt;= <span class="mi">0</span> -&gt; Z.to_pos x = <span class="mi">1</span>%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">x &lt;= <span class="mi">0</span> -&gt; Z.to_pos x = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk433" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk433"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">x &lt;= <span class="mi">0</span> -&gt; Z.to_pos x = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk434" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk434"><span class="highlight"><span class="nb">destruct</span> x; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos p &lt;= <span class="mi">0</span> -&gt; Z.to_pos (Zpos p) = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk435" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk435"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_1</span> : Z.to_pos <span class="mi">1</span> = <span class="mi">1</span>%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos <span class="mi">1</span> = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk436" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk436"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos <span class="mi">1</span> = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk437" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk437"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_double</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x -&gt;
 Z.to_pos (Z.double x) = (Z.to_pos x)~<span class="mi">0</span>%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
Z.to_pos (Z.double x) = ((Z.to_pos x)~<span class="mi">0</span>)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk438" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk438"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
Z.to_pos (Z.double x) = ((Z.to_pos x)~<span class="mi">0</span>)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> x.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk439" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk439"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_succ_double</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x -&gt;
 Z.to_pos (Z.succ_double x) = (Z.to_pos x)~<span class="mi">1</span>%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
Z.to_pos (Z.succ_double x) = ((Z.to_pos x)~<span class="mi">1</span>)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
Z.to_pos (Z.succ_double x) = ((Z.to_pos x)~<span class="mi">1</span>)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> x.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_succ</span> <span class="nv">x</span> : <span class="mi">0</span> &lt; x -&gt; Z.to_pos (Z.succ x) = Pos.succ (Z.to_pos x).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; Z.to_pos (Z.succ x) = Pos.succ (Z.to_pos x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt; Z.to_pos (Z.succ x) = Pos.succ (Z.to_pos x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43d"><span class="highlight"><span class="nb">destruct</span> x; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p -&gt;
Z.to_pos (Z.succ (Zpos p)) =
Pos.succ (Z.to_pos (Zpos p))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43e"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p -&gt; (p + <span class="mi">1</span>)%positive = Pos.succ p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Pos.add_1_r.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk43f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk43f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_add</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 Z.to_pos (x+y) = (Z.to_pos x + Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (x + y) = (Z.to_pos x + Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk440" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk440"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (x + y) = (Z.to_pos x + Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk441" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk441"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_sub</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x &lt; y -&gt;
 Z.to_pos (y-x) = (Z.to_pos y - Z.to_pos x)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x &lt; y -&gt;
Z.to_pos (y - x) = (Z.to_pos y - Z.to_pos x)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk442" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk442"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x &lt; y -&gt;
Z.to_pos (y - x) = (Z.to_pos y - Z.to_pos x)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk443" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk443"><span class="highlight"><span class="nb">destruct</span> x; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p &lt; y -&gt;
Z.to_pos (y - Zpos p) =
(Z.to_pos y - Z.to_pos (Zpos p))%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk444" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk444"><span class="highlight"><span class="nb">destruct</span> y; <span class="kp">try</span> <span class="bp">easy</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p &lt; Zpos p0 -&gt;
Z.to_pos (Zpos p0 - Zpos p) =
(Z.to_pos (Zpos p0) - Z.to_pos (Zpos p))%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk445" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk445"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Zpos p &lt; Zpos p0 -&gt;
Z.to_pos (Z.pos_sub p0 p) = (p0 - p)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk446" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk446"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Zpos p &lt; Zpos p0</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.pos_sub p0 p) = (p0 - p)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Z.pos_sub_gt.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk447" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk447"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pred</span> <span class="nv">x</span> : <span class="mi">1</span> &lt; x -&gt; Z.to_pos (Z.pred x) = Pos.pred (Z.to_pos x).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt; x -&gt; Z.to_pos (Z.pred x) = Pos.pred (Z.to_pos x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk448" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk448"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt; x -&gt; Z.to_pos (Z.pred x) = Pos.pred (Z.to_pos x)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> x <span class="kr">as</span> [|[x|x|]|].</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk449" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk449"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_mul</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 Z.to_pos (x*y) = (Z.to_pos x * Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (x * y) = (Z.to_pos x * Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (x * y) = (Z.to_pos x * Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pow</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 Z.to_pos (x^y) = (Z.to_pos x ^ Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (x ^ y) = (Z.to_pos x ^ Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (x ^ y) = (Z.to_pos x ^ Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44d"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (x ^ y) = (Z.to_pos x ^ Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44e"><span class="highlight"><span class="nb">apply</span> Pos2Z.inj.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zpos (Z.to_pos (x ^ y)) =
Zpos (Z.to_pos x ^ Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk44f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk44f"><span class="highlight"><span class="nb">rewrite</span> Pos2Z.inj_pow, !id; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x ^ y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk450" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk450"><span class="highlight"><span class="nb">apply</span> Z.pow_pos_nonneg.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk451" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk451"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= y</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk452" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk452"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; y</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.lt_le_incl.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk453" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk453"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_pow_pos</span> <span class="nv">x</span> <span class="nv">p</span> : <span class="mi">0</span> &lt; x -&gt;
 Z.to_pos (Z.pow_pos x p) = ((Z.to_pos x)^p)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
Z.to_pos (Z.pow_pos x p) = (Z.to_pos x ^ p)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk454" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk454"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
Z.to_pos (Z.pow_pos x p) = (Z.to_pos x ^ p)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk455" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk455"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; x</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.pow_pos x p) = (Z.to_pos x ^ p)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> (inj_pow x (Z.pos p)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk456" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk456"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_compare</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 (x ?= y) = (Z.to_pos x ?= Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x ?= y) = (Z.to_pos x ?= Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk457" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk457"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x ?= y) = (Z.to_pos x ?= Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk458" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk458"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_leb</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 (x &lt;=? y) = (Z.to_pos x &lt;=? Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x &lt;=? y) = (Z.to_pos x &lt;=? Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk459" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk459"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x &lt;=? y) = (Z.to_pos x &lt;=? Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_ltb</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 (x &lt;? y) = (Z.to_pos x &lt;? Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x &lt;? y) = (Z.to_pos x &lt;? Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x &lt;? y) = (Z.to_pos x &lt;? Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_eqb</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 (x =? y) = (Z.to_pos x =? Z.to_pos y)%positive.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x =? y) = (Z.to_pos x =? Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
(x =? y) = (Z.to_pos x =? Z.to_pos y)%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_max</span> <span class="nv">x</span> <span class="nv">y</span> :
 Z.to_pos (Z.max x y) = Pos.max (Z.to_pos x) (Z.to_pos y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max x y) =
Pos.max (Z.to_pos x) (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk45f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk45f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max x y) =
Pos.max (Z.to_pos x) (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk460" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk460"><span class="highlight"><span class="nb">destruct</span> x; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="nb">rewrite</span> Pos.max_1_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max <span class="mi">0</span> y) = Z.to_pos y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk461" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk461"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max (Zpos p) y) = Pos.max p (Z.to_pos y)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk462" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk462"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max (Zneg p) y) = Z.to_pos y</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk463" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk463"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max <span class="mi">0</span> y) = Z.to_pos y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk464" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk464"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max (Zpos p) y) = Pos.max p (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> y; <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">rewrite</span> ?Pos.max_1_r, &lt;- ?Pos2Z.inj_max.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk465" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk465"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max (Zneg p) y) = Z.to_pos y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk466" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk466"><span class="highlight"><span class="nb">destruct</span> y; <span class="nb">simpl</span>; <span class="nb">rewrite</span> ?Pos.max_1_r; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.max (Zneg p) (Zneg p0)) = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk467" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk467"><span class="highlight"><span class="nb">apply</span> to_pos_nonpos.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.max (Zneg p) (Zneg p0) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.max_lub.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk468" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk468"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_min</span> <span class="nv">x</span> <span class="nv">y</span> :
 Z.to_pos (Z.min x y) = Pos.min (Z.to_pos x) (Z.to_pos y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min x y) =
Pos.min (Z.to_pos x) (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk469" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk469"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min x y) =
Pos.min (Z.to_pos x) (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk46a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk46a"><span class="highlight"><span class="nb">destruct</span> x; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="nb">rewrite</span> Pos.min_1_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min <span class="mi">0</span> y) = <span class="mi">1</span>%positive</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="BinInt-v-chk46b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk46b"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min (Zpos p) y) = Pos.min p (Z.to_pos y)</span></div></blockquote><input class="coq-extra-goal-toggle" id="BinInt-v-chk46c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="BinInt-v-chk46c"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min (Zneg p) y) = <span class="mi">1</span>%positive</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk46d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk46d"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min <span class="mi">0</span> y) = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk46e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk46e"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min (Zpos p) y) = Pos.min p (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> y; <span class="nb">simpl</span>; <span class="bp">now</span> <span class="nb">rewrite</span> ?Pos.min_1_r, &lt;- ?Pos2Z.inj_min.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk46f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk46f"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min (Zneg p) y) = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk470" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk470"><span class="highlight"><span class="nb">destruct</span> y; <span class="nb">simpl</span>; <span class="nb">rewrite</span> ?Pos.min_1_r; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.min (Zneg p) (Zneg p0)) = <span class="mi">1</span>%positive</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk471" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk471"><span class="highlight"><span class="nb">apply</span> to_pos_nonpos.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.min (Zneg p) (Zneg p0) &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk472" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk472"><span class="highlight"><span class="nb">apply</span> Z.min_le_iff.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p, p0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zneg p &lt;= <span class="mi">0</span> \/ Zneg p0 &lt;= <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">left</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk473" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk473"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_sqrt</span> <span class="nv">x</span> : Z.to_pos (Z.sqrt x) = Pos.sqrt (Z.to_pos x).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.sqrt x) = Pos.sqrt (Z.to_pos x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk474" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk474"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.to_pos (Z.sqrt x) = Pos.sqrt (Z.to_pos x)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> x.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk475" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk475"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inj_gcd</span> <span class="nv">x</span> <span class="nv">y</span> : <span class="mi">0</span> &lt; x -&gt; <span class="mi">0</span> &lt; y -&gt;
 Z.to_pos (Z.gcd x y) = Pos.gcd (Z.to_pos x) (Z.to_pos y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (Z.gcd x y) =
Pos.gcd (Z.to_pos x) (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk476" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk476"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; x -&gt;
<span class="mi">0</span> &lt; y -&gt;
Z.to_pos (Z.gcd x y) =
Pos.gcd (Z.to_pos x) (Z.to_pos y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> x; <span class="bp">easy</span> || <span class="bp">now</span> <span class="nb">destruct</span> y.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Z2Pos</span>.</span></span></span></pre><div class="doc">
Compatibility Notations 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zdouble_plus_one</span> := Z.succ_double (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zdouble_minus_one</span> := Z.pred_double (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">ZPminus</span> := Z.pos_sub (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus</span> := Z.add (<span class="kn">only parsing</span>). <span class="c">(* Slightly incompatible *)</span></span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zminus</span> := Z.sub (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult</span> := Z.mul (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z_of_nat</span> := Z.of_nat (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z_of_N</span> := Z.of_N (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zind</span> := Z.peano_ind (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_0_l</span> := Z.add_0_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_0_r</span> := Z.add_0_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_comm</span> := Z.add_comm (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zopp_plus_distr</span> := Z.opp_add_distr (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_opp_r</span> := Z.add_opp_diag_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_opp_l</span> := Z.add_opp_diag_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_assoc</span> := Z.add_assoc (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_permute</span> := Z.add_shuffle3 (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_reg_l</span> := Z.add_reg_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_succ_l</span> := Z.add_succ_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_succ_comm</span> := Z.add_succ_comm (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zsucc_discr</span> := Z.neq_succ_diag_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zsucc&#39;_discr</span> := Z.neq_succ_diag_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zminus_0_r</span> := Z.sub_0_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zminus_diag</span> := Z.sub_diag (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zminus_plus_distr</span> := Z.sub_add_distr (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zminus_succ_r</span> := Z.sub_succ_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zminus_plus</span> := Z.add_simpl_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_0_l</span> := Z.mul_0_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_0_r</span> := Z.mul_0_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_1_l</span> := Z.mul_1_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_1_r</span> := Z.mul_1_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_comm</span> := Z.mul_comm (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_assoc</span> := Z.mul_assoc (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_permute</span> := Z.mul_shuffle3 (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_1_inversion_l</span> := Z.mul_eq_1 (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zdouble_mult</span> := Z.double_spec (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zdouble_plus_one_mult</span> := Z.succ_double_spec (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zopp_mult_distr_l_reverse</span> := Z.mul_opp_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_opp_opp</span> := Z.mul_opp_opp (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_opp_comm</span> := Z.mul_opp_comm (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zopp_eq_mult_neg_1</span> := Z.opp_eq_mul_m1 (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_plus_distr_r</span> := Z.mul_add_distr_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_plus_distr_l</span> := Z.mul_add_distr_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_minus_distr_r</span> := Z.mul_sub_distr_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_reg_l</span> := Z.mul_reg_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_reg_r</span> := Z.mul_reg_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_succ_l</span> := Z.mul_succ_l (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zmult_succ_r</span> := Z.mul_succ_r (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_xI</span> := Pos2Z.inj_xI (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_xO</span> := Pos2Z.inj_xO (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zneg_xI</span> := Pos2Z.neg_xI (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zneg_xO</span> := Pos2Z.neg_xO (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zopp_neg</span> := Pos2Z.opp_neg (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_succ_morphism</span> := Pos2Z.inj_succ (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_mult_morphism</span> := Pos2Z.inj_mul (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_minus_morphism</span> := Pos2Z.inj_sub (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_eq_rev</span> := Pos2Z.inj (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos_plus_distr</span> := Pos2Z.inj_add (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zneg_plus_distr</span> := Pos2Z.add_neg_neg (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z</span> := Z (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z_rect</span> := Z_rect (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z_rec</span> := Z_rec (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z_ind</span> := Z_ind (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Z0</span> := Z0 (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zpos</span> := Zpos (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zneg</span> := Zneg (<span class="kn">only parsing</span>).</span></span></span></pre><div class="doc">
Compatibility lemmas. These could be notations,
    but scope information would be lost.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">SYM1</span> lem := (<span class="kr">fun</span> <span class="nv">n</span> =&gt; eq_sym (lem n)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">SYM2</span> lem := (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> =&gt; eq_sym (lem n m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">SYM3</span> lem := (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> =&gt; eq_sym (lem n m p)).</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk477" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk477"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_assoc_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, n+m+p = n+(m+p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, n + m + p = n + (m + p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM3 Z.add_assoc).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk478" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk478"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_succ_r_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, Z.succ (n+m) = n+Z.succ m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, Z.succ (n + m) = n + Z.succ m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM2 Z.add_succ_r).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">Zplus_succ_r</span> := Zplus_succ_r_reverse (<span class="kn">only parsing</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk479" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk479"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_0_r_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span>, n = n + <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : BinNums.Z, n = n + <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM1 Z.add_0_r).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk47a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk47a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_eq_compat</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> <span class="nv">q</span>, n=m -&gt; p=q -&gt; n+p=m+q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> <span class="nv">q</span> : BinNums.Z,
n = m -&gt; p = q -&gt; n + p = m + q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (f_equal2 Z.add).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk47b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk47b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zsucc_pred</span> : <span class="kr">forall</span> <span class="nv">n</span>, n = Z.succ (Z.pred n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : BinNums.Z, n = Z.succ (Z.pred n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM1 Z.succ_pred).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk47c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk47c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zpred_succ</span> : <span class="kr">forall</span> <span class="nv">n</span>, n = Z.pred (Z.succ n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : BinNums.Z, n = Z.pred (Z.succ n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM1 Z.pred_succ).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk47d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk47d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zsucc_eq_compat</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n = m -&gt; Z.succ n = Z.succ m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n = m -&gt; Z.succ n = Z.succ m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="nb">f_equal</span> Z.succ).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk47e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk47e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_0_l_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span>, n = n - <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : BinNums.Z, n = n - <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM1 Z.sub_0_r).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk47f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk47f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_diag_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span>, <span class="mi">0</span> = n-n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : BinNums.Z, <span class="mi">0</span> = n - n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM1 Z.sub_diag).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk480" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk480"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_succ_l</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, Z.succ (n - m) = Z.succ n - m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, Z.succ (n - m) = Z.succ n - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM2 Z.sub_succ_l).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk481" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk481"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_minus_eq</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, n = m + p -&gt; p = n - m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, n = m + p -&gt; p = n - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk482" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk482"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, n = m + p -&gt; p = n - m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk483" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk483"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m, p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">BinNums.Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n = m + p</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">p = n - m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Z.add_move_l.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk484" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk484"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_minus</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n + (m - n) = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n + (m - n) = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> =&gt; eq_trans (Z.add_comm n (m-n)) (Z.sub_add n m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk485" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk485"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_plus_simpl_l</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, p + n - (p + m) = n - m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, p + n - (p + m) = n - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> =&gt; Z.add_add_simpl_l_l p n m).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk486" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk486"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_plus_simpl_l_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, n - m = p + n - (p + m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, n - m = p + n - (p + m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM3 Zminus_plus_simpl_l).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk487" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk487"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_plus_simpl_r</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, n + p - (m + p) = n - m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, n + p - (m + p) = n - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> =&gt; Z.add_add_simpl_r_r n p m).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk488" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk488"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zeq_minus</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n = m -&gt; n - m = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n = m -&gt; n - m = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> =&gt; proj2 (Z.sub_move_0_r n m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk489" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk489"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zminus_eq</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n - m = <span class="mi">0</span> -&gt; n = m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n - m = <span class="mi">0</span> -&gt; n = m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> =&gt; proj1 (Z.sub_move_0_r n m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk48a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk48a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_0_r_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span>, <span class="mi">0</span> = n * <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : BinNums.Z, <span class="mi">0</span> = n * <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM1 Z.mul_0_r).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk48b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk48b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_assoc_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, n * m * p = n * (m * p).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, n * m * p = n * (m * p)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM3 Z.mul_assoc).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk48c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk48c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_integral</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n * m = <span class="mi">0</span> -&gt; n = <span class="mi">0</span> \/ m = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n * m = <span class="mi">0</span> -&gt; n = <span class="mi">0</span> \/ m = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> =&gt; proj1 (Z.mul_eq_0 n m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk48d" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk48d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_integral_l</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n &lt;&gt; <span class="mi">0</span> -&gt; m * n = <span class="mi">0</span> -&gt; m = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n &lt;&gt; <span class="mi">0</span> -&gt; m * n = <span class="mi">0</span> -&gt; m = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">H</span> <span class="nv">H&#39;</span> =&gt; Z.mul_eq_0_l m n H&#39; H).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk48e" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk48e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zopp_mult_distr_l</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, - (n * m) = - n * m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, - (n * m) = - n * m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM2 Z.mul_opp_l).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk48f" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk48f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zopp_mult_distr_r</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, - (n * m) = n * - m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, - (n * m) = n * - m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM2 Z.mul_opp_r).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk490" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk490"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_minus_distr_l</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span>, p * (n - m) = p * n - p * m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> : BinNums.Z, p * (n - m) = p * n - p * m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">p</span> =&gt; Z.mul_sub_distr_l p n m).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk491" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk491"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_succ_r_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n * m + n = n * Z.succ m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n * m + n = n * Z.succ m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM2 Z.mul_succ_r).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk492" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk492"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmult_succ_l_reverse</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, n * m + m = Z.succ n * m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : BinNums.Z, n * m + m = Z.succ n * m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (SYM2 Z.mul_succ_l).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk493" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk493"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zpos_eq</span> : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, p = q -&gt; Z.pos p = Z.pos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive,
p = q -&gt; BinNums.Zpos p = BinNums.Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk494" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk494"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive,
p = q -&gt; BinNums.Zpos p = BinNums.Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">congruence</span>.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk495" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk495"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zpos_eq_iff</span> : <span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span>, p = q &lt;-&gt; Z.pos p = Z.pos q.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">p</span> <span class="nv">q</span> : positive,
p = q &lt;-&gt; BinNums.Zpos p = BinNums.Zpos q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Proof</span> (<span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> =&gt; iff_sym (Pos2Z.inj_iff p q)).</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Immediate</span> Zsucc_pred: zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
<span class="c">(* Not kept :</span>
<span class="c">Zplus_0_simpl_l</span>
<span class="c">Zplus_0_simpl_l_reverse</span>
<span class="c">Zplus_opp_expand</span>
<span class="c">Zsucc_inj_contrapositive</span>
<span class="c">Zsucc_succ&#39;</span>
<span class="c">Zpred_pred&#39;</span>
<span class="c">*)</span>

<span class="c">(* No compat notation for :</span>
<span class="c">weak_assoc (now Z.add_assoc_pos)</span>
<span class="c">weak_Zmult_plus_distr_r (now Z.mul_add_distr_pos)</span>
<span class="c">*)</span></span></span></pre><div class="doc">
Obsolete stuff 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Zne</span> (<span class="nv">x</span> <span class="nv">y</span>:Z) := x &lt;&gt; y. <span class="c">(* TODO : to remove someday ? *)</span></span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Register</span> Zne <span class="kr">as</span> plugins.<span class="bp">omega</span>.Zne.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">elim_compare</span> com1 com2 :=
  <span class="nb">case</span> (Dcompare (com1 ?= com2)%Z);
    [ <span class="kp">idtac</span> | <span class="kr">let</span> <span class="nv">x</span> := <span class="kp">fresh</span> <span class="s2">&quot;H&quot;</span> <span class="kr">in</span>
      (<span class="nb">intro</span> x; <span class="nb">case</span> x; <span class="nb">clear</span> x) ].</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk496" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk496"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ZL0</span> : <span class="mi">2</span>%nat = (<span class="mi">1</span> + <span class="mi">1</span>)%nat.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span>%nat = (<span class="mi">1</span> + <span class="mi">1</span>)%nat</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk497" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk497"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">2</span>%nat = (<span class="mi">1</span> + <span class="mi">1</span>)%nat</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk498" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk498"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zplus_diag_eq_mult_2</span> <span class="nv">n</span> : n + n = n * <span class="mi">2</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">BinNums.Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + n = n * <span class="mi">2</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk499" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk499"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">BinNums.Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + n = n * <span class="mi">2</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk49a" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk49a"><span class="highlight"><span class="nb">rewrite</span> Z.mul_comm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">BinNums.Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">n + n = <span class="mi">2</span> * n</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.add_diag.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk49b" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk49b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_eq_mult</span> <span class="nv">n</span> <span class="nv">m</span> : m = <span class="mi">0</span> -&gt; m * n = <span class="mi">0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">BinNums.Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m = <span class="mi">0</span> -&gt; m * n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="BinInt-v-chk49c" style="display: none" type="checkbox"><label class="coq-input" for="BinInt-v-chk49c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">BinNums.Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">m = <span class="mi">0</span> -&gt; m * n = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="bp">now</span> <span class="nb">subst</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></article></body></html>