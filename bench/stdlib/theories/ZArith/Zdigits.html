<!DOCTYPE html>
<html><head><title>Zdigits.v</title><meta charset="utf-8"><meta content="Alectryon v0.2" name="generator"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"><link href="https://unpkg.com/firacode/distr/fira_code.css" rel="stylesheet"><link href="alectryon.css" rel="stylesheet"><script src="alectryon.js"></script><style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-standalone alectryon-centered alectryon-coqdoc"><div class="alectryon-header">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running <a href="https://coq.inria.fr/">Coq</a>+<a href="https://github.com/ejgallego/coq-serapi">SerAPI</a> v8.10.0+0.7.0. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight"><span class="c">(* -*- coding: utf-8 -*- *)</span>
<span class="sd">(************************************************************************)</span>
<span class="c">(*         *   The Coq Proof Assistant / The Coq Development Team       *)</span>
<span class="c">(*  v      *   INRIA, CNRS and contributors - Copyright 1999-2018       *)</span>
<span class="c">(* &lt;O___,, *       (see CREDITS file for the list of authors)           *)</span>
<span class="c">(*   \VV/  **************************************************************)</span>
<span class="c">(*    //   *    This file is distributed under the terms of the         *)</span>
<span class="c">(*         *     GNU Lesser General Public License Version 2.1          *)</span>
<span class="c">(*         *     (see LICENSE file for the text of the license)         *)</span>
<span class="sd">(************************************************************************)</span></span></span></pre><div class="doc">
Bit vectors interpreted as integers.
    Contribution by Jean Duprat (ENS Lyon). 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> Bvector.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> ZArith.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Export</span> Zpower.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> Omega.</span></span></span></pre><div class="doc">
The evaluation of boolean vector is done both in binary and
    two's complement. The computed number belongs to Z.
    We hence use Omega to perform computations in Z.
    Moreover, we use functions <span class="inlinecode">2^<span class="id" title="var">n</span></span> where <span class="inlinecode"><span class="id" title="var">n</span></span> is a natural number
    (here the vector length).

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">VALUE_OF_BOOLEAN_VECTORS</span>.</span></span></span></pre><div class="doc">
Computations are done in the usual convention.
    The values correspond either to the binary coding (nat) or
    to the two's complement coding (int).
    We perform the computation via Horner scheme.
    The two's complement coding only makes sense on vectors whose
    size is greater or equal to one (a sign bit should be present).

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">bit_value</span> (<span class="nv">b</span>:bool) : Z :=
    <span class="kr">match</span> b <span class="kr">with</span>
      | true =&gt; <span class="mi">1</span>%Z
      | false =&gt; <span class="mi">0</span>%Z
    <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk0" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">binary_value</span> : <span class="kr">forall</span> <span class="nv">n</span>:nat, Bvector n -&gt; Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Bvector n -&gt; Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk1" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Bvector n -&gt; Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk2" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk2"><span class="highlight"><span class="nb">refine</span> (nat_rect _ _ _); <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector n -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk3"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk4" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk4"><span class="highlight"><span class="bp">exact</span> <span class="mi">0</span>%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector n -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n)</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk5" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk5"><span class="highlight"><span class="nb">inversion</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector n -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Vector.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n0 = n</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (bit_value h + <span class="mi">2</span> * H H2)%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk6" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">two_compl_value</span> : <span class="kr">forall</span> <span class="nv">n</span>:nat, Bvector (S n) -&gt; Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Bvector (S n) -&gt; Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk7" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Bvector (S n) -&gt; Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk8" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk8"><span class="highlight"><span class="nb">simple induction</span> n; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector <span class="mi">1</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n0) -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S (S n0))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk9"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka"><span class="highlight"><span class="nb">inversion</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector <span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Vector.t bool <span class="mi">0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n0 = <span class="mi">0</span></span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chkb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n0) -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S (S n0))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chkb"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chkc" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chkc"><span class="highlight"><span class="bp">exact</span> (- bit_value h)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n0) -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S (S n0))</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chkd" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chkd"><span class="highlight"><span class="nb">inversion</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S n0) -&gt; Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Bvector (S (S n0))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Vector.t bool (S n0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n1 = S n0</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (bit_value h + <span class="mi">2</span> * H H2)%Z.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">VALUE_OF_BOOLEAN_VECTORS</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">ENCODING_VALUE</span>.</span></span></span></pre><div class="doc">
We compute the binary value via a Horner scheme.
    Computation stops at the vector length without checks.
    We define a function Zmod2 similar to Z.div2 returning the
    quotient of division z=2q+r with 0&lt;=r&lt;=1.
    The two's complement value is also computed via a Horner scheme
    with Zmod2, the parameter is the size minus one.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Zmod2</span> (<span class="nv">z</span>:Z) :=
    <span class="kr">match</span> z <span class="kr">with</span>
      | Z0 =&gt; <span class="mi">0</span>%Z
      | Zpos p =&gt; <span class="kr">match</span> p <span class="kr">with</span>
		    | xI q =&gt; Zpos q
		    | xO q =&gt; Zpos q
		    | xH =&gt; <span class="mi">0</span>%Z
		  <span class="kr">end</span>
      | Zneg p =&gt;
	<span class="kr">match</span> p <span class="kr">with</span>
	  | xI q =&gt; (Zneg q - <span class="mi">1</span>)%Z
	  | xO q =&gt; Zneg q
	  | xH =&gt; (-<span class="mi">1</span>)%Z
	<span class="kr">end</span>
    <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">

</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chke" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chke"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zmod2_twice</span> :
    <span class="kr">forall</span> <span class="nv">z</span>:Z, z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chkf" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chkf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk10" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk10"><span class="highlight"><span class="nb">destruct</span> z; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span>%Z = <span class="mi">0</span>%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk11" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk11"><hr></label><div class="goal-conclusion"><span class="highlight">Z.pos p =
(<span class="kr">match</span>
   <span class="kr">match</span> p <span class="kr">with</span>
   | (q~<span class="mi">1</span>)%positive | (q~<span class="mi">0</span>)%positive =&gt; Z.pos q
   | <span class="mi">1</span>%positive =&gt; <span class="mi">0</span>
   <span class="kr">end</span>
 <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> +
 bit_value
   <span class="kr">match</span> p <span class="kr">with</span>
   | (_~<span class="mi">0</span>)%positive =&gt; false
   | _ =&gt; true
   <span class="kr">end</span>)%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk12" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk12"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p =
(<span class="kr">match</span>
   <span class="kr">match</span> p <span class="kr">with</span>
   | (q~<span class="mi">1</span>)%positive =&gt; Z.neg (q + <span class="mi">1</span>)
   | (q~<span class="mi">0</span>)%positive =&gt; Z.neg q
   | <span class="mi">1</span>%positive =&gt; -<span class="mi">1</span>
   <span class="kr">end</span>
 <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> +
 bit_value
   <span class="kr">match</span> p <span class="kr">with</span>
   | (_~<span class="mi">0</span>)%positive =&gt; false
   | _ =&gt; true
   <span class="kr">end</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk13" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk13"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.pos p =
(<span class="kr">match</span>
   <span class="kr">match</span> p <span class="kr">with</span>
   | (q~<span class="mi">1</span>)%positive | (q~<span class="mi">0</span>)%positive =&gt; Z.pos q
   | <span class="mi">1</span>%positive =&gt; <span class="mi">0</span>
   <span class="kr">end</span>
 <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> +
 bit_value
   <span class="kr">match</span> p <span class="kr">with</span>
   | (_~<span class="mi">0</span>)%positive =&gt; false
   | _ =&gt; true
   <span class="kr">end</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk14" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk14"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p =
(<span class="kr">match</span>
   <span class="kr">match</span> p <span class="kr">with</span>
   | (q~<span class="mi">1</span>)%positive =&gt; Z.neg (q + <span class="mi">1</span>)
   | (q~<span class="mi">0</span>)%positive =&gt; Z.neg q
   | <span class="mi">1</span>%positive =&gt; -<span class="mi">1</span>
   <span class="kr">end</span>
 <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> +
 bit_value
   <span class="kr">match</span> p <span class="kr">with</span>
   | (_~<span class="mi">0</span>)%positive =&gt; false
   | _ =&gt; true
   <span class="kr">end</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk15" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk15"><span class="highlight"><span class="nb">destruct</span> p; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p =
(<span class="kr">match</span>
   <span class="kr">match</span> p <span class="kr">with</span>
   | (q~<span class="mi">1</span>)%positive =&gt; Z.neg (q + <span class="mi">1</span>)
   | (q~<span class="mi">0</span>)%positive =&gt; Z.neg q
   | <span class="mi">1</span>%positive =&gt; -<span class="mi">1</span>
   <span class="kr">end</span>
 <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> +
 bit_value
   <span class="kr">match</span> p <span class="kr">with</span>
   | (_~<span class="mi">0</span>)%positive =&gt; false
   | _ =&gt; true
   <span class="kr">end</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk16" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk16"><span class="highlight"><span class="nb">destruct</span> p; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">1</span> = Z.neg (Pos.pred_double (p + <span class="mi">1</span>))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk17" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk17"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span> = Z.neg p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk18" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk18"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>)%Z = (-<span class="mi">1</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk19" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk19"><span class="highlight"><span class="nb">destruct</span> p <span class="kr">as</span> [p| p| ]; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">1</span>~<span class="mi">1</span> = Z.neg (Pos.pred_double (Pos.succ p))~<span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk1a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk1a"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span>~<span class="mi">1</span> = Z.neg p~<span class="mi">0</span>~<span class="mi">1</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk1b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk1b"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">3</span>)%Z = (-<span class="mi">3</span>)%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk1c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk1c"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span> = Z.neg p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk1d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk1d"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>)%Z = (-<span class="mi">1</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk1e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk1e"><span class="highlight"><span class="nb">rewrite</span> &lt;- (Pos.pred_double_succ p); <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span>~<span class="mi">1</span> = Z.neg p~<span class="mi">0</span>~<span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk1f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk1f"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">3</span>)%Z = (-<span class="mi">3</span>)%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk20" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk20"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span> = Z.neg p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk21" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk21"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>)%Z = (-<span class="mi">1</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk22" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk22"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">3</span>)%Z = (-<span class="mi">3</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk23" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk23"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span> = Z.neg p~<span class="mi">0</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk24" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk24"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>)%Z = (-<span class="mi">1</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk25" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk25"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z.neg p~<span class="mi">0</span> = Z.neg p~<span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk26" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk26"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>)%Z = (-<span class="mi">1</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk27" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk27"><span class="highlight"><span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(-<span class="mi">1</span>)%Z = (-<span class="mi">1</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk28" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk28"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_binary</span> : <span class="kr">forall</span> <span class="nv">n</span>:nat, Z -&gt; Bvector n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Z -&gt; Bvector n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk29" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk29"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Z -&gt; Bvector n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk2a" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk2a"><span class="highlight"><span class="nb">simple induction</span> n; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bvector <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk2b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; Bvector n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk2b"><hr></label><div class="goal-conclusion"><span class="highlight">Bvector (S n0)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk2c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk2c"><span class="highlight"><span class="bp">exact</span> Bnil.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; Bvector n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bvector (S n0)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (Bcons (Z.odd H0) n0 (H (Z.div2 H0))).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk2d" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk2d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_two_compl</span> : <span class="kr">forall</span> <span class="nv">n</span>:nat, Z -&gt; Bvector (S n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Z -&gt; Bvector (S n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk2e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk2e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Z -&gt; Bvector (S n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk2f" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk2f"><span class="highlight"><span class="nb">simple induction</span> n; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bvector <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk30" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; Bvector (S n0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk30"><hr></label><div class="goal-conclusion"><span class="highlight">Bvector (S (S n0))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk31" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk31"><span class="highlight"><span class="bp">exact</span> (Bcons (Z.odd H) <span class="mi">0</span> Bnil).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, n0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z -&gt; Bvector (S n0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bvector (S (S n0))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (Bcons (Z.odd H0) (S n0) (H (Zmod2 H0))).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">ENCODING_VALUE</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Z_BRIC_A_BRAC</span>.</span></span></span></pre><div class="doc">
Some auxiliary lemmas used in the next section. Large use of ZArith.
      Deserve to be properly rewritten.
  
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight">  </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk32" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk32"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">binary_value_Sn</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">b</span>:bool) (<span class="nv">bv</span>:Bvector n),
      binary_value (S n) ( b :: bv) =
      (bit_value b + <span class="mi">2</span> * binary_value n bv)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : bool) (<span class="nv">bv</span> : Bvector n),
binary_value (S n) (b :: bv) =
(bit_value b + <span class="mi">2</span> * binary_value n bv)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk33" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk33"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : bool) (<span class="nv">bv</span> : Bvector n),
binary_value (S n) (b :: bv) =
(bit_value b + <span class="mi">2</span> * binary_value n bv)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk34" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk34"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_binary_Sn</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">b</span>:bool) (<span class="nv">z</span>:Z),
      (z &gt;= <span class="mi">0</span>)%Z -&gt;
      Z_to_binary (S n) (bit_value b + <span class="mi">2</span> * z) = Bcons b n (Z_to_binary n z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : bool) (<span class="nv">z</span> : Z),
(z &gt;= <span class="mi">0</span>)%Z -&gt;
Z_to_binary (S n) (bit_value b + <span class="mi">2</span> * z) =
Bcons b n (Z_to_binary n z)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk35" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk35"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : bool) (<span class="nv">z</span> : Z),
(z &gt;= <span class="mi">0</span>)%Z -&gt;
Z_to_binary (S n) (bit_value b + <span class="mi">2</span> * z) =
Bcons b n (Z_to_binary n z)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk36" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk36"><span class="highlight"><span class="nb">destruct</span> b; <span class="nb">destruct</span> z; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt;
Bcons
  <span class="kr">match</span> Pos.pred_double p <span class="kr">with</span>
  | (_~<span class="mi">0</span>)%positive =&gt; false
  | _ =&gt; true
  <span class="kr">end</span> n
  (Z_to_binary n
     (Z.neg (Pos.div2_up (Pos.pred_double p)))) =
Bcons true n (Z_to_binary n (Z.neg p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intro</span> H; <span class="nb">elim</span> H; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk37" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk37"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">binary_value_pos</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">bv</span>:Bvector n), (binary_value n bv &gt;= <span class="mi">0</span>)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector n),
(binary_value n bv &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk38" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk38"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector n),
(binary_value n bv &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk39" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk39"><span class="highlight"><span class="nb">induction</span> bv <span class="kr">as</span> [| a n v IHbv]; <span class="nb">cbn</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk3a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(binary_value n v &gt;= <span class="mi">0</span>)%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk3a"><hr></label><div class="goal-conclusion"><span class="highlight">(bit_value a +
 <span class="kr">match</span> binary_value n v <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk3b" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk3b"><span class="highlight"><span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(binary_value n v &gt;= <span class="mi">0</span>)%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(bit_value a +
 <span class="kr">match</span> binary_value n v <span class="kr">with</span>
 | <span class="mi">0</span> =&gt; <span class="mi">0</span>
 | Z.pos y&#39; =&gt; Z.pos y&#39;~<span class="mi">0</span>
 | Z.neg y&#39; =&gt; Z.neg y&#39;~<span class="mi">0</span>
 <span class="kr">end</span> &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk3c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk3c"><span class="highlight"><span class="nb">destruct</span> a; <span class="nb">destruct</span> (binary_value n v); <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">v</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">0</span> &gt;= <span class="mi">0</span>)%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto with</span> zarith.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk3d" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk3d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">two_compl_value_Sn</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">bv</span>:Bvector (S n)) (<span class="nv">b</span>:bool),
      two_compl_value (S n) (Bcons b (S n) bv) =
      (bit_value b + <span class="mi">2</span> * two_compl_value n bv)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector (S n)) (<span class="nv">b</span> : bool),
two_compl_value (S n) (Bcons b (S n) bv) =
(bit_value b + <span class="mi">2</span> * two_compl_value n bv)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk3e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk3e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector (S n)) (<span class="nv">b</span> : bool),
two_compl_value (S n) (Bcons b (S n) bv) =
(bit_value b + <span class="mi">2</span> * two_compl_value n bv)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk3f" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk3f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_two_compl_Sn</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">b</span>:bool) (<span class="nv">z</span>:Z),
      Z_to_two_compl (S n) (bit_value b + <span class="mi">2</span> * z) =
      Bcons b (S n) (Z_to_two_compl n z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : bool) (<span class="nv">z</span> : Z),
Z_to_two_compl (S n) (bit_value b + <span class="mi">2</span> * z) =
Bcons b (S n) (Z_to_two_compl n z)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk40" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk40"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : bool) (<span class="nv">z</span> : Z),
Z_to_two_compl (S n) (bit_value b + <span class="mi">2</span> * z) =
Bcons b (S n) (Z_to_two_compl n z)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk41" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk41"><span class="highlight"><span class="nb">destruct</span> b; <span class="nb">destruct</span> z <span class="kr">as</span> [| p| p]; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_two_compl (S n) (bit_value true + <span class="mi">2</span> * Z.neg p) =
Bcons true (S n) (Z_to_two_compl n (Z.neg p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk42" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk42"><span class="highlight"><span class="nb">destruct</span> p <span class="kr">as</span> [p| p| ]; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_two_compl (S n) (bit_value true + <span class="mi">2</span> * Z.neg p~<span class="mi">0</span>) =
Bcons true (S n) (Z_to_two_compl n (Z.neg p~<span class="mi">0</span>))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk43" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk43"><span class="highlight"><span class="nb">destruct</span> p <span class="kr">as</span> [p| p| ]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bcons true (S n)
  (Z_to_two_compl n
     (Z.neg (Pos.succ (Pos.pred_double p))~<span class="mi">0</span>)) =
Bcons true (S n) (Z_to_two_compl n (Z.neg p~<span class="mi">0</span>~<span class="mi">0</span>))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> (Pos.succ_pred_double p); <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk44" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk44"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_binary_Sn_z</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">z</span>:Z),
      Z_to_binary (S n) z =
      Bcons (Z.odd z) n (Z_to_binary n (Z.div2 z)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
Z_to_binary (S n) z =
Bcons (Z.odd z) n (Z_to_binary n (Z.div2 z))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk45" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk45"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
Z_to_binary (S n) z =
Bcons (Z.odd z) n (Z_to_binary n (Z.div2 z))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk46" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk46"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_div2_value</span> :
    <span class="kr">forall</span> <span class="nv">z</span>:Z,
      (z &gt;= <span class="mi">0</span>)%Z -&gt; (bit_value (Z.odd z) + <span class="mi">2</span> * Z.div2 z)%Z = z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(bit_value (Z.odd z) + <span class="mi">2</span> * Z.div2 z)%Z = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk47" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk47"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(bit_value (Z.odd z) + <span class="mi">2</span> * Z.div2 z)%Z = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk48" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk48"><span class="highlight"><span class="nb">destruct</span> z <span class="kr">as</span> [| p| p]; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.pos p &gt;= <span class="mi">0</span>)%Z -&gt;
(bit_value (Z.odd (Z.pos p)) + <span class="mi">2</span> * Z.div2 (Z.pos p))%Z =
Z.pos p</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk49" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk49"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt;
(bit_value (Z.odd (Z.neg p)) + <span class="mi">2</span> * Z.div2 (Z.neg p))%Z =
Z.neg p</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk4a" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk4a"><span class="highlight"><span class="nb">destruct</span> p; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt;
(bit_value (Z.odd (Z.neg p)) + <span class="mi">2</span> * Z.div2 (Z.neg p))%Z =
Z.neg p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intro</span> H; <span class="nb">elim</span> H; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk4b" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk4b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Pdiv2</span> : <span class="kr">forall</span> <span class="nv">z</span>:Z, (z &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 z &gt;= <span class="mi">0</span>)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, (z &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 z &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk4c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk4c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, (z &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 z &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk4d" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk4d"><span class="highlight"><span class="nb">destruct</span> z <span class="kr">as</span> [| p| p].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 <span class="mi">0</span> &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk4e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk4e"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.pos p &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 (Z.pos p) &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk4f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk4f"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 (Z.neg p) &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk50" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk50"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.pos p &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 (Z.pos p) &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk51" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk51"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 (Z.neg p) &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk52" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk52"><span class="highlight"><span class="nb">destruct</span> p; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 <span class="mi">1</span> &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk53" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk53"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 (Z.neg p) &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk54" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk54"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.neg p &gt;= <span class="mi">0</span>)%Z -&gt; (Z.div2 (Z.neg p) &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intro</span> H; <span class="nb">elim</span> H; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk55" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk55"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zdiv2_two_power_nat</span> :
    <span class="kr">forall</span> (<span class="nv">z</span>:Z) (<span class="nv">n</span>:nat),
      (z &gt;= <span class="mi">0</span>)%Z -&gt;
      (z &lt; two_power_nat (S n))%Z -&gt; (Z.div2 z &lt; two_power_nat n)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">z</span> : Z) (<span class="nv">n</span> : nat),
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
(Z.div2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk56" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk56"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">z</span> : Z) (<span class="nv">n</span> : nat),
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
(Z.div2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk57" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk57"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.div2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk58" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk58"><span class="highlight"><span class="nb">enough</span> (<span class="mi">2</span> * Z.div2 z &lt; <span class="mi">2</span> * two_power_nat n)%Z <span class="bp">by</span> <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">2</span> * Z.div2 z &lt; <span class="mi">2</span> * two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk59" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk59"><span class="highlight"><span class="nb">rewrite</span> &lt;- two_power_nat_S.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">2</span> * Z.div2 z &lt; two_power_nat (S n))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk5a" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk5a"><span class="highlight"><span class="nb">destruct</span> (Zeven.Zeven_odd_dec z) <span class="kr">as</span> [Heven|Hodd]; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heven</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zeven z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">2</span> * Z.div2 z &lt; two_power_nat (S n))%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk5b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hodd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zodd z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk5b"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">2</span> * Z.div2 z &lt; two_power_nat (S n))%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk5c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk5c"><span class="highlight"><span class="nb">rewrite</span> &lt;- Zeven.Zeven_div2; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hodd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zodd z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">2</span> * Z.div2 z &lt; two_power_nat (S n))%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (Zeven.Zodd_div2 z Hodd); <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk5d" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk5d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_two_compl_Sn_z</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">z</span>:Z),
      Z_to_two_compl (S n) z =
      Bcons (Z.odd z) (S n) (Z_to_two_compl n (Zmod2 z)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
Z_to_two_compl (S n) z =
Bcons (Z.odd z) (S n) (Z_to_two_compl n (Zmod2 z))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk5e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk5e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
Z_to_two_compl (S n) z =
Bcons (Z.odd z) (S n) (Z_to_two_compl n (Zmod2 z))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk5f" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk5f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zeven_bit_value</span> :
    <span class="kr">forall</span> <span class="nv">z</span>:Z, Zeven.Zeven z -&gt; bit_value (Z.odd z) = <span class="mi">0</span>%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, Zeven z -&gt; bit_value (Z.odd z) = <span class="mi">0</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk60" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk60"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, Zeven z -&gt; bit_value (Z.odd z) = <span class="mi">0</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk61" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk61"><span class="highlight"><span class="nb">destruct</span> z; <span class="nb">unfold</span> bit_value; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zeven (Z.pos p) -&gt;
(<span class="kr">if</span> Z.odd (Z.pos p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">0</span>%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk62" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk62"><hr></label><div class="goal-conclusion"><span class="highlight">Zeven (Z.neg p) -&gt;
(<span class="kr">if</span> Z.odd (Z.neg p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">0</span>%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk63" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk63"><span class="highlight"><span class="nb">destruct</span> p; <span class="bp">tauto</span> || (<span class="nb">intro</span> H; <span class="nb">elim</span> H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zeven (Z.neg p) -&gt;
(<span class="kr">if</span> Z.odd (Z.neg p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">0</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> p; <span class="bp">tauto</span> || (<span class="nb">intro</span> H; <span class="nb">elim</span> H).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk64" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk64"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zodd_bit_value</span> :
    <span class="kr">forall</span> <span class="nv">z</span>:Z, Zeven.Zodd z -&gt; bit_value (Z.odd z) = <span class="mi">1</span>%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, Zodd z -&gt; bit_value (Z.odd z) = <span class="mi">1</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk65" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk65"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z, Zodd z -&gt; bit_value (Z.odd z) = <span class="mi">1</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk66" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk66"><span class="highlight"><span class="nb">destruct</span> z; <span class="nb">unfold</span> bit_value; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zodd <span class="mi">0</span> -&gt; (<span class="kr">if</span> Z.odd <span class="mi">0</span> <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">1</span>%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk67" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk67"><hr></label><div class="goal-conclusion"><span class="highlight">Zodd (Z.pos p) -&gt;
(<span class="kr">if</span> Z.odd (Z.pos p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">1</span>%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk68" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk68"><hr></label><div class="goal-conclusion"><span class="highlight">Zodd (Z.neg p) -&gt;
(<span class="kr">if</span> Z.odd (Z.neg p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">1</span>%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk69" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk69"><span class="highlight"><span class="nb">intros</span>; <span class="nb">elim</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zodd (Z.pos p) -&gt;
(<span class="kr">if</span> Z.odd (Z.pos p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">1</span>%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk6a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk6a"><hr></label><div class="goal-conclusion"><span class="highlight">Zodd (Z.neg p) -&gt;
(<span class="kr">if</span> Z.odd (Z.neg p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">1</span>%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk6b" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk6b"><span class="highlight"><span class="nb">destruct</span> p; <span class="bp">tauto</span> || (<span class="nb">intros</span>; <span class="nb">elim</span> H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Zodd (Z.neg p) -&gt;
(<span class="kr">if</span> Z.odd (Z.neg p) <span class="kr">then</span> <span class="mi">1</span>%Z <span class="kr">else</span> <span class="mi">0</span>%Z) = <span class="mi">1</span>%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> p; <span class="bp">tauto</span> || (<span class="nb">intros</span>; <span class="nb">elim</span> H).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk6c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk6c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zge_minus_two_power_nat_S</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">z</span>:Z),
      (z &gt;= - two_power_nat (S n))%Z -&gt; (Zmod2 z &gt;= - two_power_nat n)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &gt;= - two_power_nat (S n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk6d" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk6d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &gt;= - two_power_nat (S n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk6e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk6e"><span class="highlight"><span class="nb">intros</span> n z; <span class="nb">rewrite</span> (two_power_nat_S n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(z &gt;= - (<span class="mi">2</span> * two_power_nat n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk6f" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk6f"><span class="highlight"><span class="nb">generalize</span> (Zmod2_twice z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &gt;= - (<span class="mi">2</span> * two_power_nat n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk70" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk70"><span class="highlight"><span class="nb">destruct</span> (Zeven.Zeven_odd_dec z) <span class="kr">as</span> [H| H].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zeven z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &gt;= - (<span class="mi">2</span> * two_power_nat n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk71" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zodd z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk71"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &gt;= - (<span class="mi">2</span> * two_power_nat n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk72" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk72"><span class="highlight"><span class="nb">rewrite</span> (Zeven_bit_value z H); <span class="nb">intros</span>; <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zodd z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &gt;= - (<span class="mi">2</span> * two_power_nat n))%Z -&gt;
(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> (Zodd_bit_value z H); <span class="nb">intros</span>; <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk73" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk73"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zlt_two_power_nat_S</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">z</span>:Z),
      (z &lt; two_power_nat (S n))%Z -&gt; (Zmod2 z &lt; two_power_nat n)%Z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &lt; two_power_nat (S n))%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk74" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk74"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &lt; two_power_nat (S n))%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk75" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk75"><span class="highlight"><span class="nb">intros</span> n z; <span class="nb">rewrite</span> (two_power_nat_S n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(z &lt; <span class="mi">2</span> * two_power_nat n)%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk76" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk76"><span class="highlight"><span class="nb">generalize</span> (Zmod2_twice z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &lt; <span class="mi">2</span> * two_power_nat n)%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk77" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk77"><span class="highlight"><span class="nb">destruct</span> (Zeven.Zeven_odd_dec z) <span class="kr">as</span> [H| H].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zeven z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &lt; <span class="mi">2</span> * two_power_nat n)%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk78" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zodd z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk78"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &lt; <span class="mi">2</span> * two_power_nat n)%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk79" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk79"><span class="highlight"><span class="nb">rewrite</span> (Zeven_bit_value z H); <span class="nb">intros</span>; <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zodd z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (<span class="mi">2</span> * Zmod2 z + bit_value (Z.odd z))%Z -&gt;
(z &lt; <span class="mi">2</span> * two_power_nat n)%Z -&gt;
(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> (Zodd_bit_value z H); <span class="nb">intros</span>; <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Z_BRIC_A_BRAC</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">COHERENT_VALUE</span>.</span></span></span></pre><div class="doc">
We check that the functions are reciprocal on the definition interval.
    This uses earlier library lemmas.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-nc"><span class="highlight">  </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk7a" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk7a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">binary_to_Z_to_binary</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">bv</span>:Bvector n), Z_to_binary n (binary_value n bv) = bv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector n),
Z_to_binary n (binary_value n bv) = bv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk7b" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk7b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector n),
Z_to_binary n (binary_value n bv) = bv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk7c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk7c"><span class="highlight"><span class="nb">induction</span> bv <span class="kr">as</span> [| a n bv IHbv].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_binary <span class="mi">0</span> (binary_value <span class="mi">0</span> []) = []</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk7d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z_to_binary n (binary_value n bv) = bv</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk7d"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_binary (S n) (binary_value (S n) (a :: bv)) =
a :: bv</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk7e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk7e"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z_to_binary n (binary_value n bv) = bv</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_binary (S n) (binary_value (S n) (a :: bv)) =
a :: bv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk7f" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk7f"><span class="highlight"><span class="nb">rewrite</span> binary_value_Sn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z_to_binary n (binary_value n bv) = bv</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_binary (S n)
  (bit_value a + <span class="mi">2</span> * binary_value n bv) = a :: bv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk80" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk80"><span class="highlight"><span class="nb">rewrite</span> Z_to_binary_Sn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z_to_binary n (binary_value n bv) = bv</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bcons a n (Z_to_binary n (binary_value n bv)) =
a :: bv</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk81" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z_to_binary n (binary_value n bv) = bv</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk81"><hr></label><div class="goal-conclusion"><span class="highlight">(binary_value n bv &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk82" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk82"><span class="highlight"><span class="nb">rewrite</span> IHbv; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z_to_binary n (binary_value n bv) = bv</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(binary_value n bv &gt;= <span class="mi">0</span>)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> binary_value_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk83" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk83"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">two_compl_to_Z_to_two_compl</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">bv</span>:Bvector n) (<span class="nv">b</span>:bool),
      Z_to_two_compl n (two_compl_value n (Bcons b n bv)) = Bcons b n bv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector n) (<span class="nv">b</span> : bool),
Z_to_two_compl n (two_compl_value n (Bcons b n bv)) =
Bcons b n bv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk84" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk84"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">bv</span> : Bvector n) (<span class="nv">b</span> : bool),
Z_to_two_compl n (two_compl_value n (Bcons b n bv)) =
Bcons b n bv</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk85" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk85"><span class="highlight"><span class="nb">induction</span> bv <span class="kr">as</span> [| a n bv IHbv]; <span class="nb">intro</span> b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_two_compl <span class="mi">0</span> (two_compl_value <span class="mi">0</span> (Bcons b <span class="mi">0</span> [])) =
Bcons b <span class="mi">0</span> []</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk86" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">b0</span> : bool,
Z_to_two_compl n
  (two_compl_value n (Bcons b0 n bv)) =
Bcons b0 n bv</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk86"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_two_compl (S n)
  (two_compl_value (S n) (Bcons b (S n) (a :: bv))) =
Bcons b (S n) (a :: bv)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk87" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk87"><span class="highlight"><span class="nb">destruct</span> b; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">b0</span> : bool,
Z_to_two_compl n
  (two_compl_value n (Bcons b0 n bv)) =
Bcons b0 n bv</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_two_compl (S n)
  (two_compl_value (S n) (Bcons b (S n) (a :: bv))) =
Bcons b (S n) (a :: bv)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk88" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk88"><span class="highlight"><span class="nb">rewrite</span> two_compl_value_Sn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">b0</span> : bool,
Z_to_two_compl n
  (two_compl_value n (Bcons b0 n bv)) =
Bcons b0 n bv</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Z_to_two_compl (S n)
  (bit_value b + <span class="mi">2</span> * two_compl_value n (a :: bv)) =
Bcons b (S n) (a :: bv)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk89" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk89"><span class="highlight"><span class="nb">rewrite</span> Z_to_two_compl_Sn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">bv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">VectorDef.t bool n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHbv</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">b0</span> : bool,
Z_to_two_compl n
  (two_compl_value n (Bcons b0 n bv)) =
Bcons b0 n bv</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bool</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">Bcons b (S n)
  (Z_to_two_compl n (two_compl_value n (a :: bv))) =
Bcons b (S n) (a :: bv)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> IHbv; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk8a" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk8a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_binary_to_Z</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">z</span>:Z),
      (z &gt;= <span class="mi">0</span>)%Z -&gt;
      (z &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z) = z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt;
binary_value n (Z_to_binary n z) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk8b" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk8b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt;
binary_value n (Z_to_binary n z) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk8c" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk8c"><span class="highlight"><span class="nb">induction</span> n <span class="kr">as</span> [| n IHn].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat <span class="mi">0</span>)%Z -&gt;
binary_value <span class="mi">0</span> (Z_to_binary <span class="mi">0</span> z) = z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk8d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt; (z &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z) = z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk8d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
binary_value (S n) (Z_to_binary (S n) z) = z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk8e" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk8e"><span class="highlight"><span class="nb">unfold</span> two_power_nat, shift_nat; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt; (z &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z) = z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
binary_value (S n) (Z_to_binary (S n) z) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk8f" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk8f"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> Z_to_binary_Sn_z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">binary_value (S n)
  (Bcons (Z.odd z) n (Z_to_binary n (Z.div2 z))) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk90" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk90"><span class="highlight"><span class="nb">rewrite</span> binary_value_Sn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(bit_value (Z.odd z) +
 <span class="mi">2</span> * binary_value n (Z_to_binary n (Z.div2 z)))%Z = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk91" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk91"><span class="highlight"><span class="nb">rewrite</span> IHn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(bit_value (Z.odd z) + <span class="mi">2</span> * Z.div2 z)%Z = z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk92" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk92"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.div2 z &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk93" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk93"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.div2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk94" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk94"><span class="highlight"><span class="nb">apply</span> Z_div2_value; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.div2 z &gt;= <span class="mi">0</span>)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk95" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk95"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.div2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk96" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk96"><span class="highlight"><span class="nb">apply</span> Pdiv2; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= <span class="mi">0</span>)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; binary_value n (Z_to_binary n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= <span class="mi">0</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Z.div2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Zdiv2_two_power_nat; <span class="nb">trivial</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk97" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk97"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Z_to_two_compl_to_Z</span> :
    <span class="kr">forall</span> (<span class="nv">n</span>:nat) (<span class="nv">z</span>:Z),
      (z &gt;= - two_power_nat n)%Z -&gt;
      (z &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z) = z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt;
two_compl_value n (Z_to_two_compl n z) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk98" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk98"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">z</span> : Z),
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt;
two_compl_value n (Z_to_two_compl n z) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk99" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk99"><span class="highlight"><span class="nb">induction</span> n <span class="kr">as</span> [| n IHn].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat <span class="mi">0</span>)%Z -&gt;
(z &lt; two_power_nat <span class="mi">0</span>)%Z -&gt;
two_compl_value <span class="mi">0</span> (Z_to_two_compl <span class="mi">0</span> z) = z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk9a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z) = z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk9a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat (S n))%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
two_compl_value (S n) (Z_to_two_compl (S n) z) = z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk9b" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk9b"><span class="highlight"><span class="nb">unfold</span> two_power_nat, shift_nat; <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= -<span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; <span class="mi">1</span>)%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rec_r (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; bool -&gt; Vector.t bool n -&gt; Z)
  (<span class="kr">fun</span> (<span class="nv">h</span> : bool) (<span class="nv">_</span> : Vector.t bool <span class="mi">0</span>) =&gt;
   (- bit_value h)%Z) eq_refl (Z.odd z) Bnil = z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk9c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z) = z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk9c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat (S n))%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
two_compl_value (S n) (Z_to_two_compl (S n) z) = z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chk9d" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chk9d"><span class="highlight"><span class="nb">assert</span> (z = (-<span class="mi">1</span>)%Z \/ z = <span class="mi">0</span>%Z).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= -<span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; <span class="mi">1</span>)%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">z = (-<span class="mi">1</span>)%Z \/ z = <span class="mi">0</span>%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chk9e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= -<span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; <span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z = (-<span class="mi">1</span>)%Z \/ z = <span class="mi">0</span>%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk9e"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rec_r (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; bool -&gt; Vector.t bool n -&gt; Z)
  (<span class="kr">fun</span> (<span class="nv">h</span> : bool) (<span class="nv">_</span> : Vector.t bool <span class="mi">0</span>) =&gt;
   (- bit_value h)%Z) eq_refl (Z.odd z) Bnil = z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chk9f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z) = z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chk9f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat (S n))%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
two_compl_value (S n) (Z_to_two_compl (S n) z) = z</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka0" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka0"><span class="highlight"><span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= -<span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; <span class="mi">1</span>)%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">z = (-<span class="mi">1</span>)%Z \/ z = <span class="mi">0</span>%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">eq_rec_r (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; bool -&gt; Vector.t bool n -&gt; Z)
  (<span class="kr">fun</span> (<span class="nv">h</span> : bool) (<span class="nv">_</span> : Vector.t bool <span class="mi">0</span>) =&gt;
   (- bit_value h)%Z) eq_refl (Z.odd z) Bnil = z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chka1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z) = z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chka1"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat (S n))%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
two_compl_value (S n) (Z_to_two_compl (S n) z) = z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka2" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka2"><span class="highlight"><span class="nb">intuition</span>; <span class="nb">subst</span> z; <span class="nb">trivial</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat n)%Z -&gt;
(z &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z) = z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">z</span> : Z,
(z &gt;= - two_power_nat (S n))%Z -&gt;
(z &lt; two_power_nat (S n))%Z -&gt;
two_compl_value (S n) (Z_to_two_compl (S n) z) = z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka3" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka3"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> Z_to_two_compl_Sn_z.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">two_compl_value (S n)
  (Bcons (Z.odd z) (S n) (Z_to_two_compl n (Zmod2 z))) =
z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka4" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka4"><span class="highlight"><span class="nb">rewrite</span> two_compl_value_Sn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(bit_value (Z.odd z) +
 <span class="mi">2</span> * two_compl_value n (Z_to_two_compl n (Zmod2 z)))%Z =
z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka5" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka5"><span class="highlight"><span class="nb">rewrite</span> IHn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(bit_value (Z.odd z) + <span class="mi">2</span> * Zmod2 z)%Z = z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chka6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chka6"><hr></label><div class="goal-conclusion"><span class="highlight">(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zdigits-v-chka7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chka7"><hr></label><div class="goal-conclusion"><span class="highlight">(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chka8" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chka8"><span class="highlight"><span class="nb">generalize</span> (Zmod2_twice z); <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Zmod2 z &gt;= - two_power_nat n)%Z</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zdigits-v-chka9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zdigits-v-chka9"><hr></label><div class="goal-conclusion"><span class="highlight">(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zdigits-v-chkaa" style="display: none" type="checkbox"><label class="coq-input" for="Zdigits-v-chkaa"><span class="highlight"><span class="nb">apply</span> Zge_minus_two_power_nat_S; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">z0</span> : Z,
(z0 &gt;= - two_power_nat n)%Z -&gt;
(z0 &lt; two_power_nat n)%Z -&gt; two_compl_value n (Z_to_two_compl n z0) = z0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &gt;= - two_power_nat (S n))%Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(z &lt; two_power_nat (S n))%Z</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="highlight">(Zmod2 z &lt; two_power_nat n)%Z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Zlt_two_power_nat_S; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-nc"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">COHERENT_VALUE</span>.</span></span></span></pre></article></body></html>