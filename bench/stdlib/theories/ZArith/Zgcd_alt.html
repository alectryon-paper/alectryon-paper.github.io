<!DOCTYPE html>
<html><head><title>Zgcd_alt.v</title><meta charset="utf-8"><meta content="Alectryon v0.2" name="generator"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"><link href="https://unpkg.com/firacode/distr/fira_code.css" rel="stylesheet"><link href="alectryon.css" rel="stylesheet"><script src="alectryon.js"></script><style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-standalone alectryon-centered alectryon-coqdoc"><div class="alectryon-header">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running <a href="https://coq.inria.fr/">Coq</a>+<a href="https://github.com/ejgallego/coq-serapi">SerAPI</a> v8.10.0+0.7.0. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"><span class="sd">(************************************************************************)</span>
<span class="c">(*         *   The Coq Proof Assistant / The Coq Development Team       *)</span>
<span class="c">(*  v      *   INRIA, CNRS and contributors - Copyright 1999-2018       *)</span>
<span class="c">(* &lt;O___,, *       (see CREDITS file for the list of authors)           *)</span>
<span class="c">(*   \VV/  **************************************************************)</span>
<span class="c">(*    //   *    This file is distributed under the terms of the         *)</span>
<span class="c">(*         *     GNU Lesser General Public License Version 2.1          *)</span>
<span class="c">(*         *     (see LICENSE file for the text of the license)         *)</span>
<span class="sd">(************************************************************************)</span></span></span></pre><div class="doc">
<a name="lab1"></a><h1 class="section">Zgcd_alt : an alternate version of Z.gcd, based on Euclid's algorithm</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
Author: Pierre Letouzey

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
The alternate <span class="inlinecode"><span class="id" title="var">Zgcd_alt</span></span> given here used to be the main <span class="inlinecode"><span class="id" title="var">Z.gcd</span></span>
    function (see file <span class="inlinecode"><span class="id" title="var">Znumtheory</span></span>), but this main <span class="inlinecode"><span class="id" title="var">Z.gcd</span></span> is now
    based on a modern binary-efficient algorithm. This earlier
    version, based on Euclid's algorithm of iterated modulo, is kept
    here due to both its intrinsic interest and its use as reference
    point when proving gcd on Int31 numbers 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> ZArith_base.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> ZArithRing.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> Zdiv.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> Znumtheory.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> Omega.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Open Scope</span> Z_scope.</span></span></span></pre><div class="doc">
In Coq, we need to control the number of iteration of modulo.
   For that, we use an explicit measure in <span class="inlinecode"><span class="id" title="var">nat</span></span>, and we prove later
   that using <span class="inlinecode">2*<span class="id" title="var">d</span></span> is enough, where <span class="inlinecode"><span class="id" title="var">d</span></span> is the number of binary
   digits of the first argument. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">Zgcdn</span> (<span class="nv">n</span>:nat) : Z -&gt; Z -&gt; Z := <span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt;
   <span class="kr">match</span> n <span class="kr">with</span>
     | O =&gt; <span class="mi">1</span> <span class="c">(* arbitrary, since n should be big enough *)</span>
     | S n =&gt; <span class="kr">match</span> a <span class="kr">with</span>
	        | Z0 =&gt; Z.abs b
	        | Zpos _ =&gt; Zgcdn n (Z.modulo b a) a
	        | Zneg a =&gt; Zgcdn n (Z.modulo b (Zpos a)) (Zpos a)
  	      <span class="kr">end</span>
   <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Zgcd_bound</span> (<span class="nv">a</span>:Z) :=
   <span class="kr">match</span> a <span class="kr">with</span>
     | Z0 =&gt; S O
     | Zpos p =&gt; <span class="kr">let</span> <span class="nv">n</span> := Pos.size_nat p <span class="kr">in</span> (n+n)%nat
     | Zneg p =&gt; <span class="kr">let</span> <span class="nv">n</span> := Pos.size_nat p <span class="kr">in</span> (n+n)%nat
   <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Zgcd_alt</span> <span class="nv">a</span> <span class="nv">b</span> := Zgcdn (Zgcd_bound a) a b.</span></span></span></pre><div class="doc">
A first obvious fact : <span class="inlinecode"><span class="id" title="var">Z.gcd</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> is positive. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk0" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_pos</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span>,
   <span class="mi">0</span> &lt;= Zgcdn n a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z), <span class="mi">0</span> &lt;= Zgcdn n a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk1" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z), <span class="mi">0</span> &lt;= Zgcdn n a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk2" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk2"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcdn <span class="mi">0</span> a b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcdn n a b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcdn (S n) a b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcdn n a b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcdn (S n) a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">auto with</span> zarith; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk5" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcd_alt_pos</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span>, <span class="mi">0</span> &lt;= Zgcd_alt a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcd_alt a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk6" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, <span class="mi">0</span> &lt;= Zgcd_alt a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> Z.gcd; <span class="nb">apply</span> Zgcdn_pos; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
We now prove that Z.gcd is indeed a gcd. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span></pre><div class="doc">
1) We prove a weaker &amp; easier bound. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_linear_bound</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span>,
   Z.abs a &lt; Z.of_nat n -&gt; Zis_gcd a b (Zgcdn n a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z),
Z.abs a &lt; Z.of_nat n -&gt; Zis_gcd a b (Zgcdn n a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z),
Z.abs a &lt; Z.of_nat n -&gt; Zis_gcd a b (Zgcdn n a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk9" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk9"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
Z.abs a &lt; Z.of_nat <span class="mi">0</span> -&gt; Zis_gcd a b (Zgcdn <span class="mi">0</span> a b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chka" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, Z.abs a &lt; Z.of_nat n -&gt; Zis_gcd a b (Zgcdn n a b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chka"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
Z.abs a &lt; Z.of_nat (S n) -&gt;
Zis_gcd a b (Zgcdn (S n) a b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkb" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkb"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.abs a &lt; <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd a b <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chkc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, Z.abs a &lt; Z.of_nat n -&gt; Zis_gcd a b (Zgcdn n a b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chkc"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
Z.abs a &lt; Z.of_nat (S n) -&gt;
Zis_gcd a b (Zgcdn (S n) a b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkd" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkd"><span class="highlight"><span class="nb">exfalso</span>; <span class="nb">generalize</span> (Z.abs_nonneg a); <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, Z.abs a &lt; Z.of_nat n -&gt; Zis_gcd a b (Zgcdn n a b)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
Z.abs a &lt; Z.of_nat (S n) -&gt;
Zis_gcd a b (Zgcdn (S n) a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chke" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chke"><span class="highlight"><span class="nb">destruct</span> a; <span class="nb">intros</span>; <span class="nb">simpl</span>;
     [ <span class="nb">generalize</span> (Zis_gcd_0_abs b); <span class="nb">intuition</span> | | ];
   <span class="nb">unfold</span> Z.modulo;
   <span class="nb">generalize</span> (Z_div_mod b (Zpos p) (eq_refl Gt));
   <span class="nb">destruct</span> (Z.div_eucl b (Zpos p)) <span class="kr">as</span> (q,r);
   <span class="nb">intros</span> (H0,H1);
   <span class="nb">rewrite</span> Nat2Z.inj_succ <span class="kr">in</span> H; <span class="nb">simpl</span> Z.abs <span class="kr">in</span> H;
   (<span class="nb">assert</span> (H2: Z.abs r &lt; Z.of_nat n) <span class="bp">by</span>
    (<span class="nb">rewrite</span> Z.abs_eq; <span class="nb">auto with</span> zarith));
    <span class="nb">assert</span> (IH:=IHn r (Zpos p) H2); <span class="nb">clear</span> IHn;
    <span class="nb">simpl</span> <span class="kr">in</span> IH |- *;
    <span class="nb">rewrite</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; Z.succ (Z.of_nat n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos p * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r &lt; Z.pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.abs r &lt; Z.of_nat n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd r (Z.pos p) (Zgcdn n r (Z.pos p))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) (Z.pos p * q + r)
  (Zgcdn n r (Z.pos p))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chkf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; Z.succ (Z.of_nat n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos p * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r &lt; Z.pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.abs r &lt; Z.of_nat n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd r (Z.pos p) (Zgcdn n r (Z.pos p))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chkf"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.neg p) (Z.pos p * q + r)
  (Zgcdn n r (Z.pos p))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk10" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk10"><span class="highlight"><span class="nb">apply</span> Zis_gcd_for_euclid2; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; Z.succ (Z.of_nat n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos p * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r &lt; Z.pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.abs r &lt; Z.of_nat n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd r (Z.pos p) (Zgcdn n r (Z.pos p))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.neg p) (Z.pos p * q + r)
  (Zgcdn n r (Z.pos p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk11" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk11"><span class="highlight"><span class="nb">apply</span> Zis_gcd_minus; <span class="nb">apply</span> Zis_gcd_sym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; Z.succ (Z.of_nat n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos p * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r &lt; Z.pos p</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.abs r &lt; Z.of_nat n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd r (Z.pos p) (Zgcdn n r (Z.pos p))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (- Z.neg p) (Z.pos p * q + r)
  (Zgcdn n r (Z.pos p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Zis_gcd_for_euclid2; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
2) For Euclid's algorithm, the worst-case situation corresponds
    to Fibonacci numbers. Let's define them: 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">fibonacci</span> (<span class="nv">n</span>:nat) : Z :=
   <span class="kr">match</span> n <span class="kr">with</span>
     | O =&gt; <span class="mi">1</span>
     | S O =&gt; <span class="mi">1</span>
     | S (S n <span class="kr">as</span> p) =&gt; fibonacci p + fibonacci n
   <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk12" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk12"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fibonacci_pos</span> : <span class="kr">forall</span> <span class="nv">n</span>, <span class="mi">0</span> &lt;= fibonacci n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, <span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk13" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk13"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, <span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk14" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk14"><span class="highlight"><span class="nb">enough</span> (<span class="kr">forall</span> <span class="nv">N</span> <span class="nv">n</span>, (n&lt;N)%nat -&gt; <span class="mi">0</span>&lt;=fibonacci n) <span class="bp">by</span> <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">N</span> <span class="nv">n</span> : nat, (n &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk15" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk15"><span class="highlight"><span class="nb">induction</span> N.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; <span class="mi">0</span>)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk16" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk16"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; S N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk17" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk17"><span class="highlight"><span class="nb">inversion</span> <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; S N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk18" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk18"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, (n0 &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt; S N)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk19" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk19"><span class="highlight"><span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">0</span> &lt; S N)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci <span class="mi">0</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk1a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, (n0 &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S n &lt; S N)%nat</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk1a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci (S n)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk1b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk1b"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, (n0 &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S n &lt; S N)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci (S n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk1c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk1c"><span class="highlight"><span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, (n &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S N)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk1d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, (n0 &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S (S n) &lt; S N)%nat</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk1d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci (S (S n))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk1e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk1e"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, (n0 &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S (S n) &lt; S N)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci (S (S n))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk1f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk1f"><span class="highlight"><span class="nb">change</span> (<span class="mi">0</span> &lt;= fibonacci (S n) + fibonacci n).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">N</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHN</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat, (n0 &lt; N)%nat -&gt; <span class="mi">0</span> &lt;= fibonacci n0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S (S n) &lt; S N)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt;= fibonacci (S n) + fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (IHN n) (IHN (S n)); <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk20" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk20"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fibonacci_incr</span> :
   <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span>, (n&lt;=m)%nat -&gt; fibonacci n &lt;= fibonacci m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : nat,
(n &lt;= m)%nat -&gt; fibonacci n &lt;= fibonacci m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk21" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk21"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">m</span> : nat,
(n &lt;= m)%nat -&gt; fibonacci n &lt;= fibonacci m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk22" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk22"><span class="highlight"><span class="nb">induction</span> <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci n &lt;= fibonacci n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk23" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt;= m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHle</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci n &lt;= fibonacci m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk23"><hr></label><div class="goal-conclusion"><span class="highlight">fibonacci n &lt;= fibonacci (S m)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk24" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk24"><span class="highlight"><span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt;= m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHle</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci n &lt;= fibonacci m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci n &lt;= fibonacci (S m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk25" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk25"><span class="highlight"><span class="nb">apply</span> Z.le_trans <span class="kr">with</span> (fibonacci m); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(n &lt;= m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHle</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci n &lt;= fibonacci m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci m &lt;= fibonacci (S m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk26" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk26"><span class="highlight"><span class="nb">clear</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci m &lt;= fibonacci (S m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk27" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk27"><span class="highlight"><span class="nb">destruct</span> m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci <span class="mi">0</span> &lt;= fibonacci <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk28" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk28"><hr></label><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= fibonacci (S (S m))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk29" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk29"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= fibonacci (S (S m))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk2a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk2a"><span class="highlight"><span class="nb">change</span> (fibonacci (S m) &lt;= fibonacci (S m)+fibonacci m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= fibonacci (S m) + fibonacci m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (fibonacci_pos m); <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
3) We prove that fibonacci numbers are indeed worst-case:
    for a given number <span class="inlinecode"><span class="id" title="var">n</span></span>, if we reach a conclusion about <span class="inlinecode"><span class="id" title="var">gcd</span>(<span class="id" title="var">a</span>,<span class="id" title="var">b</span>)</span> in
    exactly <span class="inlinecode"><span class="id" title="var">n</span>+1</span> loops, then <span class="inlinecode"><span class="id" title="var">fibonacci</span></span> <span class="inlinecode">(<span class="id" title="var">n</span>+1)&lt;=<span class="id" title="var">a</span></span> <span class="inlinecode">‚àß</span> <span class="inlinecode"><span class="id" title="var">fibonacci</span>(<span class="id" title="var">n</span>+2)&lt;=<span class="id" title="var">b</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk2b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk2b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_worst_is_fibonacci</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span>,
   <span class="mi">0</span> &lt; a &lt; b -&gt;
   Zis_gcd a b (Zgcdn (S n) a b) -&gt;
   Zgcdn n a b &lt;&gt; Zgcdn (S n) a b -&gt;
   fibonacci (S n) &lt;= a /\
   fibonacci (S (S n)) &lt;= b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z),
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn (S n) a b) -&gt;
Zgcdn n a b &lt;&gt; Zgcdn (S n) a b -&gt;
fibonacci (S n) &lt;= a /\ fibonacci (S (S n)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk2c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk2c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z),
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn (S n) a b) -&gt;
Zgcdn n a b &lt;&gt; Zgcdn (S n) a b -&gt;
fibonacci (S n) &lt;= a /\ fibonacci (S (S n)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk2d" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk2d"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn <span class="mi">1</span> a b) -&gt;
Zgcdn <span class="mi">0</span> a b &lt;&gt; Zgcdn <span class="mi">1</span> a b -&gt;
fibonacci <span class="mi">1</span> &lt;= a /\ fibonacci <span class="mi">2</span> &lt;= b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk2e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn (S n) a b) -&gt;
Zgcdn n a b &lt;&gt; Zgcdn (S n) a b -&gt;
fibonacci (S n) &lt;= a /\ fibonacci (S (S n)) &lt;= b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk2e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn (S (S n)) a b) -&gt;
Zgcdn (S n) a b &lt;&gt; Zgcdn (S (S n)) a b -&gt;
fibonacci (S (S n)) &lt;= a /\
fibonacci (S (S (S n))) &lt;= b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk2f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk2f"><span class="highlight"><span class="nb">intros</span> [|a|a]; <span class="nb">intros</span>; <span class="nb">simpl</span>; <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn (S n) a b) -&gt;
Zgcdn n a b &lt;&gt; Zgcdn (S n) a b -&gt;
fibonacci (S n) &lt;= a /\ fibonacci (S (S n)) &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; a &lt; b -&gt;
Zis_gcd a b (Zgcdn (S (S n)) a b) -&gt;
Zgcdn (S n) a b &lt;&gt; Zgcdn (S (S n)) a b -&gt;
fibonacci (S (S n)) &lt;= a /\
fibonacci (S (S (S n))) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk30" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk30"><span class="highlight"><span class="nb">intros</span> [|a|a] b (Ha,Ha&#39;); [<span class="nb">simpl</span>; <span class="bp">omega</span> | | <span class="bp">easy</span> ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn (S n) a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn (S n) a0 b0 -&gt;
fibonacci (S n) &lt;= a0 /\ fibonacci (S (S n)) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn (S (S n)) (Z.pos a) b) -&gt;
Zgcdn (S n) (Z.pos a) b &lt;&gt; Zgcdn (S (S n)) (Z.pos a) b -&gt;
fibonacci (S (S n)) &lt;= Z.pos a /\
fibonacci (S (S (S n))) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk31" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk31"><span class="highlight"><span class="nb">remember</span> (S n) <span class="kr">as</span> m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn (S m) (Z.pos a) b) -&gt;
Zgcdn m (Z.pos a) b &lt;&gt; Zgcdn (S m) (Z.pos a) b -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk32" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk32"><span class="highlight"><span class="nb">rewrite</span> Heqm <span class="nb">at</span> <span class="mi">2</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn (S m) (Z.pos a) b) -&gt;
Zgcdn (S n) (Z.pos a) b &lt;&gt; Zgcdn (S m) (Z.pos a) b -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk33" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk33"><span class="highlight"><span class="nb">simpl</span> Zgcdn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b
  (Zgcdn m (b mod Z.pos a) (Z.pos a)) -&gt;
Zgcdn n (b mod Z.pos a) (Z.pos a) &lt;&gt;
Zgcdn m (b mod Z.pos a) (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk34" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk34"><span class="highlight"><span class="nb">unfold</span> Z.modulo; <span class="nb">generalize</span> (Z_div_mod b (Zpos a) eq_refl).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span> (<span class="nv">q</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span>
 b = Z.pos a * q + r /\ <span class="mi">0</span> &lt;= r &lt; Z.pos a) -&gt;
Zis_gcd (Z.pos a) b
  (Zgcdn m (<span class="kr">let</span> (<span class="nv">_</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span> r)
     (Z.pos a)) -&gt;
Zgcdn n (<span class="kr">let</span> (<span class="nv">_</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span> r)
  (Z.pos a) &lt;&gt;
Zgcdn m (<span class="kr">let</span> (<span class="nv">_</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span> r)
  (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk35" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk35"><span class="highlight"><span class="nb">destruct</span> (Z.div_eucl b (Zpos a)) <span class="kr">as</span> (q,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b = Z.pos a * q + r /\ <span class="mi">0</span> &lt;= r &lt; Z.pos a -&gt;
Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk36" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk36"><span class="highlight"><span class="nb">intros</span> (EQ,(Hr,Hr&#39;)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk37" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk37"><span class="highlight">Z.le_elim Hr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk38" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> = r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk38"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk39" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk39"><span class="highlight">- <span class="c">(* r &gt; 0 *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk3a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk3a"><span class="highlight"><span class="nb">replace</span> (fibonacci (S (S m))) <span class="kr">with</span> (fibonacci (S m) + fibonacci m) <span class="bp">by</span> <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\
fibonacci (S m) + fibonacci m &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk3b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk3b"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= Z.pos a /\
fibonacci (S m) + fibonacci m &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk3c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk3c"><span class="highlight"><span class="nb">destruct</span> (IHn r (Zpos a) (conj Hr Hr&#39;)); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn m r (Z.pos a))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk3d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk3d"><hr></label><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= Z.pos a /\
fibonacci (S m) + fibonacci m &lt;= b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk3e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk3e"><span class="highlight">+</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn m r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk3f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk3f"><span class="highlight"><span class="nb">assert</span> (EQ&#39; : r = Zpos a * (-q) + b) <span class="bp">by</span> (<span class="nb">rewrite</span> EQ; <span class="bp">ring</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = Z.pos a * - q + b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn m r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk40" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk40"><span class="highlight"><span class="nb">rewrite</span> EQ&#39; <span class="nb">at</span> <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = Z.pos a * - q + b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a * - q + b) 
  (Z.pos a) (Zgcdn m r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk41" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk41"><span class="highlight"><span class="nb">apply</span> Zis_gcd_sym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = Z.pos a * - q + b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) (Z.pos a * - q + b)
  (Zgcdn m r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk42" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk42"><span class="highlight"><span class="nb">apply</span> Zis_gcd_for_euclid2; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r = Z.pos a * - q + b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd b (Z.pos a) (Zgcdn m r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Zis_gcd_sym; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk43" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk43"><span class="highlight">+</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= Z.pos a /\
fibonacci (S m) + fibonacci m &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk44" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk44"><span class="highlight"><span class="nb">split</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) + fibonacci m &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk45" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk45"><span class="highlight"><span class="nb">rewrite</span> EQ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) + fibonacci m &lt;= Z.pos a * q + r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk46" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk46"><span class="highlight"><span class="nb">apply</span> Z.add_le_mono; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= Z.pos a * q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk47" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk47"><span class="highlight"><span class="nb">apply</span> Z.le_trans <span class="kr">with</span> (Zpos a * <span class="mi">1</span>); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fibonacci (S m) &lt;= Z.pos a * <span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk48" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk48"><hr></label><div class="goal-conclusion"><span class="highlight">Z.pos a * <span class="mi">1</span> &lt;= Z.pos a * q</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk49" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk49"><span class="highlight"><span class="bp">now</span> <span class="nb">rewrite</span> Z.mul_1_r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos a * <span class="mi">1</span> &lt;= Z.pos a * q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4a"><span class="highlight"><span class="nb">apply</span> Z.mul_le_mono_nonneg_l; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt;= q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4b"><span class="highlight"><span class="nb">change</span> <span class="mi">1</span> <span class="kr">with</span> (Z.succ <span class="mi">0</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.succ <span class="mi">0</span> &lt;= q</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4c"><span class="highlight"><span class="nb">apply</span> Z.le_succ_l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; q</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4d" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4d"><span class="highlight"><span class="nb">destruct</span> q; <span class="nb">auto with</span> zarith.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * Z.neg p + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Z.neg p</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">       </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4e"><span class="highlight"><span class="nb">assert</span> (Zpos a * Zneg p &lt; <span class="mi">0</span>) <span class="bp">by</span> <span class="bp">now</span> <span class="nb">compute</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * Z.neg p + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci m &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">fibonacci (S m) &lt;= Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a * Z.neg p &lt; <span class="mi">0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Z.neg p</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk4f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk4f"><span class="highlight">- <span class="c">(* r = 0 *)</span></span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">a0</span> <span class="nv">b0</span> : Z,
<span class="mi">0</span> &lt; a0 &lt; b0 -&gt;
Zis_gcd a0 b0 (Zgcdn m a0 b0) -&gt;
Zgcdn n a0 b0 &lt;&gt; Zgcdn m a0 b0 -&gt;
fibonacci m &lt;= a0 /\ fibonacci (S m) &lt;= b0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">EQ</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">b = Z.pos a * q + r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> = r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn m r (Z.pos a)) -&gt;
Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk50" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk50"><span class="highlight"><span class="nb">clear</span> IHn EQ Hr&#39;; <span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> = r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn n r (Z.pos a) &lt;&gt; Zgcdn m r (Z.pos a) -&gt;
fibonacci (S m) &lt;= Z.pos a /\ fibonacci (S (S m)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk51" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk51"><span class="highlight"><span class="nb">subst</span> r; <span class="nb">simpl</span>; <span class="nb">rewrite</span> Heqm.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn n <span class="mi">0</span> (Z.pos a) &lt;&gt; Zgcdn (S n) <span class="mi">0</span> (Z.pos a) -&gt;
fibonacci (S n) + fibonacci n &lt;= Z.pos a /\
fibonacci (S n) + fibonacci n + fibonacci (S n) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk52" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk52"><span class="highlight"><span class="nb">destruct</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = <span class="mi">1</span>%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn <span class="mi">0</span> <span class="mi">0</span> (Z.pos a) &lt;&gt; Zgcdn <span class="mi">1</span> <span class="mi">0</span> (Z.pos a) -&gt;
fibonacci <span class="mi">1</span> + fibonacci <span class="mi">0</span> &lt;= Z.pos a /\
fibonacci <span class="mi">1</span> + fibonacci <span class="mi">0</span> + fibonacci <span class="mi">1</span> &lt;= b</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk53" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk53"><hr></label><div class="goal-conclusion"><span class="highlight">Zgcdn (S n) <span class="mi">0</span> (Z.pos a) &lt;&gt; Zgcdn (S (S n)) <span class="mi">0</span> (Z.pos a) -&gt;
fibonacci (S (S n)) + fibonacci (S n) &lt;= Z.pos a /\
fibonacci (S (S n)) + fibonacci (S n) +
fibonacci (S (S n)) &lt;= b</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk54" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk54"><span class="highlight">+</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = <span class="mi">1</span>%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn <span class="mi">0</span> <span class="mi">0</span> (Z.pos a) &lt;&gt; Zgcdn <span class="mi">1</span> <span class="mi">0</span> (Z.pos a) -&gt;
fibonacci <span class="mi">1</span> + fibonacci <span class="mi">0</span> &lt;= Z.pos a /\
fibonacci <span class="mi">1</span> + fibonacci <span class="mi">0</span> + fibonacci <span class="mi">1</span> &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk55" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk55"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = <span class="mi">1</span>%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> &lt;&gt; Z.pos a -&gt; <span class="mi">2</span> &lt;= Z.pos a /\ <span class="mi">3</span> &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk56" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk56"><span class="highlight">+</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = S (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos a &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn (S n) <span class="mi">0</span> (Z.pos a) &lt;&gt; Zgcdn (S (S n)) <span class="mi">0</span> (Z.pos a) -&gt;
fibonacci (S (S n)) + fibonacci (S n) &lt;= Z.pos a /\
fibonacci (S (S n)) + fibonacci (S n) +
fibonacci (S (S n)) &lt;= b</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> <span class="mi">1</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
3b) We reformulate the previous result in a more positive way. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk57" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk57"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_ok_before_fibonacci</span> : <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span>,
   <span class="mi">0</span> &lt; a &lt; b -&gt; a &lt; fibonacci (S n) -&gt;
   Zis_gcd a b (Zgcdn n a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z),
<span class="mi">0</span> &lt; a &lt; b -&gt;
a &lt; fibonacci (S n) -&gt; Zis_gcd a b (Zgcdn n a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk58" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk58"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">a</span> <span class="nv">b</span> : Z),
<span class="mi">0</span> &lt; a &lt; b -&gt;
a &lt; fibonacci (S n) -&gt; Zis_gcd a b (Zgcdn n a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk59" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk59"><span class="highlight"><span class="nb">destruct</span> a; [ <span class="nb">destruct</span> <span class="mi">1</span>; <span class="nb">exfalso</span>; <span class="bp">omega</span> | | <span class="nb">destruct</span> <span class="mi">1</span>; <span class="bp">discriminate</span>].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk5a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk5a"><span class="highlight"><span class="nb">cut</span> (<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">n</span> <span class="nv">b</span>,
     k = (S (Pos.to_nat p) - n)%nat -&gt;
     <span class="mi">0</span> &lt; Zpos p &lt; b -&gt; Zpos p &lt; fibonacci (S n) -&gt;
     Zis_gcd (Zpos p) b (Zgcdn n (Zpos p) b)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">k</span> <span class="nv">n0</span> : nat) (<span class="nv">b</span> : Z),
 k = (S (Pos.to_nat p) - n0)%nat -&gt;
 <span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
 Z.pos p &lt; fibonacci (S n0) -&gt;
 Zis_gcd (Z.pos p) b (Zgcdn n0 (Z.pos p) b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : Z,
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk5b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk5b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> <span class="nv">n0</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n0 (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk5c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk5c"><span class="highlight"><span class="nb">destruct</span> <span class="mi">2</span>; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> <span class="nv">n0</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n0 (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk5d" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk5d"><span class="highlight"><span class="nb">clear</span> n; <span class="nb">induction</span> k.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
<span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk5e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk5e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk5f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk5f"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk60" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk60"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk61" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk61"><span class="highlight"><span class="nb">assert</span> (Pos.to_nat p &lt; n)%nat <span class="bp">by</span> <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.to_nat p &lt; n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk62" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk62"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk63" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk63"><span class="highlight"><span class="nb">apply</span> Zgcdn_linear_bound.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.to_nat p &lt; n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.abs (Z.pos p) &lt; Z.of_nat n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk64" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk64"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk65" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk65"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.to_nat p &lt; n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p &lt; Z.of_nat n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk66" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk66"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk67" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk67"><span class="highlight"><span class="nb">generalize</span> (inj_le _ _ H2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.to_nat p &lt; n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.of_nat (S (Pos.to_nat p)) &lt;= Z.of_nat n -&gt;
Z.pos p &lt; Z.of_nat n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk68" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk68"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk69" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk69"><span class="highlight"><span class="nb">rewrite</span> Nat2Z.inj_succ.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.to_nat p &lt; n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.succ (Z.of_nat (Pos.to_nat p)) &lt;= Z.of_nat n -&gt;
Z.pos p &lt; Z.of_nat n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk6a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk6a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk6b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk6b"><span class="highlight"><span class="nb">rewrite</span> positive_nat_Z; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span>%nat = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.to_nat p &lt; n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.succ (Z.pos p) &lt;= Z.of_nat n -&gt; Z.pos p &lt; Z.of_nat n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk6c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk6c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk6d" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk6d"><span class="highlight"><span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt; Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">b</span> : Z),
S k = (S (Pos.to_nat p) - n)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b -&gt;
Z.pos p &lt; fibonacci (S n) -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk6e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk6e"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk6f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk6f"><span class="highlight"><span class="nb">generalize</span> (Zgcdn_worst_is_fibonacci n (Zpos p) b H0); <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk70" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk70"><span class="highlight"><span class="nb">assert</span> (Zis_gcd (Zpos p) b (Zgcdn (S n) (Zpos p) b)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk71" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk71"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk72" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk72"><span class="highlight"><span class="nb">apply</span> IHk; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k = (S (Pos.to_nat p) - S n)%nat</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk73" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk73"><hr></label><div class="goal-conclusion"><span class="highlight">Z.pos p &lt; fibonacci (S (S n))</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk74" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk74"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk75" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk75"><span class="highlight"><span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p &lt; fibonacci (S (S n))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk76" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk76"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk77" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk77"><span class="highlight"><span class="nb">replace</span> (fibonacci (S (S n))) <span class="kr">with</span> (fibonacci (S n)+fibonacci n) <span class="bp">by</span> <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p &lt; fibonacci (S n) + fibonacci n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk78" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk78"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk79" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk79"><span class="highlight"><span class="nb">generalize</span> (fibonacci_pos n); <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7a"><span class="highlight"><span class="nb">replace</span> (Zgcdn n (Zpos p) b) <span class="kr">with</span> (Zgcdn (S n) (Zpos p) b); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHk</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">n0</span> : nat) (<span class="nv">b0</span> : Z),
k = (S (Pos.to_nat p) - n0)%nat -&gt;
<span class="mi">0</span> &lt; Z.pos p &lt; b0 -&gt;
Z.pos p &lt; fibonacci (S n0) -&gt; Zis_gcd (Z.pos p) b0 (Zgcdn n0 (Z.pos p) b0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S k = (S (Pos.to_nat p) - n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos p &lt; b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S n)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b) -&gt;
Zgcdn n (Z.pos p) b &lt;&gt; Zgcdn (S n) (Z.pos p) b -&gt;
fibonacci (S n) &lt;= Z.pos p /\
fibonacci (S (S n)) &lt;= b</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn (S n) (Z.pos p) b)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn (S n) (Z.pos p) b = Zgcdn n (Z.pos p) b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (H2 H3); <span class="nb">clear</span> H2 H3; <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
4) The proposed bound leads to a fibonacci number that is big enough. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcd_bound_fibonacci</span> :
   <span class="kr">forall</span> <span class="nv">a</span>, <span class="mi">0</span> &lt; a -&gt; a &lt; fibonacci (Zgcd_bound a).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : Z, <span class="mi">0</span> &lt; a -&gt; a &lt; fibonacci (Zgcd_bound a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : Z, <span class="mi">0</span> &lt; a -&gt; a &lt; fibonacci (Zgcd_bound a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7d" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7d"><span class="highlight"><span class="nb">destruct</span> a; [<span class="bp">omega</span>| | <span class="nb">intro</span> H; <span class="bp">discriminate</span>].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; Z.pos p -&gt;
Z.pos p &lt; fibonacci (Zgcd_bound (Z.pos p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7e"><span class="highlight"><span class="nb">intros</span> _.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p &lt; fibonacci (Zgcd_bound (Z.pos p))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk7f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk7f"><span class="highlight"><span class="nb">induction</span> p; [ | | <span class="nb">compute</span>; <span class="nb">auto</span> ];
    <span class="nb">simpl</span> Zgcd_bound <span class="kr">in</span> *;
    <span class="nb">rewrite</span> plus_comm; <span class="nb">simpl</span> plus;
    <span class="nb">set</span> (n:= (Pos.size_nat p+Pos.size_nat p)%nat) <span class="kr">in</span> *; <span class="nb">simpl</span>;
    <span class="nb">assert</span> (n &lt;&gt; O) <span class="bp">by</span> (<span class="nb">unfold</span> n; <span class="nb">destruct</span> p; <span class="nb">simpl</span>; <span class="nb">auto</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body"><span class="hyp-punct">:=</span><span class="highlight">(Pos.size_nat p + Pos.size_nat p)%nat</span></span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt;&gt; <span class="mi">0</span>%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p~<span class="mi">1</span> &lt;
<span class="kr">match</span> n <span class="kr">with</span>
| <span class="mi">0</span>%nat =&gt; <span class="mi">1</span>
| S n0 =&gt; fibonacci n + fibonacci n0
<span class="kr">end</span> + fibonacci n</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk80" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body"><span class="hyp-punct">:=</span><span class="highlight">(Pos.size_nat p + Pos.size_nat p)%nat</span></span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt;&gt; <span class="mi">0</span>%nat</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk80"><hr></label><div class="goal-conclusion"><span class="highlight">Z.pos p~<span class="mi">0</span> &lt;
<span class="kr">match</span> n <span class="kr">with</span>
| <span class="mi">0</span>%nat =&gt; <span class="mi">1</span>
| S n0 =&gt; fibonacci n + fibonacci n0
<span class="kr">end</span> + fibonacci n</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk81" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk81"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |m]; [<span class="nb">elim</span> H; <span class="nb">auto</span>| ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m &lt;&gt; <span class="mi">0</span>%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p~<span class="mi">1</span> &lt;
fibonacci (S m) + fibonacci m + fibonacci (S m)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk82" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body"><span class="hyp-punct">:=</span><span class="highlight">(Pos.size_nat p + Pos.size_nat p)%nat</span></span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt;&gt; <span class="mi">0</span>%nat</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk82"><hr></label><div class="goal-conclusion"><span class="highlight">Z.pos p~<span class="mi">0</span> &lt;
<span class="kr">match</span> n <span class="kr">with</span>
| <span class="mi">0</span>%nat =&gt; <span class="mi">1</span>
| S n0 =&gt; fibonacci n + fibonacci n0
<span class="kr">end</span> + fibonacci n</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk83" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk83"><span class="highlight"><span class="nb">generalize</span> (fibonacci_pos m); <span class="nb">rewrite</span> Pos2Z.inj_xI; <span class="bp">omega</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body"><span class="hyp-punct">:=</span><span class="highlight">(Pos.size_nat p + Pos.size_nat p)%nat</span></span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci n</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">n &lt;&gt; <span class="mi">0</span>%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p~<span class="mi">0</span> &lt;
<span class="kr">match</span> n <span class="kr">with</span>
| <span class="mi">0</span>%nat =&gt; <span class="mi">1</span>
| S n0 =&gt; fibonacci n + fibonacci n0
<span class="kr">end</span> + fibonacci n</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk84" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk84"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |m]; [<span class="nb">elim</span> H; <span class="nb">auto</span>| ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z.pos p &lt; fibonacci (S m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m &lt;&gt; <span class="mi">0</span>%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Z.pos p~<span class="mi">0</span> &lt;
fibonacci (S m) + fibonacci m + fibonacci (S m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (fibonacci_pos m); <span class="nb">rewrite</span> Pos2Z.inj_xO; <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
 <span class="c">(* 5) the end: we glue everything together and take care of</span>
<span class="c">    situations not corresponding to [0&lt;a&lt;b]. *)</span>

</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk85" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk85"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcd_bound_opp</span> <span class="nv">a</span> : Zgcd_bound (-a) = Zgcd_bound a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcd_bound (- a) = Zgcd_bound a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk86" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk86"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcd_bound (- a) = Zgcd_bound a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">destruct</span> a.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk87" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk87"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_opp</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span> : Zgcdn n (-a) b = Zgcdn n a b.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn n (- a) b = Zgcdn n a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk88" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk88"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zgcdn n (- a) b = Zgcdn n a b</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk89" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk89"><span class="highlight"><span class="nb">induction</span> n; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Zgcdn n (- a) b = Zgcdn n a b</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> - a <span class="kr">with</span>
| <span class="mi">0</span> =&gt; Z.abs b
| Z.pos _ =&gt; Zgcdn n (b mod - a) (- a)
| Z.neg a0 =&gt; Zgcdn n (b mod Z.pos a0) (Z.pos a0)
<span class="kr">end</span> =
<span class="kr">match</span> a <span class="kr">with</span>
| <span class="mi">0</span> =&gt; Z.abs b
| Z.pos _ =&gt; Zgcdn n (b mod a) a
| Z.neg a0 =&gt; Zgcdn n (b mod Z.pos a0) (Z.pos a0)
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> a; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_is_gcd_pos</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span> : (Zgcd_bound (Zpos a) &lt;= n)%nat -&gt;
   Zis_gcd (Zpos a) b (Zgcdn n (Zpos a) b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (Z.pos a) &lt;= n)%nat -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (Z.pos a) &lt;= n)%nat -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8c"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Zgcd_bound (Z.pos a) &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8d" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8d"><span class="highlight"><span class="nb">generalize</span> (Zgcd_bound_fibonacci (Zpos a)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Zgcd_bound (Z.pos a) &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt;
 Z.pos a &lt; fibonacci (Zgcd_bound (Z.pos a))) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8e"><span class="highlight"><span class="nb">simpl</span> Zgcd_bound <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Pos.size_nat a + Pos.size_nat a &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt;
 Z.pos a &lt; fibonacci (Pos.size_nat a + Pos.size_nat a)) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk8f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk8f"><span class="highlight"><span class="nb">remember</span> (Pos.size_nat a+Pos.size_nat a)%nat <span class="kr">as</span> m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci m) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk90" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk90"><span class="highlight"><span class="nb">assert</span> (<span class="mi">1</span> &lt; m)%nat.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> &lt; m)%nat</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk91" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m &lt;= n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; m)%nat</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk91"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci m) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk92" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk92"><span class="highlight">{</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> &lt; m)%nat</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> Heqm; <span class="nb">destruct</span> a; <span class="nb">simpl</span>; <span class="nb">rewrite</span> <span class="mi">1</span>?plus_comm;
    <span class="nb">auto with</span> arith.</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk93" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk93"><span class="highlight">}</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(m &lt;= n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; m)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci m) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk94" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk94"><span class="highlight"><span class="nb">destruct</span> m <span class="kr">as</span> [ |m]; [<span class="nb">inversion</span> H0; <span class="nb">auto</span>| ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk95" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk95"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |n]; [<span class="nb">inversion</span> H; <span class="nb">auto</span>| ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn (S n) (Z.pos a) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk96" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk96"><span class="highlight"><span class="nb">simpl</span> Zgcdn.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)) -&gt;
Zis_gcd (Z.pos a) b
  (Zgcdn n (b mod Z.pos a) (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk97" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk97"><span class="highlight"><span class="nb">unfold</span> Z.modulo.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)) -&gt;
Zis_gcd (Z.pos a) b
  (Zgcdn n (<span class="kr">let</span> (<span class="nv">_</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span> r)
     (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk98" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk98"><span class="highlight"><span class="nb">generalize</span> (Z_div_mod b (Zpos a) (eq_refl Gt)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">let</span> (<span class="nv">q</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span>
 b = Z.pos a * q + r /\ <span class="mi">0</span> &lt;= r &lt; Z.pos a) -&gt;
(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)) -&gt;
Zis_gcd (Z.pos a) b
  (Zgcdn n (<span class="kr">let</span> (<span class="nv">_</span>, r) := Z.div_eucl b (Z.pos a) <span class="kr">in</span> r)
     (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk99" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk99"><span class="highlight"><span class="nb">destruct</span> (Z.div_eucl b (Zpos a)) <span class="kr">as</span> (q,r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b = Z.pos a * q + r /\ <span class="mi">0</span> &lt;= r &lt; Z.pos a -&gt;
(<span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)) -&gt;
Zis_gcd (Z.pos a) b (Zgcdn n r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk9a" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk9a"><span class="highlight"><span class="nb">intros</span> (-&gt;,(H1,H2)) H3.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos a) (Z.pos a * q + r)
  (Zgcdn n r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk9b" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk9b"><span class="highlight"><span class="nb">apply</span> Zis_gcd_for_euclid2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt;= r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn n r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk9c" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk9c"><span class="highlight">Z.le_elim H1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn n r (Z.pos a))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chk9d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> = r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chk9d"><hr></label><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn n r (Z.pos a))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk9e" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk9e"><span class="highlight">+</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn n r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chk9f" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chk9f"><span class="highlight"><span class="nb">apply</span> Zgcdn_ok_before_fibonacci; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">r &lt; fibonacci (S n)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Z.lt_le_trans <span class="kr">with</span> (fibonacci (S m));
    [ <span class="bp">omega</span> | <span class="nb">apply</span> fibonacci_incr; <span class="nb">auto</span>].</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka0" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka0"><span class="highlight">+</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q, r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> = r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">r &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd r (Z.pos a) (Zgcdn n r (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka1" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka1"><span class="highlight"><span class="nb">subst</span> r; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S m = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S m &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S m)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S m)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd <span class="mi">0</span> (Z.pos a) (Zgcdn n <span class="mi">0</span> (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka2" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka2"><span class="highlight"><span class="nb">destruct</span> m <span class="kr">as</span> [ |m]; [<span class="nb">exfalso</span>; <span class="bp">omega</span>| ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S (S m) = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S (S m) &lt;= S n)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S (S m))%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S (S m))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd <span class="mi">0</span> (Z.pos a) (Zgcdn n <span class="mi">0</span> (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka3" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka3"><span class="highlight"><span class="nb">destruct</span> n <span class="kr">as</span> [ |n]; [<span class="nb">exfalso</span>; <span class="bp">omega</span>| ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">S (S m) = (Pos.size_nat a + Pos.size_nat a)%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(S (S m) &lt;= S (S n))%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt; S (S m))%nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="mi">0</span> &lt; Z.pos a -&gt; Z.pos a &lt; fibonacci (S (S m))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd <span class="mi">0</span> (Z.pos a) (Zgcdn (S n) <span class="mi">0</span> (Z.pos a))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">apply</span> Zis_gcd_sym; <span class="nb">apply</span> Zis_gcd_0.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka4" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcdn_is_gcd</span> <span class="nv">n</span> <span class="nv">a</span> <span class="nv">b</span> :
   (Zgcd_bound a &lt;= n)%nat -&gt; Zis_gcd a b (Zgcdn n a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound a &lt;= n)%nat -&gt; Zis_gcd a b (Zgcdn n a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka5" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound a &lt;= n)%nat -&gt; Zis_gcd a b (Zgcdn n a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka6" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka6"><span class="highlight"><span class="nb">destruct</span> a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound <span class="mi">0</span> &lt;= n)%nat -&gt; Zis_gcd <span class="mi">0</span> b (Zgcdn n <span class="mi">0</span> b)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chka7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chka7"><hr></label><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (Z.pos p) &lt;= n)%nat -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote><input class="coq-extra-goal-toggle" id="Zgcd-alt-v-chka8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Zgcd-alt-v-chka8"><hr></label><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (Z.neg p) &lt;= n)%nat -&gt;
Zis_gcd (Z.neg p) b (Zgcdn n (Z.neg p) b)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chka9" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chka9"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound <span class="mi">0</span> &lt;= n)%nat -&gt; Zis_gcd <span class="mi">0</span> b (Zgcdn n <span class="mi">0</span> b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkaa" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkaa"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd <span class="mi">0</span> b (Zgcdn n <span class="mi">0</span> b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkab" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkab"><span class="highlight"><span class="nb">destruct</span> n; [<span class="nb">exfalso</span>; <span class="bp">omega</span> | ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="mi">1</span> &lt;= S n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd <span class="mi">0</span> b (Zgcdn (S n) <span class="mi">0</span> b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">generalize</span> (Zis_gcd_0_abs b); <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkac" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkac"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (Z.pos p) &lt;= n)%nat -&gt;
Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Zgcdn_is_gcd_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkad" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkad"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (Z.neg p) &lt;= n)%nat -&gt;
Zis_gcd (Z.neg p) b (Zgcdn n (Z.neg p) b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkae" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkae"><span class="highlight"><span class="nb">rewrite</span> &lt;- Zgcd_bound_opp, &lt;- Zgcdn_opp.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Zgcd_bound (- Z.neg p) &lt;= n)%nat -&gt;
Zis_gcd (Z.neg p) b (Zgcdn n (- Z.neg p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkaf" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkaf"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Zgcd_bound (- Z.neg p) &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.neg p) b (Zgcdn n (- Z.neg p) b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkb0" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkb0"><span class="highlight"><span class="nb">apply</span> Zis_gcd_minus, Zis_gcd_sym.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Zgcd_bound (- Z.neg p) &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (- Z.neg p) b (Zgcdn n (- Z.neg p) b)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkb1" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkb1"><span class="highlight"><span class="nb">simpl</span> Z.opp.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">nat</span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">positive</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Z</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(Zgcd_bound (- Z.neg p) &lt;= n)%nat</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Zis_gcd (Z.pos p) b (Zgcdn n (Z.pos p) b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">     </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">now</span> <span class="nb">apply</span> Zgcdn_is_gcd_pos.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkb2" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkb2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Zgcd_is_gcd</span> :
   <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span>, Zis_gcd a b (Zgcd_alt a b).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, Zis_gcd a b (Zgcd_alt a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="Zgcd-alt-v-chkb3" style="display: none" type="checkbox"><label class="coq-input" for="Zgcd-alt-v-chkb3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : Z, Zis_gcd a b (Zgcd_alt a b)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> Zgcd_alt; <span class="nb">intros</span>; <span class="nb">apply</span> Zgcdn_is_gcd; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></article></body></html>