<!DOCTYPE html>
<html><head><title>FMapAVL.v</title><meta charset="utf-8"><meta content="Alectryon v0.2" name="generator"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"><link href="https://unpkg.com/firacode/distr/fira_code.css" rel="stylesheet"><link href="alectryon.css" rel="stylesheet"><script src="alectryon.js"></script><style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-standalone alectryon-centered alectryon-coqdoc"><div class="alectryon-header">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running <a href="https://coq.inria.fr/">Coq</a>+<a href="https://github.com/ejgallego/coq-serapi">SerAPI</a> v8.10.0+0.7.0. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight"><span class="sd">(************************************************************************)</span>
<span class="c">(*         *   The Coq Proof Assistant / The Coq Development Team       *)</span>
<span class="c">(*  v      *   INRIA, CNRS and contributors - Copyright 1999-2018       *)</span>
<span class="c">(* &lt;O___,, *       (see CREDITS file for the list of authors)           *)</span>
<span class="c">(*   \VV/  **************************************************************)</span>
<span class="c">(*    //   *    This file is distributed under the terms of the         *)</span>
<span class="c">(*         *     GNU Lesser General Public License Version 2.1          *)</span>
<span class="c">(*         *     (see LICENSE file for the text of the license)         *)</span>
<span class="sd">(************************************************************************)</span>

<span class="c">(* Finite map library.  *)</span></span></span></pre><div class="doc">
<a name="lab1"></a><h1 class="section">FMapAVL</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
This module implements maps using AVL trees.
    It follows the implementation from Ocaml's standard library.

<div class="paragraph"> </div>

    See the comments at the beginning of FSetAVL for more details.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span> FunInd FMapInterface FMapList ZArith Int.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Set Implicit Arguments</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Unset Strict Implicit</span>.</span></span></span></pre><div class="doc">
Notations and helper lemma about pairs 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Declare Scope</span> pair_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;s #1&quot;</span> := (fst s) (<span class="kn">at level</span> <span class="mi">9</span>, <span class="kn">format</span> <span class="s2">&quot;s &#39;#1&#39;&quot;</span>) : pair_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;s #2&quot;</span> := (snd s) (<span class="kn">at level</span> <span class="mi">9</span>, <span class="kn">format</span> <span class="s2">&quot;s &#39;#2&#39;&quot;</span>) : pair_scope.</span></span></span></pre><div class="doc">
<a name="lab2"></a><h1 class="section">The Raw functor</h1>
<div class="paragraph"> </div>

   Functor of pure functions + separate proofs of invariant
   preservation 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Raw</span> (<span class="kn">Import</span> I:Int)(X: OrderedType).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Open Scope</span> pair_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Open Scope</span> lazy_bool_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Local Open Scope</span> Int_scope.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">int</span> := I.t.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">key</span> := X.t.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Transparent</span> key : core.</span></span></span></pre><div class="doc">
<a name="lab3"></a><h1 class="section">Trees</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<a name="lab4"></a><h1 class="section">Trees</h1>
<div class="paragraph"> </div>

   The fifth field of <span class="inlinecode"><span class="id" title="var">Node</span></span> is the height of the tree 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight">#[universes(template)]
<span class="kn">Inductive</span> <span class="nf">tree</span> {<span class="nv">elt</span> : <span class="kt">Type</span>} :=
  | Leaf : tree
  | Node : tree -&gt; key -&gt; elt -&gt; tree -&gt; int -&gt; tree.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Arguments</span> tree : <span class="kn">clear implicits</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Elt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">t</span> := (tree elt).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Implicit Types</span> <span class="nv">m</span> : t.</span></span></span></pre><div class="doc">
<a name="lab5"></a><h1 class="section">Basic functions on trees: height and cardinal</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">height</span> (<span class="nv">m</span> : t) : int :=
  <span class="kr">match</span> m <span class="kr">with</span>
  | Leaf =&gt; <span class="mi">0</span>
  | Node _ _ _ _ h =&gt; h
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">cardinal</span> (<span class="nv">m</span> : t) : nat :=
  <span class="kr">match</span> m <span class="kr">with</span>
   | Leaf =&gt; <span class="mi">0</span>%nat
   | Node l _ _ r _ =&gt; S (cardinal l + cardinal r)
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab6"></a><h1 class="section">Empty Map</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">empty</span> : t := Leaf.</span></span></span></pre><div class="doc">
<a name="lab7"></a><h1 class="section">Emptyness test</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">is_empty</span> <span class="nv">m</span> := <span class="kr">match</span> m <span class="kr">with</span> Leaf =&gt; true | _ =&gt; false <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab8"></a><h1 class="section">Membership</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
The <span class="inlinecode"><span class="id" title="var">mem</span></span> function is deciding membership. It exploits the <span class="inlinecode"><span class="id" title="var">bst</span></span> property
    to achieve logarithmic complexity. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">mem</span> <span class="nv">x</span> <span class="nv">m</span> : bool :=
   <span class="kr">match</span> m <span class="kr">with</span>
     |  Leaf =&gt; false
     |  Node l y _ r _ =&gt; <span class="kr">match</span> X.<span class="nb">compare</span> x y <span class="kr">with</span>
             | LT _ =&gt; mem x l
             | EQ _ =&gt; true
             | GT _ =&gt; mem x r
         <span class="kr">end</span>
   <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">find</span> <span class="nv">x</span> <span class="nv">m</span> : option elt :=
   <span class="kr">match</span> m <span class="kr">with</span>
     |  Leaf =&gt; None
     |  Node l y d r _ =&gt; <span class="kr">match</span> X.<span class="nb">compare</span> x y <span class="kr">with</span>
             | LT _ =&gt; find x l
             | EQ _ =&gt; Some d
             | GT _ =&gt; find x r
         <span class="kr">end</span>
   <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab9"></a><h1 class="section">Helper functions</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">create</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> creates a node, assuming <span class="inlinecode"><span class="id" title="var">l</span></span> and <span class="inlinecode"><span class="id" title="var">r</span></span>
    to be balanced and <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">r</span>|</span> <span class="inlinecode">‚â§</span> <span class="inlinecode">2</span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">create</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> :=
   Node l x e r (max (height l) (height r) + <span class="mi">1</span>).</span></span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">bal</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> acts as <span class="inlinecode"><span class="id" title="var">create</span></span>, but performs one step of
    rebalancing if necessary, i.e. assumes <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">r</span>|</span> <span class="inlinecode">‚â§</span> <span class="inlinecode">3</span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">assert_false</span> := create.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">bal</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">r</span> :=
  <span class="kr">let</span> <span class="nv">hl</span> := height l <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">hr</span> := height r <span class="kr">in</span>
  <span class="kr">if</span> gt_le_dec hl (hr+<span class="mi">2</span>) <span class="kr">then</span>
    <span class="kr">match</span> l <span class="kr">with</span>
     | Leaf =&gt; assert_false l x d r
     | Node ll lx ld lr _ =&gt;
       <span class="kr">if</span> ge_lt_dec (height ll) (height lr) <span class="kr">then</span>
         create ll lx ld (create lr x d r)
       <span class="kr">else</span>
         <span class="kr">match</span> lr <span class="kr">with</span>
          | Leaf =&gt; assert_false l x d r
          | Node lrl lrx lrd lrr _ =&gt;
              create (create ll lx ld lrl) lrx lrd (create lrr x d r)
         <span class="kr">end</span>
    <span class="kr">end</span>
  <span class="kr">else</span>
    <span class="kr">if</span> gt_le_dec hr (hl+<span class="mi">2</span>) <span class="kr">then</span>
      <span class="kr">match</span> r <span class="kr">with</span>
       | Leaf =&gt; assert_false l x d r
       | Node rl rx rd rr _ =&gt;
         <span class="kr">if</span> ge_lt_dec (height rr) (height rl) <span class="kr">then</span>
            create (create l x d rl) rx rd rr
         <span class="kr">else</span>
           <span class="kr">match</span> rl <span class="kr">with</span>
            | Leaf =&gt; assert_false l x d r
            | Node rll rlx rld rlr _ =&gt;
                create (create l x d rll) rlx rld (create rlr rx rd rr)
           <span class="kr">end</span>
      <span class="kr">end</span>
    <span class="kr">else</span>
      create l x d r.</span></span></span></pre><div class="doc">
<a name="lab10"></a><h1 class="section">Insertion</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">add</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">m</span> :=
  <span class="kr">match</span> m <span class="kr">with</span>
   | Leaf =&gt; Node Leaf x d Leaf <span class="mi">1</span>
   | Node l y d&#39; r h =&gt;
      <span class="kr">match</span> X.<span class="nb">compare</span> x y <span class="kr">with</span>
         | LT _ =&gt; bal (add x d l) y d&#39; r
         | EQ _ =&gt; Node l y d r h
         | GT _ =&gt; bal l y d&#39; (add x d r)
      <span class="kr">end</span>
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab11"></a><h1 class="section">Extraction of minimum binding</h1>
<div class="paragraph"> </div>

  Morally, <span class="inlinecode"><span class="id" title="var">remove_min</span></span> is to be applied to a non-empty tree
  <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Node</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span>. Since we can't deal here with <span class="inlinecode"><span class="id" title="tactic">assert</span></span> <span class="inlinecode"><span class="id" title="var">false</span></span>
  for <span class="inlinecode"><span class="id" title="var">t</span>=<span class="id" title="var">Leaf</span></span>, we pre-unpack <span class="inlinecode"><span class="id" title="var">t</span></span> (and forget about <span class="inlinecode"><span class="id" title="var">h</span></span>).

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">remove_min</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">r</span> : t*(key*elt) :=
  <span class="kr">match</span> l <span class="kr">with</span>
    | Leaf =&gt; (r,(x,d))
    | Node ll lx ld lr lh =&gt;
       <span class="kr">let</span> (<span class="nv">l&#39;</span>,m) := remove_min ll lx ld lr <span class="kr">in</span>
       (bal l&#39; x d r, m)
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab12"></a><h1 class="section">Merging two trees</h1>
<div class="paragraph"> </div>
<span class="inlinecode"><span class="id" title="var">merge</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode"><span class="id" title="var">t2</span></span> builds the union of <span class="inlinecode"><span class="id" title="var">t1</span></span> and <span class="inlinecode"><span class="id" title="var">t2</span></span> assuming all elements
  of <span class="inlinecode"><span class="id" title="var">t1</span></span> to be smaller than all elements of <span class="inlinecode"><span class="id" title="var">t2</span></span>, and
  <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">t2</span>|</span> <span class="inlinecode">‚â§</span> <span class="inlinecode">2</span>.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">merge</span> <span class="nv">s1</span> <span class="nv">s2</span> :=  <span class="kr">match</span> s1,s2 <span class="kr">with</span>
  | Leaf, _ =&gt; s2
  | _, Leaf =&gt; s1
  | _, Node l2 x2 d2 r2 h2 =&gt;
    <span class="kr">match</span> remove_min l2 x2 d2 r2 <span class="kr">with</span>
      (s2&#39;,(x,d)) =&gt; bal s1 x d s2&#39;
    <span class="kr">end</span>
<span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab13"></a><h1 class="section">Deletion</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">remove</span> <span class="nv">x</span> <span class="nv">m</span> := <span class="kr">match</span> m <span class="kr">with</span>
  | Leaf =&gt; Leaf
  | Node l y d r h =&gt;
      <span class="kr">match</span> X.<span class="nb">compare</span> x y <span class="kr">with</span>
         | LT _ =&gt; bal (remove x l) y d r
         | EQ _ =&gt; merge l r
         | GT _ =&gt; bal l y d (remove x r)
      <span class="kr">end</span>
   <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab14"></a><h1 class="section">join</h1>
<div class="paragraph"> </div>

    Same as <span class="inlinecode"><span class="id" title="var">bal</span></span> but does not assume anything regarding heights of <span class="inlinecode"><span class="id" title="var">l</span></span>
    and <span class="inlinecode"><span class="id" title="var">r</span></span>.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">join</span> <span class="nv">l</span> : key -&gt; elt -&gt; t -&gt; t :=
  <span class="kr">match</span> l <span class="kr">with</span>
    | Leaf =&gt; add
    | Node ll lx ld lr lh =&gt; <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">d</span> =&gt;
       <span class="kr">fix</span> join_aux (r:t) : t := <span class="kr">match</span> r <span class="kr">with</span>
          | Leaf =&gt;  add x d l
          | Node rl rx rd rr rh =&gt;
               <span class="kr">if</span> gt_le_dec lh (rh+<span class="mi">2</span>) <span class="kr">then</span> bal ll lx ld (join lr x d r)
               <span class="kr">else</span> <span class="kr">if</span> gt_le_dec rh (lh+<span class="mi">2</span>) <span class="kr">then</span> bal (join_aux rl) rx rd rr
               <span class="kr">else</span> create l x d r
          <span class="kr">end</span>
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab15"></a><h1 class="section">Splitting</h1>
<div class="paragraph"> </div>
<span class="inlinecode"><span class="id" title="tactic">split</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> returns a triple <span class="inlinecode">(<span class="id" title="var">l</span>,</span> <span class="inlinecode"><span class="id" title="var">o</span>,</span> <span class="inlinecode"><span class="id" title="var">r</span>)</span> where
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">l</span></span> is the set of elements of <span class="inlinecode"><span class="id" title="var">m</span></span> that are <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>
</li>
<li> <span class="inlinecode"><span class="id" title="var">r</span></span> is the set of elements of <span class="inlinecode"><span class="id" title="var">m</span></span> that are <span class="inlinecode">&gt;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>
</li>
<li> <span class="inlinecode"><span class="id" title="var">o</span></span> is the result of <span class="inlinecode"><span class="id" title="var">find</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span>.

</li>
</ul>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Record</span> <span class="nf">triple</span> := mktriple { t_left:t; t_opt:option elt; t_right:t }.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;&lt;&lt; l , b , r &gt;&gt;&quot;</span> := (mktriple l b r) (<span class="kn">at level</span> <span class="mi">9</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">split</span> <span class="nv">x</span> <span class="nv">m</span> : triple := <span class="kr">match</span> m <span class="kr">with</span>
  | Leaf =&gt; &lt;&lt; Leaf, None, Leaf &gt;&gt;
  | Node l y d r h =&gt;
     <span class="kr">match</span> X.<span class="nb">compare</span> x y <span class="kr">with</span>
      | LT _ =&gt; <span class="kr">let</span> (<span class="nv">ll</span>,o,rl) := <span class="nb">split</span> x l <span class="kr">in</span> &lt;&lt; ll, o, join rl y d r &gt;&gt;
      | EQ _ =&gt; &lt;&lt; l, Some d, r &gt;&gt;
      | GT _ =&gt; <span class="kr">let</span> (<span class="nv">rl</span>,o,rr) := <span class="nb">split</span> x r <span class="kr">in</span> &lt;&lt; join l y d rl, o, rr &gt;&gt;
     <span class="kr">end</span>
 <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab16"></a><h1 class="section">Concatenation</h1>
<div class="paragraph"> </div>

   Same as <span class="inlinecode"><span class="id" title="var">merge</span></span> but does not assume anything about heights.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">concat</span> <span class="nv">m1</span> <span class="nv">m2</span> :=
   <span class="kr">match</span> m1, m2 <span class="kr">with</span>
      | Leaf, _ =&gt; m2
      | _ , Leaf =&gt; m1
      | _, Node l2 x2 d2 r2 _ =&gt;
            <span class="kr">let</span> (<span class="nv">m2&#39;</span>,xd) := remove_min l2 x2 d2 r2 <span class="kr">in</span>
            join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;
   <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab17"></a><h1 class="section">Elements</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">elements_tree_aux</span></span> <span class="inlinecode"><span class="id" title="var">acc</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> catenates the elements of <span class="inlinecode"><span class="id" title="var">t</span></span> in infix
    order to the list <span class="inlinecode"><span class="id" title="var">acc</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">elements_aux</span> (<span class="nv">acc</span> : list (key*elt)) <span class="nv">m</span> : list (key*elt) :=
  <span class="kr">match</span> m <span class="kr">with</span>
   | Leaf =&gt; acc
   | Node l x d r _ =&gt; elements_aux ((x,d) :: elements_aux acc r) l
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
then <span class="inlinecode"><span class="id" title="var">elements</span></span> is an instantiation with an empty <span class="inlinecode"><span class="id" title="var">acc</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">elements</span> := elements_aux nil.</span></span></span></pre><div class="doc">
<a name="lab18"></a><h1 class="section">Fold</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">fold</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">m</span> : t) : A -&gt; A :=
 <span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="kr">match</span> m <span class="kr">with</span>
  | Leaf =&gt; a
  | Node l x d r _ =&gt; <span class="nb">fold</span> f r (f x d (<span class="nb">fold</span> f l a))
 <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab19"></a><h1 class="section">Comparison</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">cmp</span> : elt-&gt;elt-&gt;bool.</span></span></span></pre><div class="doc">
<a name="lab20"></a><h2 class="section">Enumeration of the elements of a tree</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">enumeration</span> :=
 | <span class="kn">End</span> : enumeration
 | More : key -&gt; elt -&gt; t -&gt; enumeration -&gt; enumeration.</span></span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">cons</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> adds the elements of tree <span class="inlinecode"><span class="id" title="var">m</span></span> on the head of
    enumeration <span class="inlinecode"><span class="id" title="var">e</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">cons</span> <span class="nv">m</span> <span class="nv">e</span> : enumeration :=
 <span class="kr">match</span> m <span class="kr">with</span>
  | Leaf =&gt; e
  | Node l x d r h =&gt; cons l (More x d r e)
 <span class="kr">end</span>.</span></span></span></pre><div class="doc">
One step of comparison of elements 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equal_more</span> <span class="nv">x1</span> <span class="nv">d1</span> (<span class="nv">cont</span>:enumeration-&gt;bool) <span class="nv">e2</span> :=
 <span class="kr">match</span> e2 <span class="kr">with</span>
 | <span class="kn">End</span> =&gt; false
 | More x2 d2 r2 e2 =&gt;
     <span class="kr">match</span> X.<span class="nb">compare</span> x1 x2 <span class="kr">with</span>
      | EQ _ =&gt; cmp d1 d2 &amp;&amp;&amp; cont (cons r2 e2)
      | _ =&gt; false
     <span class="kr">end</span>
 <span class="kr">end</span>.</span></span></span></pre><div class="doc">
Comparison of left tree, middle element, then right tree 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">equal_cont</span> <span class="nv">m1</span> (<span class="nv">cont</span>:enumeration-&gt;bool) <span class="nv">e2</span> :=
 <span class="kr">match</span> m1 <span class="kr">with</span>
  | Leaf =&gt; cont e2
  | Node l1 x1 d1 r1 _ =&gt;
     equal_cont l1 (equal_more x1 d1 (equal_cont r1 cont)) e2
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
Initial continuation 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equal_end</span> <span class="nv">e2</span> := <span class="kr">match</span> e2 <span class="kr">with</span> <span class="kn">End</span> =&gt; true | _ =&gt; false <span class="kr">end</span>.</span></span></span></pre><div class="doc">
The complete comparison 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equal</span> <span class="nv">m1</span> <span class="nv">m2</span> := equal_cont m1 equal_end (cons m2 <span class="kn">End</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Elt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">t</span> := tree.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Arguments</span> Leaf : <span class="kn">clear implicits</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Arguments</span> Node [elt].</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;&lt;&lt; l , b , r &gt;&gt;&quot;</span> := (mktriple l b r) (<span class="kn">at level</span> <span class="mi">9</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;t #l&quot;</span> := (t_left t) (<span class="kn">at level</span> <span class="mi">9</span>, <span class="kn">format</span> <span class="s2">&quot;t &#39;#l&#39;&quot;</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;t #o&quot;</span> := (t_opt t) (<span class="kn">at level</span> <span class="mi">9</span>, <span class="kn">format</span> <span class="s2">&quot;t &#39;#o&#39;&quot;</span>).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;t #r&quot;</span> := (t_right t) (<span class="kn">at level</span> <span class="mi">9</span>, <span class="kn">format</span> <span class="s2">&quot;t &#39;#r&#39;&quot;</span>).</span></span></span></pre><div class="doc">
<a name="lab21"></a><h1 class="section">Map</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">map</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>)(<span class="nv">f</span> : elt -&gt; elt&#39;)(<span class="nv">m</span> : t elt) : t elt&#39; :=
  <span class="kr">match</span> m <span class="kr">with</span>
   | Leaf _   =&gt; Leaf _
   | Node l x d r h =&gt; Node (map f l) x (f d) (map f r) h
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
<span class="c">(* * Mapi *)</span>

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">mapi</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>)(<span class="nv">f</span> : key -&gt; elt -&gt; elt&#39;)(<span class="nv">m</span> : t elt) : t elt&#39; :=
  <span class="kr">match</span> m <span class="kr">with</span>
   | Leaf _ =&gt; Leaf _
   | Node l x d r h =&gt; Node (mapi f l) x (f x d) (mapi f r) h
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab22"></a><h1 class="section">Map with removal</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">map_option</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>)(<span class="nv">f</span> : key -&gt; elt -&gt; option elt&#39;)(<span class="nv">m</span> : t elt)
  : t elt&#39; :=
  <span class="kr">match</span> m <span class="kr">with</span>
   | Leaf _ =&gt; Leaf _
   | Node l x d r h =&gt;
      <span class="kr">match</span> f x d <span class="kr">with</span>
       | Some d&#39; =&gt; join (map_option f l) x d&#39; (map_option f r)
       | None =&gt; concat (map_option f l) (map_option f r)
      <span class="kr">end</span>
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
<a name="lab23"></a><h1 class="section">Optimized map2</h1>
<div class="paragraph"> </div>

  Suggestion by B. Gregoire: a <span class="inlinecode"><span class="id" title="var">map2</span></span> function with specialized
  arguments that allows bypassing some tree traversal. Instead of one
  <span class="inlinecode"><span class="id" title="var">f0</span></span> of type <span class="inlinecode"><span class="id" title="var">key</span></span> <span class="inlinecode">‚Üí</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">elt</span></span> <span class="inlinecode">‚Üí</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">elt'</span></span> <span class="inlinecode">‚Üí</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">elt''</span></span>,
  we ask here for:
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">f</span></span> which is a specialisation of <span class="inlinecode"><span class="id" title="var">f0</span></span> when first option isn't <span class="inlinecode"><span class="id" title="var">None</span></span>
</li>
<li> <span class="inlinecode"><span class="id" title="var">mapl</span></span> treats a <span class="inlinecode"><span class="id" title="var">tree</span></span> <span class="inlinecode"><span class="id" title="var">elt</span></span> with <span class="inlinecode"><span class="id" title="var">f0</span></span> when second option is <span class="inlinecode"><span class="id" title="var">None</span></span>
</li>
<li> <span class="inlinecode"><span class="id" title="var">mapr</span></span> treats a <span class="inlinecode"><span class="id" title="var">tree</span></span> <span class="inlinecode"><span class="id" title="var">elt'</span></span> with <span class="inlinecode"><span class="id" title="var">f0</span></span> when first option is <span class="inlinecode"><span class="id" title="var">None</span></span>
</li>
</ul>
<div class="paragraph"> </div>

  The idea is that <span class="inlinecode"><span class="id" title="var">mapl</span></span> and <span class="inlinecode"><span class="id" title="var">mapr</span></span> can be instantaneous (e.g.
  the identity or some constant function).

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Map2_opt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">mapl</span> : t elt -&gt; t elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">mapr</span> : t elt&#39; -&gt; t elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">map2_opt</span> <span class="nv">m1</span> <span class="nv">m2</span> :=
 <span class="kr">match</span> m1, m2 <span class="kr">with</span>
  | Leaf _, _ =&gt; mapr m2
  | _, Leaf _ =&gt; mapl m1
  | Node l1 x1 d1 r1 h1, _ =&gt;
     <span class="kr">let</span> (<span class="nv">l2&#39;</span>,o2,r2&#39;) := <span class="nb">split</span> x1 m2 <span class="kr">in</span>
     <span class="kr">match</span> f x1 d1 o2 <span class="kr">with</span>
      | Some e =&gt; join (map2_opt l1 l2&#39;) x1 e (map2_opt r1 r2&#39;)
      | None =&gt; concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;)
     <span class="kr">end</span>
 <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Map2_opt</span>.</span></span></span></pre><div class="doc">
<a name="lab24"></a><h1 class="section">Map2</h1>
<div class="paragraph"> </div>

    The <span class="inlinecode"><span class="id" title="var">map2</span></span> function of the Map interface can be implemented
    via <span class="inlinecode"><span class="id" title="var">map2_opt</span></span> and <span class="inlinecode"><span class="id" title="var">map_option</span></span>.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Map2</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map2</span> : t elt -&gt; t elt&#39; -&gt; t elt&#39;&#39; :=
 map2_opt
   (<span class="kr">fun</span> <span class="nv">_</span> <span class="nv">d</span> <span class="nv">o</span> =&gt; f (Some d) o)
   (map_option (<span class="kr">fun</span> <span class="nv">_</span> <span class="nv">d</span> =&gt; f (Some d) None))
   (map_option (<span class="kr">fun</span> <span class="nv">_</span> <span class="nv">d&#39;</span> =&gt; f None (Some d&#39;))).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Map2</span>.</span></span></span></pre><div class="doc">
<a name="lab25"></a><h1 class="section">Invariants</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Invariants</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> : <span class="kt">Type</span>.</span></span></span></pre><div class="doc">
<a name="lab26"></a><h2 class="section">Occurrence in a tree</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">MapsTo</span> (<span class="nv">x</span> : key)(<span class="nv">e</span> : elt) : t elt -&gt; <span class="kt">Prop</span> :=
  | MapsRoot : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span>,
      X.eq x y -&gt; MapsTo x e (Node l y e r h)
  | MapsLeft : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span> <span class="nv">e&#39;</span>,
      MapsTo x e l -&gt; MapsTo x e (Node l y e&#39; r h)
  | MapsRight : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span> <span class="nv">e&#39;</span>,
      MapsTo x e r -&gt; MapsTo x e (Node l y e&#39; r h).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">In</span> (<span class="nv">x</span> : key) : t elt -&gt; <span class="kt">Prop</span> :=
  | InRoot : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span> <span class="nv">e</span>,
      X.eq x y -&gt; In x (Node l y e r h)
  | InLeft : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span> <span class="nv">e&#39;</span>,
      In x l -&gt; In x (Node l y e&#39; r h)
  | InRight : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span> <span class="nv">e&#39;</span>,
      In x r -&gt; In x (Node l y e&#39; r h).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">In0</span> <span class="nv">k</span> <span class="nv">m</span> := <span class="kr">exists</span> <span class="nv">e</span>:elt, MapsTo k e m.</span></span></span></pre><div class="doc">
<a name="lab27"></a><h2 class="section">Binary search trees</h2>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">lt_tree</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span>: all elements in <span class="inlinecode"><span class="id" title="var">s</span></span> are smaller than <span class="inlinecode"><span class="id" title="var">x</span></span>
   (resp. greater for <span class="inlinecode"><span class="id" title="var">gt_tree</span></span>) 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lt_tree</span> <span class="nv">x</span> <span class="nv">m</span> := <span class="kr">forall</span> <span class="nv">y</span>, In y m -&gt; X.lt y x.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">gt_tree</span> <span class="nv">x</span> <span class="nv">m</span> := <span class="kr">forall</span> <span class="nv">y</span>, In y m -&gt; X.lt x y.</span></span></span></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">bst</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> : <span class="inlinecode"><span class="id" title="var">t</span></span> is a binary search tree 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Inductive</span> <span class="nf">bst</span> : t elt -&gt; <span class="kt">Prop</span> :=
  | BSLeaf : bst (Leaf _)
  | BSNode : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">h</span>, bst l -&gt; bst r -&gt;
     lt_tree x l -&gt; gt_tree x r -&gt; bst (Node l x e r h).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Invariants</span>.</span></span></span></pre><div class="doc">
<a name="lab28"></a><h1 class="section">Correctness proofs, isolated in a sub-module</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Proofs</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">MX</span> := OrderedTypeFacts X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">PX</span> := KeyOrderedType X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">L</span> := FMapList.Raw X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">mem_ind</span> := <span class="kn">Induction for</span> mem <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">find_ind</span> := <span class="kn">Induction for</span> find <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">bal_ind</span> := <span class="kn">Induction for</span> bal <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">add_ind</span> := <span class="kn">Induction for</span> add <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">remove_min_ind</span> := <span class="kn">Induction for</span> remove_min <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">merge_ind</span> := <span class="kn">Induction for</span> merge <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">remove_ind</span> := <span class="kn">Induction for</span> remove <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">concat_ind</span> := <span class="kn">Induction for</span> concat <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">split_ind</span> := <span class="kn">Induction for</span> <span class="nb">split</span> <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">map_option_ind</span> := <span class="kn">Induction for</span> map_option <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Functional Scheme</span> <span class="nf">map2_opt_ind</span> := <span class="kn">Induction for</span> map2_opt <span class="kn">Sort</span> <span class="kt">Prop</span>.</span></span></span></pre><div class="doc">
<a name="lab29"></a><h1 class="section">Automation and dedicated tactics.</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Constructors</span> tree MapsTo In bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Unfold</span> lt_tree gt_tree : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Tactic Notation</span> <span class="s2">&quot;factornode&quot;</span> <span class="kn">ident</span>(l) <span class="kn">ident</span>(x) <span class="kn">ident</span>(d) <span class="kn">ident</span>(r) <span class="kn">ident</span>(h)
 <span class="s2">&quot;as&quot;</span> <span class="kn">ident</span>(s) :=
 <span class="nb">set</span> (s:=Node l x d r h) <span class="kr">in</span> *; <span class="nb">clearbody</span> s; <span class="nb">clear</span> l x d r h.</span></span></span></pre><div class="doc">
A tactic for cleaning hypothesis after use of functional induction. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">clearf</span> :=
 <span class="kr">match goal with</span>
  | H : (@Logic.eq (Compare _ _ _ _) _ _) |- _ =&gt; <span class="nb">clear</span> H; clearf
  | H : (@Logic.eq (sumbool _ _) _ _) |- _ =&gt; <span class="nb">clear</span> H; clearf
  | _ =&gt; <span class="kp">idtac</span>
 <span class="kr">end</span>.</span></span></span></pre><div class="doc">
A tactic to repeat <span class="inlinecode"><span class="id" title="tactic">inversion_clear</span></span> on all hyps of the
    form <span class="inlinecode">(<span class="id" title="var">f</span></span> <span class="inlinecode">(<span class="id" title="var">Node</span></span> <span class="inlinecode">...))</span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">inv</span> f :=
  <span class="kr">match goal with</span>
     | H:f (Leaf _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f _ (Leaf _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f _ _ (Leaf _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f _ _ _ (Leaf _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f (Node _ _ _ _ _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f _ (Node _ _ _ _ _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f _ _ (Node _ _ _ _ _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | H:f _ _ _ (Node _ _ _ _ _) |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
     | _ =&gt; <span class="kp">idtac</span>
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">inv_all</span> f :=
  <span class="kr">match goal with</span>
   | H: f _ |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
   | H: f _ _ |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
   | H: f _ _ _ |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
   | H: f _ _ _ _ |- _ =&gt; <span class="nb">inversion_clear</span> H; inv f
   | _ =&gt; <span class="kp">idtac</span>
  <span class="kr">end</span>.</span></span></span></pre><div class="doc">
Helper tactic concerning order of elements. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">order</span> := <span class="kr">match goal with</span>
 | U: lt_tree _ ?s, V: In _ ?s |- _ =&gt; <span class="nb">generalize</span> (U _ V); <span class="nb">clear</span> U; order
 | U: gt_tree _ ?s, V: In _ ?s |- _ =&gt; <span class="nb">generalize</span> (U _ V); <span class="nb">clear</span> U; order
 | _ =&gt; MX.order
<span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">intuition_in</span> := <span class="kp">repeat</span> (<span class="nb">intuition</span>; inv In; inv MapsTo).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
<span class="c">(* Function/Functional Scheme can&#39;t deal with internal fix.</span>
<span class="c">   Let&#39;s do its job by hand: *)</span>

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">join_tac</span> :=
 <span class="nb">intros</span> l; <span class="nb">induction</span> l <span class="kr">as</span> [| ll _ lx ld lr Hlr lh];
   [ | <span class="nb">intros</span> x d r; <span class="nb">induction</span> r <span class="kr">as</span> [| rl Hrl rx rd rr _ rh]; <span class="nb">unfold</span> join;
     [ | <span class="nb">destruct</span> (gt_le_dec lh (rh+<span class="mi">2</span>)) <span class="kr">as</span> [GT|LE];
       [ <span class="kr">match goal with</span> |- <span class="kp">context</span> [ bal ?u ?v ?w ?z ] =&gt;
           <span class="nb">replace</span> (bal u v w z)
           <span class="kr">with</span> (bal ll lx ld (join lr x d (Node rl rx rd rr rh))); [ | <span class="nb">auto</span>]
         <span class="kr">end</span>
       | <span class="nb">destruct</span> (gt_le_dec rh (lh+<span class="mi">2</span>)) <span class="kr">as</span> [GT&#39;|LE&#39;];
         [ <span class="kr">match goal with</span> |- <span class="kp">context</span> [ bal ?u ?v ?w ?z ] =&gt;
             <span class="nb">replace</span> (bal u v w z)
             <span class="kr">with</span> (bal (join (Node ll lx ld lr lh) x d rl) rx rd rr); [ | <span class="nb">auto</span>]
           <span class="kr">end</span>
         | ] ] ] ]; <span class="nb">intros</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Elt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span>:<span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Implicit Types</span> <span class="nv">m</span> <span class="nv">r</span> : t elt.</span></span></span></pre><div class="doc">
<a name="lab30"></a><h1 class="section">Basic results about <span class="inlinecode"><span class="id" title="var">MapsTo</span></span>, <span class="inlinecode"><span class="id" title="var">In</span></span>, <span class="inlinecode"><span class="id" title="var">lt_tree</span></span>, <span class="inlinecode"><span class="id" title="var">gt_tree</span></span>, <span class="inlinecode"><span class="id" title="var">height</span></span></h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
Facts about <span class="inlinecode"><span class="id" title="var">MapsTo</span></span> and <span class="inlinecode"><span class="id" title="var">In</span></span>. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">MapsTo_In</span> : <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">e</span> <span class="nv">m</span>, MapsTo k e m -&gt; In k m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">m</span> : t elt),
MapsTo k e m -&gt; In k m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">m</span> : t elt),
MapsTo k e m -&gt; In k m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> <span class="mi">1</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> MapsTo_In : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">In_MapsTo</span> : <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">m</span>, In k m -&gt; <span class="kr">exists</span> <span class="nv">e</span>, MapsTo k e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">m</span> : t elt),
In k m -&gt; <span class="kr">exists</span> <span class="nv">e</span> : elt, MapsTo k e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">m</span> : t elt),
In k m -&gt; <span class="kr">exists</span> <span class="nv">e</span> : elt, MapsTo k e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> <span class="mi">1</span>; <span class="kp">try</span> <span class="nb">destruct</span> IHIn <span class="kr">as</span> (e,He); <span class="kr">exists</span> <span class="nv">e</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">In_alt</span> : <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">m</span>, In0 k m &lt;-&gt; In k m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">m</span> : t elt), In0 k m &lt;-&gt; In k m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">m</span> : t elt), In0 k m &lt;-&gt; In k m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6"><span class="highlight"><span class="nb">split</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In0 k m -&gt; In k m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk7"><hr></label><div class="goal-conclusion"><span class="highlight">In k m -&gt; In0 k m</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk8"><span class="highlight"><span class="nb">intros</span> (e,H); <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In k m -&gt; In0 k m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> In0; <span class="nb">apply</span> In_MapsTo; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">MapsTo_1</span> :
 <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, X.eq x y -&gt; MapsTo x e m -&gt; MapsTo y e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
X.eq x y -&gt; MapsTo x e m -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
X.eq x y -&gt; MapsTo x e m -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; intuition_in; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Immediate</span> MapsTo_1 : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">In_1</span> :
 <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span>, X.eq x y -&gt; In x m -&gt; In y m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t),
X.eq x y -&gt; In x m -&gt; In y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t),
X.eq x y -&gt; In x m -&gt; In y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y; <span class="nb">induction</span> m; <span class="nb">simpl</span>; intuition_in; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">In_node_iff</span> :
 <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span>,
  In y (Node l x e r h) &lt;-&gt; In y l \/ X.eq y x \/ In y r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : key),
In y (Node l x e r h) &lt;-&gt; In y l \/ X.eq y x \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : key),
In y (Node l x e r h) &lt;-&gt; In y l \/ X.eq y x \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Results about <span class="inlinecode"><span class="id" title="var">lt_tree</span></span> and <span class="inlinecode"><span class="id" title="var">gt_tree</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkf"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_leaf</span> : <span class="kr">forall</span> <span class="nv">x</span>, lt_tree x (Leaf elt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X.t, lt_tree x (Leaf elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk10" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk10"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X.t, lt_tree x (Leaf elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> lt_tree; <span class="nb">intros</span>; intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_leaf</span> : <span class="kr">forall</span> <span class="nv">x</span>, gt_tree x (Leaf elt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X.t, gt_tree x (Leaf elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk12" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk12"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X.t, gt_tree x (Leaf elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> gt_tree; <span class="nb">intros</span>; intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk13" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk13"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_tree_node</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">e</span> <span class="nv">h</span>,
 lt_tree x l -&gt; lt_tree x r -&gt; X.lt y x -&gt; lt_tree x (Node l y e r h).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt) (<span class="nv">h</span> : int),
lt_tree x l -&gt;
lt_tree x r -&gt; X.lt y x -&gt; lt_tree x (Node l y e r h)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk14" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk14"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt) (<span class="nv">h</span> : int),
lt_tree x l -&gt;
lt_tree x r -&gt; X.lt y x -&gt; lt_tree x (Node l y e r h)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> lt_tree <span class="kr">in</span> *; intuition_in; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk15" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk15"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_tree_node</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">e</span> <span class="nv">h</span>,
 gt_tree x l -&gt; gt_tree x r -&gt; X.lt x y -&gt; gt_tree x (Node l y e r h).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt) (<span class="nv">h</span> : int),
gt_tree x l -&gt;
gt_tree x r -&gt; X.lt x y -&gt; gt_tree x (Node l y e r h)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk16" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk16"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt) (<span class="nv">h</span> : int),
gt_tree x l -&gt;
gt_tree x r -&gt; X.lt x y -&gt; gt_tree x (Node l y e r h)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> gt_tree <span class="kr">in</span> *; intuition_in; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> lt_leaf gt_leaf lt_tree_node gt_tree_node : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk17" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk17"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_left</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">e</span> <span class="nv">h</span>,
 lt_tree x (Node l y e r h) -&gt; lt_tree x l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), lt_tree x (Node l y e r h) -&gt; lt_tree x l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk18" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk18"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), lt_tree x (Node l y e r h) -&gt; lt_tree x l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk19" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk19"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_right</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">e</span> <span class="nv">h</span>,
 lt_tree x (Node l y e r h) -&gt; lt_tree x r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), lt_tree x (Node l y e r h) -&gt; lt_tree x r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), lt_tree x (Node l y e r h) -&gt; lt_tree x r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_left</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">e</span> <span class="nv">h</span>,
 gt_tree x (Node l y e r h) -&gt; gt_tree x l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), gt_tree x (Node l y e r h) -&gt; gt_tree x l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), gt_tree x (Node l y e r h) -&gt; gt_tree x l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_right</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">l</span> <span class="nv">r</span> <span class="nv">e</span> <span class="nv">h</span>,
 gt_tree x (Node l y e r h) -&gt; gt_tree x r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), gt_tree x (Node l y e r h) -&gt; gt_tree x r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">e</span> : elt)
  (<span class="nv">h</span> : int), gt_tree x (Node l y e r h) -&gt; gt_tree x r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> lt_left lt_right gt_left gt_right : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_tree_not_in</span> :
 <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">m</span>, lt_tree x m -&gt; ~ In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt), lt_tree x m -&gt; ~ In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk20" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk20"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt), lt_tree x m -&gt; ~ In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">intro</span>; <span class="nb">generalize</span> (H _ H0); order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_tree_trans</span> :
 <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, X.lt x y -&gt; <span class="kr">forall</span> <span class="nv">m</span>, lt_tree x m -&gt; lt_tree y m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : X.t,
X.lt x y -&gt;
<span class="kr">forall</span> <span class="nv">m</span> : t elt, lt_tree x m -&gt; lt_tree y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : X.t,
X.lt x y -&gt;
<span class="kr">forall</span> <span class="nv">m</span> : t elt, lt_tree x m -&gt; lt_tree y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_tree_not_in</span> :
 <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">m</span>, gt_tree x m -&gt; ~ In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt), gt_tree x m -&gt; ~ In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk24" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk24"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt), gt_tree x m -&gt; ~ In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">intro</span>; <span class="nb">generalize</span> (H _ H0); order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk25" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk25"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">gt_tree_trans</span> :
 <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, X.lt y x -&gt; <span class="kr">forall</span> <span class="nv">m</span>, gt_tree x m -&gt; gt_tree y m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : X.t,
X.lt y x -&gt;
<span class="kr">forall</span> <span class="nv">m</span> : t elt, gt_tree x m -&gt; gt_tree y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : X.t,
X.lt y x -&gt;
<span class="kr">forall</span> <span class="nv">m</span> : t elt, gt_tree x m -&gt; gt_tree y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> lt_tree_not_in lt_tree_trans gt_tree_not_in gt_tree_trans : core.</span></span></span></pre><div class="doc">
<a name="lab31"></a><h1 class="section">Empty map</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Empty</span> <span class="nv">m</span> := <span class="kr">forall</span> (<span class="nv">a</span>:key)(<span class="nv">e</span>:elt) , ~ MapsTo a e m.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">empty_bst</span> : bst (empty elt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (empty elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk28" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk28"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (empty elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> empty; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">empty_1</span> : Empty (empty elt).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty (empty elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty (empty elt)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> empty, Empty; intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab32"></a><h1 class="section">Emptyness test</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">is_empty_1</span> : <span class="kr">forall</span> <span class="nv">m</span>, Empty m -&gt; is_empty m = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, Empty m -&gt; is_empty m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, Empty m -&gt; is_empty m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2d"><span class="highlight"><span class="nb">destruct</span> m <span class="kr">as</span> [|r x e l h]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty (Node r x e l h) -&gt; false = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intro</span> H; <span class="nb">elim</span> (H x e); <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">is_empty_2</span> : <span class="kr">forall</span> <span class="nv">m</span>, is_empty m = true -&gt; Empty m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, is_empty m = true -&gt; Empty m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, is_empty m = true -&gt; Empty m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> m; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="kp">try</span> <span class="bp">discriminate</span>; <span class="nb">red</span>; intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab33"></a><h1 class="section">Membership</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk30" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk30"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; In x m -&gt; mem x m = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
bst m -&gt; In x m -&gt; mem x m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk31" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk31"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
bst m -&gt; In x m -&gt; mem x m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (mem x m); <span class="nb">auto</span>; <span class="nb">intros</span>; clearf;
  inv bst; intuition_in; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk32" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk32"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, mem x m = true -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t), mem x m = true -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk33" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk33"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t), mem x m = true -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (mem x m); <span class="nb">auto</span>; <span class="nb">intros</span>; <span class="bp">discriminate</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk34" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk34"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>, bst m -&gt; MapsTo x e m -&gt; find x m = Some e.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
bst m -&gt; MapsTo x e m -&gt; find x m = Some e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk35" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk35"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
bst m -&gt; MapsTo x e m -&gt; find x m = Some e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (find x m); <span class="nb">auto</span>; <span class="nb">intros</span>; clearf;
  inv bst; intuition_in; <span class="nb">simpl</span>; <span class="nb">auto</span>;
 <span class="kp">try</span> <span class="kp">solve</span> [order | <span class="nb">absurd</span> (X.lt x y); <span class="nb">eauto</span> | <span class="nb">absurd</span> (X.lt y x); <span class="nb">eauto</span>].</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>, find x m = Some e -&gt; MapsTo x e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
find x m = Some e -&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
find x m = Some e -&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (find x m); <span class="nb">subst</span>; <span class="nb">intros</span>; clearf;
  <span class="kp">try</span> <span class="bp">discriminate</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHo</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e0</span> : elt, find x l = Some e0 -&gt; MapsTo x e0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x l = Some e</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x e (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk39" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Some d = Some e</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk39"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo x e (Node l y d r _x)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHo</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e0</span> : elt, find x r = Some e0 -&gt; MapsTo x e0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x r = Some e</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3a"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo x e (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b"><span class="highlight"><span class="nb">constructor</span> <span class="mi">2</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Some d = Some e</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x e (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHo</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e0</span> : elt, find x r = Some e0 -&gt; MapsTo x e0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x r = Some e</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3c"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo x e (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d"><span class="highlight"><span class="nb">inversion</span> H; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHo</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e0</span> : elt, find x r = Some e0 -&gt; MapsTo x e0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x r = Some e</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x e (Node l y d r _x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">constructor</span> <span class="mi">3</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_iff</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>, bst m -&gt;
 (find x m = Some e &lt;-&gt; MapsTo x e m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
bst m -&gt; find x m = Some e &lt;-&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
bst m -&gt; find x m = Some e &lt;-&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; <span class="nb">auto using</span> find_1, find_2.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk40" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk40"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_in</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, find x m &lt;&gt; None -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
find x m &lt;&gt; None -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk41" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk41"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
find x m &lt;&gt; None -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk42" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk42"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m &lt;&gt; None</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk43" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk43"><span class="highlight"><span class="nb">case_eq</span> (find x m); [<span class="nb">intros</span>|<span class="bp">congruence</span>].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m = Some e</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> MapsTo_In <span class="kr">with</span> e; <span class="nb">apply</span> find_2; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk44" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk44"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">in_find</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; In x m -&gt; find x m &lt;&gt; None.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
bst m -&gt; In x m -&gt; find x m &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk45" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk45"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
bst m -&gt; In x m -&gt; find x m &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk46" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk46"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x m &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk47" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk47"><span class="highlight"><span class="nb">destruct</span> (In_MapsTo H0) <span class="kr">as</span> (d,Hd).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x d m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x m &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> (find_1 H Hd); <span class="bp">discriminate</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk48" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk48"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_in_iff</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt;
 (find x m &lt;&gt; None &lt;-&gt; In x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; find x m &lt;&gt; None &lt;-&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk49" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk49"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; find x m &lt;&gt; None &lt;-&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; <span class="nb">auto using</span> find_in, in_find.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk4a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk4a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">not_find_iff</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt;
 (find x m = None &lt;-&gt; ~In x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; find x m = None &lt;-&gt; ~ In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk4b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk4b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; find x m = None &lt;-&gt; ~ In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk4c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk4c"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m = None</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ In x m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk4d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ In x m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk4d"><hr></label><div class="goal-conclusion"><span class="highlight">find x m = None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk4e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk4e"><span class="highlight"><span class="nb">red</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk4f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ In x m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk4f"><hr></label><div class="goal-conclusion"><span class="highlight">find x m = None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk50" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk50"><span class="highlight"><span class="nb">elim</span> (in_find H H1 H0).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ In x m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x m = None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk51" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk51"><span class="highlight"><span class="nb">case_eq</span> (find x m); [ <span class="nb">intros</span> | <span class="nb">auto</span> ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ In x m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m = Some e</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some e = None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">elim</span> H0; <span class="nb">apply</span> find_in; <span class="bp">congruence</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk52" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk52"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_find</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">x</span>,
 find x m = find x m&#39; &lt;-&gt;
 (<span class="kr">forall</span> <span class="nv">d</span>, find x m = Some d &lt;-&gt; find x m&#39; = Some d).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">x</span> : X.t),
find x m = find x m&#39; &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">d</span> : elt,
 find x m = Some d &lt;-&gt; find x m&#39; = Some d)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk53" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk53"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">x</span> : X.t),
find x m = find x m&#39; &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">d</span> : elt,
 find x m = Some d &lt;-&gt; find x m&#39; = Some d)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk54" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk54"><span class="highlight"><span class="nb">intros</span>; <span class="nb">destruct</span> (find x m); <span class="nb">destruct</span> (find x m&#39;); <span class="nb">split</span>; <span class="nb">intros</span>;
  <span class="kp">try</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">congruence</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt,
Some e = Some d &lt;-&gt; Some e0 = Some d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some e = Some e0</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk55" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt, Some e = Some d &lt;-&gt; None = Some d</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk55"><hr></label><div class="goal-conclusion"><span class="highlight">Some e = None</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk56" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt, None = Some d &lt;-&gt; Some e = Some d</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk56"><hr></label><div class="goal-conclusion"><span class="highlight">None = Some e</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk57" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk57"><span class="highlight"><span class="nb">rewrite</span> H; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt, Some e = Some d &lt;-&gt; None = Some d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some e = None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk58" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt, None = Some d &lt;-&gt; Some e = Some d</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk58"><hr></label><div class="goal-conclusion"><span class="highlight">None = Some e</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk59" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk59"><span class="highlight"><span class="nb">symmetry</span>; <span class="nb">rewrite</span> &lt;- H; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt, None = Some d &lt;-&gt; Some e = Some d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">None = Some e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> H; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk5a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk5a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_mapsto_equiv</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">x</span>, bst m -&gt; bst m&#39; -&gt;
 (find x m = find x m&#39; &lt;-&gt;
  (<span class="kr">forall</span> <span class="nv">d</span>, MapsTo x d m &lt;-&gt; MapsTo x d m&#39;)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
bst m&#39; -&gt;
find x m = find x m&#39; &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">d</span> : elt, MapsTo x d m &lt;-&gt; MapsTo x d m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk5b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk5b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
bst m&#39; -&gt;
find x m = find x m&#39; &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">d</span> : elt, MapsTo x d m &lt;-&gt; MapsTo x d m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk5c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk5c"><span class="highlight"><span class="nb">intros</span> m m&#39; x Hm Hm&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x m = find x m&#39; &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">d</span> : elt, MapsTo x d m &lt;-&gt; MapsTo x d m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk5d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk5d"><span class="highlight"><span class="nb">rewrite</span> find_find.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">d</span> : elt,
 find x m = Some d &lt;-&gt; find x m&#39; = Some d) &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">d</span> : elt, MapsTo x d m &lt;-&gt; MapsTo x d m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk5e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk5e"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span> H d; <span class="nb">specialize</span> H <span class="kr">with</span> d.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find x m = Some d &lt;-&gt; find x m&#39; = Some d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x d m &lt;-&gt; MapsTo x d m&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk5f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x d m &lt;-&gt; MapsTo x d m&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk5f"><hr></label><div class="goal-conclusion"><span class="highlight">find x m = Some d &lt;-&gt; find x m&#39; = Some d</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk60" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk60"><span class="highlight"><span class="nb">rewrite</span> &lt;- <span class="mi">2</span> find_iff; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hm'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x d m &lt;-&gt; MapsTo x d m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x m = Some d &lt;-&gt; find x m&#39; = Some d</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> find_iff; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk61" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk61"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_in_equiv</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">x</span>, bst m -&gt; bst m&#39; -&gt;
 find x m = find x m&#39; -&gt;
 (In x m &lt;-&gt; In x m&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
bst m&#39; -&gt; find x m = find x m&#39; -&gt; In x m &lt;-&gt; In x m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk62" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk62"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
bst m&#39; -&gt; find x m = find x m&#39; -&gt; In x m &lt;-&gt; In x m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; <span class="nb">intros</span>; <span class="nb">apply</span> find_in; [ <span class="nb">rewrite</span> &lt;- H1 | <span class="nb">rewrite</span> H1 ];
  <span class="nb">apply</span> in_find; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab34"></a><h1 class="section">Helper functions</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk63" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk63"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">create_bst</span> :
 <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span>, bst l -&gt; bst r -&gt; lt_tree x l -&gt; gt_tree x r -&gt;
 bst (create l x e r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt; gt_tree x r -&gt; bst (create l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk64" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk64"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt; gt_tree x r -&gt; bst (create l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> create; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> create_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk65" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk65"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">create_in</span> :
 <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">y</span>,
  In y (create l x e r) &lt;-&gt; X.eq y x \/ In y l \/ In y r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key),
In y (create l x e r) &lt;-&gt; X.eq y x \/ In y l \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk66" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk66"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key),
In y (create l x e r) &lt;-&gt; X.eq y x \/ In y l \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> create; <span class="nb">split</span>; [ <span class="nb">inversion_clear</span> <span class="mi">1</span> | ]; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk67" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk67"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bal_bst</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span>, bst l -&gt; bst r -&gt;
 lt_tree x l -&gt; gt_tree x r -&gt; bst (bal l x e r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt; gt_tree x r -&gt; bst (bal l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk68" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk68"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt; gt_tree x r -&gt; bst (bal l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (bal l x e r); <span class="nb">intros</span>; clearf;
 inv bst; <span class="kp">repeat</span> <span class="nb">apply</span> create_bst; <span class="nb">auto</span>; <span class="nb">unfold</span> create; <span class="kp">try</span> <span class="nb">constructor</span>;
 (<span class="nb">apply</span> lt_tree_node || <span class="nb">apply</span> gt_tree_node); <span class="nb">auto</span>;
 (<span class="nb">eapply</span> lt_tree_trans || <span class="nb">eapply</span> gt_tree_trans); <span class="nb">eauto</span>.</span></span><span class="coq-wsp"> 
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> bal_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk69" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk69"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bal_in</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">y</span>,
 In y (bal l x e r) &lt;-&gt; X.eq y x \/ In y l \/ In y r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key),
In y (bal l x e r) &lt;-&gt; X.eq y x \/ In y l \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key),
In y (bal l x e r) &lt;-&gt; X.eq y x \/ In y l \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (bal l x e r); <span class="nb">intros</span>; clearf;
 <span class="nb">rewrite</span> !create_in; intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bal_mapsto</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">y</span> <span class="nv">e&#39;</span>,
 MapsTo y e&#39; (bal l x e r) &lt;-&gt; MapsTo y e&#39; (create l x e r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key) (<span class="nv">e&#39;</span> : elt),
MapsTo y e&#39; (bal l x e r) &lt;-&gt;
MapsTo y e&#39; (create l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key) (<span class="nv">e&#39;</span> : elt),
MapsTo y e&#39; (bal l x e r) &lt;-&gt;
MapsTo y e&#39; (create l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (bal l x e r); <span class="nb">intros</span>; clearf;
 <span class="nb">unfold</span> assert_false, create; intuition_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bal_find</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">y</span>,
 bst l -&gt; bst r -&gt; lt_tree x l -&gt; gt_tree x r -&gt;
 find y (bal l x e r) = find y (create l x e r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : X.t),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt;
gt_tree x r -&gt;
find y (bal l x e r) = find y (create l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : X.t),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt;
gt_tree x r -&gt;
find y (bal l x e r) = find y (create l x e r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> find_mapsto_equiv; <span class="nb">auto</span>; <span class="nb">intros</span>; <span class="nb">apply</span> bal_mapsto.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab35"></a><h1 class="section">Insertion</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk6f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk6f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_in</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>,
 In y (add x e m) &lt;-&gt; X.eq y x \/ In y m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
In y (add x e m) &lt;-&gt; X.eq y x \/ In y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk70" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk70"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
In y (add x e m) &lt;-&gt; X.eq y x \/ In y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk71" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk71"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="nb">functional induction</span> (add x e m); <span class="nb">auto</span>; <span class="nb">intros</span>;
 <span class="kp">try</span> (<span class="nb">rewrite</span> bal_in, IHt); intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y0 = EQ _x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l y0 e r h)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> In_1 <span class="kr">with</span> x; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk72" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk72"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_bst</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>, bst m -&gt; bst (add x e m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
bst m -&gt; bst (add x e m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk73" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk73"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
bst m -&gt; bst (add x e m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk74" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk74"><span class="highlight"><span class="nb">intros</span> m x e; <span class="nb">functional induction</span> (add x e m); <span class="nb">intros</span>;
  inv bst; <span class="kp">try</span> <span class="nb">apply</span> bal_bst; <span class="nb">auto</span>;
  <span class="nb">intro</span> z; <span class="nb">rewrite</span> add_in; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq z x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (add x e l)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt z y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk75" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq z x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (add x e r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk75"><hr></label><div class="goal-conclusion"><span class="highlight">X.lt y z</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk76" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk76"><span class="highlight"><span class="nb">apply</span> MX.eq_lt <span class="kr">with</span> x; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq z x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (add x e r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y z</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> MX.lt_eq <span class="kr">with</span> x; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> add_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk77" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk77"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, X.eq x y -&gt; MapsTo y e (add x e m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
X.eq x y -&gt; MapsTo y e (add x e m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk78" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk78"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
X.eq x y -&gt; MapsTo y e (add x e m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="nb">functional induction</span> (add x e m);
   <span class="nb">intros</span>; inv bst; <span class="kp">try</span> <span class="nb">rewrite</span> bal_mapsto; <span class="nb">unfold</span> create; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk79" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk79"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span> <span class="nv">e&#39;</span>, ~X.eq x y -&gt;
 MapsTo y e m -&gt; MapsTo y e (add x e&#39; m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ X.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (add x e&#39; m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk7a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk7a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ X.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (add x e&#39; m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk7b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk7b"><span class="highlight"><span class="nb">intros</span> m x y e e&#39;; <span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt;
MapsTo y e m1 -&gt; MapsTo y e (add x e&#39; m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt;
MapsTo y e m2 -&gt; MapsTo y e (add x e&#39; m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ X.eq x y -&gt;
MapsTo y e (Node m1 k e0 m2 t) -&gt;
MapsTo y e
  <span class="kr">match</span> X.<span class="nb">compare</span> x k <span class="kr">with</span>
  | LT _ =&gt; bal (add x e&#39; m1) k e0 m2
  | EQ _ =&gt; Node m1 k e&#39; m2 t
  | GT _ =&gt; bal m1 k e0 (add x e&#39; m2)
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (X.<span class="nb">compare</span> x k);
 <span class="nb">intros</span>; inv bst; <span class="kp">try</span> <span class="nb">rewrite</span> bal_mapsto; <span class="nb">unfold</span> create; <span class="nb">auto</span>;
   inv MapsTo; <span class="nb">auto</span>; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk7c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk7c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_3</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span> <span class="nv">e&#39;</span>, ~X.eq x y -&gt;
 MapsTo y e (add x e&#39; m) -&gt; MapsTo y e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ X.eq x y -&gt; MapsTo y e (add x e&#39; m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk7d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk7d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ X.eq x y -&gt; MapsTo y e (add x e&#39; m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk7e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk7e"><span class="highlight"><span class="nb">intros</span> m x y e e&#39;; <span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ X.eq x y -&gt;
MapsTo y e (Node (Leaf elt) x e&#39; (Leaf elt) <span class="mi">1</span>) -&gt;
MapsTo y e (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk7f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt;
MapsTo y e (add x e&#39; m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt;
MapsTo y e (add x e&#39; m2) -&gt; MapsTo y e m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk7f"><hr></label><div class="goal-conclusion"><span class="highlight">~ X.eq x y -&gt;
MapsTo y e
  <span class="kr">match</span> X.<span class="nb">compare</span> x k <span class="kr">with</span>
  | LT _ =&gt; bal (add x e&#39; m1) k e0 m2
  | EQ _ =&gt; Node m1 k e&#39; m2 t
  | GT _ =&gt; bal m1 k e0 (add x e&#39; m2)
  <span class="kr">end</span> -&gt; MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk80" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk80"><span class="highlight"><span class="nb">intros</span>; inv MapsTo; <span class="nb">auto</span>; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt;
MapsTo y e (add x e&#39; m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt;
MapsTo y e (add x e&#39; m2) -&gt; MapsTo y e m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ X.eq x y -&gt;
MapsTo y e
  <span class="kr">match</span> X.<span class="nb">compare</span> x k <span class="kr">with</span>
  | LT _ =&gt; bal (add x e&#39; m1) k e0 m2
  | EQ _ =&gt; Node m1 k e&#39; m2 t
  | GT _ =&gt; bal m1 k e0 (add x e&#39; m2)
  <span class="kr">end</span> -&gt; MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (X.<span class="nb">compare</span> x k); <span class="nb">intro</span>;
  <span class="kp">try</span> <span class="nb">rewrite</span> bal_mapsto; <span class="nb">auto</span>; <span class="nb">unfold</span> create; <span class="nb">intros</span>; inv MapsTo; <span class="nb">auto</span>;
  order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk81" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk81"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_find</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, bst m -&gt;
 find y (add x e m) =
  <span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span> EQ _ =&gt; Some e | _ =&gt; find y m <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
bst m -&gt;
find y (add x e m) =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some e
| _ =&gt; find y m
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk82" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk82"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
bst m -&gt;
find y (add x e m) =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some e
| _ =&gt; find y m
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk83" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk83"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (add x e m) =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some e
| _ =&gt; find y m
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk84" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk84"><span class="highlight"><span class="nb">assert</span> (~X.eq x y -&gt; find y (add x e m) = find y m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ X.eq x y -&gt; find y (add x e m) = find y m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk85" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt; find y (add x e m) = find y m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk85"><hr></label><div class="goal-conclusion"><span class="highlight">find y (add x e m) =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some e
| _ =&gt; find y m
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk86" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk86"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> find_mapsto_equiv; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">d</span> : elt,
MapsTo y d (add x e m) &lt;-&gt; MapsTo y d m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk87" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt; find y (add x e m) = find y m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk87"><hr></label><div class="goal-conclusion"><span class="highlight">find y (add x e m) =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some e
| _ =&gt; find y m
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk88" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk88"><span class="highlight"><span class="nb">split</span>; <span class="nb">eauto using</span> add_2, add_3.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt; find y (add x e m) = find y m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (add x e m) =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some e
| _ =&gt; find y m
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk89" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk89"><span class="highlight"><span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="kp">try</span> (<span class="nb">apply</span> H0; order).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y -&gt; find y (add x e m) = find y m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (add x e m) = Some e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto using</span> find_1, add_1.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab36"></a><h1 class="section">Extraction of minimum binding</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk8a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk8a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_min_in</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span>,
 In y (Node l x e r h) &lt;-&gt;
  X.eq y (remove_min l x e r)#<span class="mi">2</span>#<span class="mi">1</span> \/ In y (remove_min l x e r)#<span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : key),
In y (Node l x e r h) &lt;-&gt;
X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> \/
In y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk8b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk8b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : key),
In y (Node l x e r h) &lt;-&gt;
X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> \/
In y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk8c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk8c"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (remove_min l x e r); <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node (Leaf elt) x d r h) &lt;-&gt; X.eq y x \/ In y r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk8d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key),
In y0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> \/ In y0 (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk8d"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> \/ In y (bal l&#39; x d r)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk8e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk8e"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key),
In y0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> \/ In y0 (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> \/ In y (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk8f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk8f"><span class="highlight"><span class="nb">rewrite</span> e0 <span class="kr">in</span> *; <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key),
In y0 (Node ll lx ld lr h0) &lt;-&gt; X.eq y0 ((l&#39;, m)#<span class="mi">2</span>)#<span class="mi">1</span> \/ In y0 (l&#39;, m)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> \/ In y (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> bal_in, In_node_iff, IHp; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk90" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk90"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_min_mapsto</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span> <span class="nv">e&#39;</span>,
  MapsTo y e&#39; (Node l x e r h) &lt;-&gt;
   ((X.eq y (remove_min l x e r)#<span class="mi">2</span>#<span class="mi">1</span>) /\ e&#39; = (remove_min l x e r)#<span class="mi">2</span>#<span class="mi">2</span>)
    \/ MapsTo y e&#39; (remove_min l x e r)#<span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : key) (<span class="nv">e&#39;</span> : elt),
MapsTo y e&#39; (Node l x e r h) &lt;-&gt;
X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> /\
e&#39; = ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span> \/
MapsTo y e&#39; (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk91" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk91"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : key) (<span class="nv">e&#39;</span> : elt),
MapsTo y e&#39; (Node l x e r h) &lt;-&gt;
X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> /\
e&#39; = ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span> \/
MapsTo y e&#39; (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk92" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk92"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (remove_min l x e r); <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Leaf elt) x d r h) &lt;-&gt;
X.eq y x /\ e&#39; = d \/ MapsTo y e&#39; r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk93" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> /\
e&#39;0 = ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">2</span> \/
MapsTo y0 e&#39;0 (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk93"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; (bal l&#39; x d r)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk94" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk94"><span class="highlight">intuition_in; <span class="nb">subst</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> /\
e&#39;0 = ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">2</span> \/
MapsTo y0 e&#39;0 (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk95" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk95"><span class="highlight"><span class="nb">rewrite</span> e0 <span class="kr">in</span> *; <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 ((l&#39;, m)#<span class="mi">2</span>)#<span class="mi">1</span> /\ e&#39;0 = ((l&#39;, m)#<span class="mi">2</span>)#<span class="mi">2</span> \/ MapsTo y0 e&#39;0 (l&#39;, m)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk96" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk96"><span class="highlight"><span class="nb">rewrite</span> bal_mapsto; <span class="nb">auto</span>; <span class="nb">unfold</span> create.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 ((l&#39;, m)#<span class="mi">2</span>)#<span class="mi">1</span> /\ e&#39;0 = ((l&#39;, m)#<span class="mi">2</span>)#<span class="mi">2</span> \/ MapsTo y0 e&#39;0 (l&#39;, m)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/
MapsTo y e&#39;
  (Node l&#39; x d r (max (height l&#39;) (height r) + <span class="mi">1</span>))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk97" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk97"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *;<span class="nb">destruct</span> (IHp _x y e&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 m#<span class="mi">1</span> /\ e&#39;0 = m#<span class="mi">2</span> \/ MapsTo y0 e&#39;0 l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; (Node ll lx ld lr _x) -&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; l&#39; -&gt;
MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h) &lt;-&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/
MapsTo y e&#39;
  (Node l&#39; x d r (max (height l&#39;) (height r) + <span class="mi">1</span>))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk98" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk98"><span class="highlight"><span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 m#<span class="mi">1</span> /\ e&#39;0 = m#<span class="mi">2</span> \/ MapsTo y0 e&#39;0 l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; (Node ll lx ld lr _x) -&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; l&#39; -&gt;
MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y m#<span class="mi">1</span> -&gt;
e&#39; = m#<span class="mi">2</span> -&gt; MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/
MapsTo y e&#39;
  (Node l&#39; x d r (max (height l&#39;) (height r) + <span class="mi">1</span>))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk99" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 m#<span class="mi">1</span> /\ e&#39;0 = m#<span class="mi">2</span> \/ MapsTo y0 e&#39;0 l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; (Node ll lx ld lr _x) -&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; l&#39; -&gt;
MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y m#<span class="mi">1</span> -&gt;
e&#39; = m#<span class="mi">2</span> -&gt; MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39;
  (Node l&#39; x d r (max (height l&#39;) (height r) + <span class="mi">1</span>))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk99"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk9a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk9a"><span class="highlight"><span class="nb">inversion_clear</span> H1; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">h0</span> : int) (<span class="nv">y0</span> : key) (<span class="nv">e&#39;0</span> : elt),
MapsTo y0 e&#39;0 (Node ll lx ld lr h0) &lt;-&gt;
X.eq y0 m#<span class="mi">1</span> /\ e&#39;0 = m#<span class="mi">2</span> \/ MapsTo y0 e&#39;0 l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; (Node ll lx ld lr _x) -&gt;
X.eq y m#<span class="mi">1</span> /\ e&#39; = m#<span class="mi">2</span> \/ MapsTo y e&#39; l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39; l&#39; -&gt;
MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y m#<span class="mi">1</span> -&gt;
e&#39; = m#<span class="mi">2</span> -&gt; MapsTo y e&#39; (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e&#39;
  (Node l&#39; x d r (max (height l&#39;) (height r) + <span class="mi">1</span>))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e&#39; (Node (Node ll lx ld lr _x) x d r h)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">inversion_clear</span> H3; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk9b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk9b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_min_bst</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">h</span>,
 bst (Node l x e r h) -&gt; bst (remove_min l x e r)#<span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int),
bst (Node l x e r h) -&gt; bst (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk9c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk9c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int),
bst (Node l x e r h) -&gt; bst (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk9d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk9d"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (remove_min l x e r); <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node (Leaf elt) x d r h)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk9e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node (Node ll lx ld lr _x) x d r h)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk9e"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l&#39; x d r)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk9f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk9f"><span class="highlight">inv bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node (Node ll lx ld lr _x) x d r h)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka0"><span class="highlight"><span class="nb">inversion_clear</span> H; <span class="nb">inversion_clear</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka1"><span class="highlight"><span class="nb">apply</span> bal_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst l&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chka2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chka2"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x l&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka3"><span class="highlight"><span class="nb">rewrite</span> e0 <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">apply</span> (IHp _x); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree x l&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka4"><span class="highlight"><span class="nb">intro</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka5"><span class="highlight"><span class="nb">generalize</span> (remove_min_in ll lx ld lr _x y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node ll lx ld lr _x) &lt;-&gt;
X.eq y ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> \/
In y (remove_min ll lx ld lr)#<span class="mi">1</span> -&gt; X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka6"><span class="highlight"><span class="nb">rewrite</span> e0; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node ll lx ld lr _x) &lt;-&gt; X.eq y m#<span class="mi">1</span> \/ In y l&#39; -&gt;
X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka7"><span class="highlight"><span class="nb">destruct</span> <span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; bst (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node ll lx ld lr _x) -&gt;
X.eq y m#<span class="mi">1</span> \/ In y l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y m#<span class="mi">1</span> \/ In y l&#39; -&gt;
In y (Node ll lx ld lr _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> H2; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> remove_min_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_min_gt_tree</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">h</span>,
 bst (Node l x e r h) -&gt;
 gt_tree (remove_min l x e r)#<span class="mi">2</span>#<span class="mi">1</span> (remove_min l x e r)#<span class="mi">1</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int),
bst (Node l x e r h) -&gt;
gt_tree ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span>
  (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chka9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chka9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int),
bst (Node l x e r h) -&gt;
gt_tree ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span>
  (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkaa" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkaa"><span class="highlight"><span class="nb">intros</span> l x e r; <span class="nb">functional induction</span> (remove_min l x e r); <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node (Leaf elt) x d r h)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree x r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkab" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int,
bst (Node ll lx ld lr h0) -&gt;
gt_tree ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node (Node ll lx ld lr _x) x d r h)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkab"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree m#<span class="mi">1</span> (bal l&#39; x d r)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkac" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkac"><span class="highlight">inv bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int,
bst (Node ll lx ld lr h0) -&gt;
gt_tree ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node (Node ll lx ld lr _x) x d r h)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree m#<span class="mi">1</span> (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkad" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkad"><span class="highlight"><span class="nb">inversion_clear</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int,
bst (Node ll lx ld lr h0) -&gt;
gt_tree ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree m#<span class="mi">1</span> (bal l&#39; x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkae" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkae"><span class="highlight"><span class="nb">intro</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int,
bst (Node ll lx ld lr h0) -&gt;
gt_tree ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> (remove_min ll lx ld lr)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (bal l&#39; x d r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkaf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkaf"><span class="highlight"><span class="nb">rewrite</span> e0 <span class="kr">in</span> *;<span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (bal l&#39; x d r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb0"><span class="highlight"><span class="nb">generalize</span> (IHp _x H0).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (bal l&#39; x d r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree m#<span class="mi">1</span> l&#39; -&gt; X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb1"><span class="highlight"><span class="nb">generalize</span> (remove_min_in ll lx ld lr _x m#<span class="mi">1</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (bal l&#39; x d r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In m#<span class="mi">1</span> (Node ll lx ld lr _x) &lt;-&gt;
X.eq m#<span class="mi">1</span> ((remove_min ll lx ld lr)#<span class="mi">2</span>)#<span class="mi">1</span> \/
In m#<span class="mi">1</span> (remove_min ll lx ld lr)#<span class="mi">1</span> -&gt;
gt_tree m#<span class="mi">1</span> l&#39; -&gt; X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb2"><span class="highlight"><span class="nb">rewrite</span> e0; <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (bal l&#39; x d r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In m#<span class="mi">1</span> (Node ll lx ld lr _x) &lt;-&gt;
X.eq m#<span class="mi">1</span> m#<span class="mi">1</span> \/ In m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb3"><span class="highlight"><span class="nb">rewrite</span> (bal_in l&#39; x d r y) <span class="kr">in</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x \/ In y l&#39; \/ In y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In m#<span class="mi">1</span> (Node ll lx ld lr _x) &lt;-&gt;
X.eq m#<span class="mi">1</span> m#<span class="mi">1</span> \/ In m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb4"><span class="highlight"><span class="nb">assert</span> (In m#<span class="mi">1</span> (Node ll lx ld lr _x)) <span class="bp">by</span> (<span class="nb">rewrite</span> H4; <span class="nb">auto</span>); <span class="nb">clear</span> H4.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x \/ In y l&#39; \/ In y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In m#<span class="mi">1</span> (Node ll lx ld lr _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb5"><span class="highlight"><span class="nb">assert</span> (X.lt m#<span class="mi">1</span> x) <span class="bp">by</span> order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r, ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min ll lx ld lr = (l&#39;, m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">h0</span> : int, bst (Node ll lx ld lr h0) -&gt; gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x \/ In y l&#39; \/ In y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree m#<span class="mi">1</span> l&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In m#<span class="mi">1</span> (Node ll lx ld lr _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt m#<span class="mi">1</span> x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt m#<span class="mi">1</span> y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">decompose</span> [or] H; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> remove_min_gt_tree : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_min_find</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">r</span> <span class="nv">h</span> <span class="nv">y</span>,
 bst (Node l x e r h) -&gt;
 find y (Node l x e r h) =
   <span class="kr">match</span> X.<span class="nb">compare</span> y (remove_min l x e r)#<span class="mi">2</span>#<span class="mi">1</span> <span class="kr">with</span>
    | LT _ =&gt; None
    | EQ _ =&gt; Some (remove_min l x e r)#<span class="mi">2</span>#<span class="mi">2</span>
    | GT _ =&gt; find y (remove_min l x e r)#<span class="mi">1</span>
   <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : X.t),
bst (Node l x e r h) -&gt;
find y (Node l x e r h) =
<span class="kr">match</span> X.<span class="nb">compare</span> y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> <span class="kr">with</span>
| LT _ =&gt; None
| EQ _ =&gt; Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span>
| GT _ =&gt; find y (remove_min l x e r)#<span class="mi">1</span>
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">h</span> : int) (<span class="nv">y</span> : X.t),
bst (Node l x e r h) -&gt;
find y (Node l x e r h) =
<span class="kr">match</span> X.<span class="nb">compare</span> y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> <span class="kr">with</span>
| LT _ =&gt; None
| EQ _ =&gt; Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span>
| GT _ =&gt; find y (remove_min l x e r)#<span class="mi">1</span>
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb8"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
<span class="kr">match</span> X.<span class="nb">compare</span> y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> <span class="kr">with</span>
| LT _ =&gt; None
| EQ _ =&gt; Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span>
| GT _ =&gt; find y (remove_min l x e r)#<span class="mi">1</span>
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkb9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkb9"><span class="highlight"><span class="nb">destruct</span> X.<span class="nb">compare</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) = None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkba" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkba"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkbb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkbb"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
find y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkbc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkbc"><span class="highlight"><span class="nb">rewrite</span> not_find_iff; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ In y (Node l x e r h)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkbd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkbd"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkbe" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkbe"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
find y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkbf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkbf"><span class="highlight"><span class="nb">rewrite</span> remove_min_in; <span class="nb">red</span>; <span class="nb">destruct</span> <span class="mi">1</span> <span class="kr">as</span> [H&#39;|H&#39;]; [ order | ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (remove_min l x e r)#<span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkc0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkc0"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkc1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkc1"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
find y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc2"><span class="highlight"><span class="nb">generalize</span> (remove_min_gt_tree H H&#39;); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
Some ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkc3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkc3"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
find y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc4"><span class="highlight"><span class="nb">apply</span> find_1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">2</span> (Node l x e r h)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkc5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkc5"><hr></label><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
find y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc6"><span class="highlight"><span class="nb">rewrite</span> remove_min_mapsto; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (Node l x e r h) =
find y (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc7"><span class="highlight"><span class="nb">rewrite</span> find_mapsto_equiv; <span class="nb">eauto</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l x e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt ((remove_min l x e r)#<span class="mi">2</span>)#<span class="mi">1</span> y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y d (Node l x e r h) &lt;-&gt;
MapsTo y d (remove_min l x e r)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> remove_min_mapsto; <span class="nb">intuition</span>; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab37"></a><h1 class="section">Merging two trees</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">merge_in</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">y</span>, bst m1 -&gt; bst m2 -&gt;
 (In y (merge m1 m2) &lt;-&gt; In y m1 \/ In y m2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : key),
bst m1 -&gt;
bst m2 -&gt; In y (merge m1 m2) &lt;-&gt; In y m1 \/ In y m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkc9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkc9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : key),
bst m1 -&gt;
bst m2 -&gt; In y (merge m1 m2) &lt;-&gt; In y m1 \/ In y m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkca" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkca"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">functional induction</span> (merge m1 m2);<span class="nb">intros</span>;
  <span class="kp">try</span> factornode _x _x0 _x1 _x2 _x3 <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y s2 &lt;-&gt; In y (Leaf elt) \/ In y s2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkcb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkcb"><hr></label><div class="goal-conclusion"><span class="highlight">In y m1 &lt;-&gt; In y m1 \/ In y (Leaf elt)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkcc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkcc"><hr></label><div class="goal-conclusion"><span class="highlight">In y (bal m1 x d s2&#39;) &lt;-&gt;
In y m1 \/ In y (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkcd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkcd"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y m1 &lt;-&gt; In y m1 \/ In y (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkce" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkce"><hr></label><div class="goal-conclusion"><span class="highlight">In y (bal m1 x d s2&#39;) &lt;-&gt;
In y m1 \/ In y (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkcf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkcf"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (bal m1 x d s2&#39;) &lt;-&gt;
In y m1 \/ In y (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> bal_in, remove_min_in, e1; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">merge_mapsto</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">y</span> <span class="nv">e</span>, bst m1 -&gt; bst m2 -&gt;
  (MapsTo y e (merge m1 m2) &lt;-&gt; MapsTo y e m1 \/ MapsTo y e m2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
bst m1 -&gt;
bst m2 -&gt;
MapsTo y e (merge m1 m2) &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
bst m1 -&gt;
bst m2 -&gt;
MapsTo y e (merge m1 m2) &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd2"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">functional induction</span> (merge m1 m2); <span class="nb">intros</span>;
  <span class="kp">try</span> factornode _x _x0 _x1 _x2 _x3 <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e s2 &lt;-&gt;
MapsTo y e (Leaf elt) \/ MapsTo y e s2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkd3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkd3"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e m1 &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e (Leaf elt)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkd4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkd4"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e (bal m1 x d s2&#39;) &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd5"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e m1 &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkd6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkd6"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e (bal m1 x d s2&#39;) &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd7"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e (bal m1 x d s2&#39;) &lt;-&gt;
MapsTo y e m1 \/ MapsTo y e (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd8"><span class="highlight"><span class="nb">rewrite</span> bal_mapsto, remove_min_mapsto, e1; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e (create m1 x d s2&#39;) &lt;-&gt;
MapsTo y e m1 \/ X.eq y x /\ e = d \/ MapsTo y e s2&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkd9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkd9"><span class="highlight"><span class="nb">unfold</span> create.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e
  (Node m1 x d s2&#39; (max (height m1) (height s2&#39;) + <span class="mi">1</span>)) &lt;-&gt;
MapsTo y e m1 \/ X.eq y x /\ e = d \/ MapsTo y e s2&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkda" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkda"><span class="highlight"><span class="nb">intuition</span>; <span class="nb">subst</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e
  (Node m1 x d s2&#39;
     (max (height m1) (height s2&#39;) + <span class="mi">1</span>))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e m1 \/ X.eq y x /\ e = d \/ MapsTo y e s2&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">inversion_clear</span> H1; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkdb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkdb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">merge_bst</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span>, bst m1 -&gt; bst m2 -&gt;
 (<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key, In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
 bst (merge m1 m2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t elt,
bst m1 -&gt;
bst m2 -&gt;
(<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
 In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
bst (merge m1 m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkdc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkdc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t elt,
bst m1 -&gt;
bst m2 -&gt;
(<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
 In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
bst (merge m1 m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkdd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkdd"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">functional induction</span> (merge m1 m2); <span class="nb">intros</span>; <span class="nb">auto</span>;
 <span class="kp">try</span> factornode _x _x0 _x1 _x2 _x3 <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal m1 x d s2&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkde" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkde"><span class="highlight"><span class="nb">apply</span> bal_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst s2&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkdf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkdf"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x m1</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chke0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chke0"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x s2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke1"><span class="highlight"><span class="nb">generalize</span> (remove_min_bst H0); <span class="nb">rewrite</span> e1; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree x m1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chke2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chke2"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x s2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke3"><span class="highlight"><span class="nb">intro</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chke4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chke4"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x s2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke5"><span class="highlight"><span class="nb">apply</span> H1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In x (Node l2 x2 d2 r2 _x4)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chke6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chke6"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x s2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke7"><span class="highlight"><span class="nb">generalize</span> (remove_min_in l2 x2 d2 r2 _x4 x); <span class="nb">rewrite</span> e1; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (s2&#39;, (x, d))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree x s2&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (remove_min_gt_tree H0); <span class="nb">rewrite</span> e1; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab38"></a><h1 class="section">Deletion</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_in</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span>, bst m -&gt;
 (In y (remove x m) &lt;-&gt; ~ X.eq y x /\ In y m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key),
bst m -&gt; In y (remove x m) &lt;-&gt; ~ X.eq y x /\ In y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chke9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chke9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key),
bst m -&gt; In y (remove x m) &lt;-&gt; ~ X.eq y x /\ In y m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkea" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkea"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (remove x m); <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Leaf elt) &lt;-&gt; ~ X.eq y x /\ In y (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkeb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst l -&gt; In y1 (remove x l) &lt;-&gt; ~ X.eq y1 x /\ In y1 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkeb"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal (remove x l) y d r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkec" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkec"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (merge l r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chked" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chked"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkee" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkee"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst l -&gt; In y1 (remove x l) &lt;-&gt; ~ X.eq y1 x /\ In y1 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (bal (remove x l) y d r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkef" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkef"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (merge l r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkf0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkf0"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight"> <span class="c">(* LT *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkf1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkf1"><span class="highlight">inv bst; <span class="nb">clear</span> e0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst l -&gt; In y1 (remove x l) &lt;-&gt; ~ X.eq y1 x /\ In y1 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (bal (remove x l) y d r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkf2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkf2"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (merge l r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkf3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkf3"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkf4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkf4"><span class="highlight"><span class="nb">rewrite</span> bal_in; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst l -&gt; In y1 (remove x l) &lt;-&gt; ~ X.eq y1 x /\ In y1 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.eq y0 y \/ In y0 (remove x l) \/ In y0 r &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkf5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkf5"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (merge l r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkf6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkf6"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkf7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkf7"><span class="highlight"><span class="nb">generalize</span> (IHt y0 H0); <span class="nb">intuition</span>; [ order | order | intuition_in ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (merge l r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkf8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkf8"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight"> <span class="c">(* EQ *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkf9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkf9"><span class="highlight">inv bst; <span class="nb">clear</span> e0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (merge l r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkfa" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkfa"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkfb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkfb"><span class="highlight"><span class="nb">rewrite</span> merge_in; <span class="nb">intuition</span>; [ order | order | intuition_in ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y0 x -&gt; <span class="kt">False</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y0 y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 l \/ In y0 r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chkfc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chkfc"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkfd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkfd"><span class="highlight"><span class="nb">elim</span> H4; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight"> <span class="c">(* GT *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkfe" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkfe"><span class="highlight">inv bst; <span class="nb">clear</span> e0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (bal l y d (remove x r)) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chkff" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chkff"><span class="highlight"><span class="nb">rewrite</span> bal_in; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, bst r -&gt; In y1 (remove x r) &lt;-&gt; ~ X.eq y1 x /\ In y1 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.eq y0 y \/ In y0 l \/ In y0 (remove x r) &lt;-&gt;
~ X.eq y0 x /\ In y0 (Node l y d r _x)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (IHt y0 H1); <span class="nb">intuition</span>; [ order | order | intuition_in ].</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk100" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk100"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_bst</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; bst (remove x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; bst (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk101" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk101"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; bst (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk102" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk102"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (remove x m); <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk103" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (remove x l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk103"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal (remove x l) y d r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk104" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk104"><hr></label><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk105" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk105"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk106" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk106"><span class="highlight"><span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (remove x l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal (remove x l) y d r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk107" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk107"><hr></label><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk108" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk108"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight"> <span class="c">(* LT *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk109" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk109"><span class="highlight">inv bst.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (remove x l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal (remove x l) y d r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk10a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk10a"><hr></label><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk10b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk10b"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk10c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk10c"><span class="highlight"><span class="nb">apply</span> bal_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (remove x l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree y (remove x l)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk10d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk10d"><hr></label><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk10e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk10e"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk10f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk10f"><span class="highlight"><span class="nb">intro</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (remove x l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 (remove x l)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y0 y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk110" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk110"><hr></label><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk111" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk111"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk112" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk112"><span class="highlight"><span class="nb">rewrite</span> (remove_in x y0 H0) <span class="kr">in</span> H; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = LT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (remove x l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq y0 x /\ In y0 l</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y0 y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk113" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk113"><hr></label><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk114" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk114"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk115" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk115"><span class="highlight"><span class="nb">destruct</span> H; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk116" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk116"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight"> <span class="c">(* EQ *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk117" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk117"><span class="highlight">inv bst.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = EQ _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (merge l r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk118" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk118"><hr></label><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk119" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk119"><span class="highlight"><span class="nb">apply</span> merge_bst; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y d r _x)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight"> <span class="c">(* GT *)</span>
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11a"><span class="highlight">inv bst.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (bal l y d (remove x r))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11b"><span class="highlight"><span class="nb">apply</span> bal_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree y (remove x r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11c"><span class="highlight"><span class="nb">intro</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 (remove x r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11d"><span class="highlight"><span class="nb">rewrite</span> (remove_in x y0 H1) <span class="kr">in</span> H; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.<span class="nb">compare</span> x y = GT _x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (remove x r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq y0 x /\ In y0 r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> H; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span>, bst m -&gt; X.eq x y -&gt; ~ In y (remove x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t),
bst m -&gt; X.eq x y -&gt; ~ In y (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk11f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk11f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t),
bst m -&gt; X.eq x y -&gt; ~ In y (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> remove_in; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk120" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk120"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, bst m -&gt; ~X.eq x y -&gt;
 MapsTo y e m -&gt; MapsTo y e (remove x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
bst m -&gt;
~ X.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk121" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk121"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t) (<span class="nv">e</span> : elt),
bst m -&gt;
~ X.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk122" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk122"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
~ X.eq x y -&gt;
MapsTo y e m1 -&gt; MapsTo y e (remove x m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
~ X.eq x y -&gt;
MapsTo y e m2 -&gt; MapsTo y e (remove x m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (Node m1 k e0 m2 t) -&gt;
~ X.eq x y -&gt;
MapsTo y e (Node m1 k e0 m2 t) -&gt;
MapsTo y e
  <span class="kr">match</span> X.<span class="nb">compare</span> x k <span class="kr">with</span>
  | LT _ =&gt; bal (remove x m1) k e0 m2
  | EQ _ =&gt; merge m1 m2
  | GT _ =&gt; bal m1 k e0 (remove x m2)
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk123" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk123"><span class="highlight"><span class="nb">destruct</span> (X.<span class="nb">compare</span> x k);
   <span class="nb">intros</span>; inv bst; <span class="kp">try</span> <span class="nb">rewrite</span> bal_mapsto; <span class="nb">unfold</span> create; <span class="nb">auto</span>;
   <span class="kp">try</span> <span class="kp">solve</span> [inv MapsTo; <span class="nb">auto</span>].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
~ X.eq x y -&gt;
MapsTo y e m1 -&gt; MapsTo y e (remove x m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
~ X.eq x y -&gt;
MapsTo y e m2 -&gt; MapsTo y e (remove x m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x k</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e (Node m1 k e0 m2 t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e (merge m1 m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk124" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk124"><span class="highlight"><span class="nb">rewrite</span> merge_mapsto; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
~ X.eq x y -&gt;
MapsTo y e m1 -&gt; MapsTo y e (remove x m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
~ X.eq x y -&gt;
MapsTo y e m2 -&gt; MapsTo y e (remove x m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x k</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">~ X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y e (Node m1 k e0 m2 t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e m1 \/ MapsTo y e m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">inv MapsTo; <span class="nb">auto</span>; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk125" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk125"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_3</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, bst m -&gt;
 MapsTo y e (remove x m) -&gt; MapsTo y e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
bst m -&gt; MapsTo y e (remove x m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk126" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk126"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
bst m -&gt; MapsTo y e (remove x m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk127" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk127"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (Node m1 k e0 m2 t) -&gt;
MapsTo y e
  <span class="kr">match</span> X.<span class="nb">compare</span> x k <span class="kr">with</span>
  | LT _ =&gt; bal (remove x m1) k e0 m2
  | EQ _ =&gt; merge m1 m2
  | GT _ =&gt; bal m1 k e0 (remove x m2)
  <span class="kr">end</span> -&gt; MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk128" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk128"><span class="highlight"><span class="nb">destruct</span> (X.<span class="nb">compare</span> x k); <span class="nb">intros</span> Bs; inv bst;
  <span class="kp">try</span> <span class="nb">rewrite</span> bal_mapsto; <span class="nb">auto</span>; <span class="nb">unfold</span> create.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x k</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e
  (Node (remove x m1) k e0 m2
     (max (height (remove x m1)) (height m2) + <span class="mi">1</span>)) -&gt;
MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk129" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x k</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk129"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e (merge m1 m2) -&gt;
MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk12a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt k x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk12a"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e
  (Node m1 k e0 (remove x m2)
     (max (height m1) (height (remove x m2)) + <span class="mi">1</span>)) -&gt;
MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk12b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk12b"><span class="highlight"><span class="nb">intros</span>; inv MapsTo; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x k</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e (merge m1 m2) -&gt;
MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk12c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt k x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk12c"><hr></label><div class="goal-conclusion"><span class="highlight">MapsTo y e
  (Node m1 k e0 (remove x m2)
     (max (height m1) (height (remove x m2)) + <span class="mi">1</span>)) -&gt;
MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk12d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk12d"><span class="highlight"><span class="nb">rewrite</span> merge_mapsto; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt;
MapsTo y e (remove x m1) -&gt; MapsTo y e m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt;
MapsTo y e (remove x m2) -&gt; MapsTo y e m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt k x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree k m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree k m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo y e
  (Node m1 k e0 (remove x m2)
     (max (height m1) (height (remove x m2)) + <span class="mi">1</span>)) -&gt;
MapsTo y e (Node m1 k e0 m2 t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; inv MapsTo; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab39"></a><h1 class="section">join</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk12e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk12e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">join_in</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">r</span> <span class="nv">y</span>,
 In y (join l x d r) &lt;-&gt; X.eq y x \/ In y l \/ In y r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key),
In y (join l x d r) &lt;-&gt; X.eq y x \/ In y l \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk12f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk12f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : key),
In y (join l x d r) &lt;-&gt; X.eq y x \/ In y l \/ In y r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk130" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk130"><span class="highlight">join_tac.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (join (Leaf elt) x d r) &lt;-&gt;
X.eq y x \/ In y (Leaf elt) \/ In y r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk131" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk131"><hr></label><div class="goal-conclusion"><span class="highlight">In y (add x d (Node ll lx ld lr lh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/ In y (Leaf elt)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk132" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk132"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal ll lx ld (join lr x d (Node rl rx rd rr rh))) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk133" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk133"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal (join (Node ll lx ld lr lh) x d rl) rx rd rr) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk134" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &lt;= lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk134"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk135" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk135"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (add x d r) &lt;-&gt;
X.eq y x \/ In y (Leaf elt) \/ In y r</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk136" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk136"><hr></label><div class="goal-conclusion"><span class="highlight">In y (add x d (Node ll lx ld lr lh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/ In y (Leaf elt)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk137" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk137"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal ll lx ld (join lr x d (Node rl rx rd rr rh))) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk138" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk138"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal (join (Node ll lx ld lr lh) x d rl) rx rd rr) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk139" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &lt;= lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk139"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk13a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk13a"><span class="highlight"><span class="nb">rewrite</span> add_in; intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (add x d (Node ll lx ld lr lh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/ In y (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk13b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk13b"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal ll lx ld (join lr x d (Node rl rx rd rr rh))) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk13c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk13c"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal (join (Node ll lx ld lr lh) x d rl) rx rd rr) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk13d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &lt;= lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk13d"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk13e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk13e"><span class="highlight"><span class="nb">rewrite</span> add_in; intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y
  (bal ll lx ld (join lr x d (Node rl rx rd rr rh))) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk13f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk13f"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (bal (join (Node ll lx ld lr lh) x d rl) rx rd rr) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk140" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &lt;= lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk140"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk141" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk141"><span class="highlight"><span class="nb">rewrite</span> bal_in, Hlr; <span class="nb">clear</span> Hlr Hrl; intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y
  (bal (join (Node ll lx ld lr lh) x d rl) rx rd rr) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk142" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &lt;= lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk142"><hr></label><div class="goal-conclusion"><span class="highlight">In y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk143" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk143"><span class="highlight"><span class="nb">rewrite</span> bal_in, Hrl; <span class="nb">clear</span> Hlr Hrl; intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : key),
In y0 (join lr x0 d0 r) &lt;-&gt; X.eq y0 x0 \/ In y0 lr \/ In y0 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (join (Node ll lx ld lr lh) x d rl) &lt;-&gt;
X.eq y0 x \/ In y0 (Node ll lx ld lr lh) \/ In y0 rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &lt;= lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh)) &lt;-&gt;
X.eq y x \/
In y (Node ll lx ld lr lh) \/
In y (Node rl rx rd rr rh)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> create_in.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk144" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk144"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">join_bst</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">r</span>, bst l -&gt; bst r -&gt;
 lt_tree x l -&gt; gt_tree x r -&gt; bst (join l x d r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">d</span> : elt) (<span class="nv">r</span> : t elt),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt; gt_tree x r -&gt; bst (join l x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk145" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk145"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">d</span> : elt) (<span class="nv">r</span> : t elt),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt; gt_tree x r -&gt; bst (join l x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk146" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk146"><span class="highlight">join_tac; <span class="nb">auto</span>; <span class="kp">try</span> (<span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="kp">fail</span>); inv bst; <span class="nb">apply</span> bal_bst; <span class="nb">auto</span>;
 <span class="nb">clear</span> Hrl Hlr; <span class="nb">intro</span>; <span class="nb">intros</span>; <span class="nb">rewrite</span> join_in <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x \/ In y lr \/ In y (Node rl rx rd rr rh)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt lx y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk147" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x \/ In y (Node ll lx ld lr lh) \/ In y rl</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk147"><hr></label><div class="goal-conclusion"><span class="highlight">X.lt y rx</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk148" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk148"><span class="highlight"><span class="nb">intuition</span>; [ <span class="nb">apply</span> MX.lt_eq <span class="kr">with</span> x | ]; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x \/ In y (Node ll lx ld lr lh) \/ In y rl</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y rx</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intuition</span>; [ <span class="nb">apply</span> MX.eq_lt <span class="kr">with</span> x | ]; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> join_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk149" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk149"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">join_find</span> : <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">r</span> <span class="nv">y</span>,
 bst l -&gt; bst r -&gt; lt_tree x l -&gt; gt_tree x r -&gt;
 find y (join l x d r) = find y (create l x d r).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">d</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : X.t),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt;
gt_tree x r -&gt;
find y (join l x d r) = find y (create l x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk14a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk14a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">d</span> : elt) (<span class="nv">r</span> : t elt)
  (<span class="nv">y</span> : X.t),
bst l -&gt;
bst r -&gt;
lt_tree x l -&gt;
gt_tree x r -&gt;
find y (join l x d r) = find y (create l x d r)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk14b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk14b"><span class="highlight">join_tac; <span class="nb">auto</span>; inv bst;
  <span class="nb">simpl</span> (join (Leaf elt));
  <span class="kp">try</span> (<span class="nb">assert</span> (X.lt lx x) <span class="bp">by</span> <span class="nb">auto</span>);
  <span class="kp">try</span> (<span class="nb">assert</span> (X.lt x rx) <span class="bp">by</span> <span class="nb">auto</span>);
  <span class="nb">rewrite</span> ?add_find, ?bal_find; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some d
| _ =&gt; find y r
<span class="kr">end</span> = find y (create (Leaf elt) x d r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk14c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk14c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some d
| _ =&gt; find y (Node ll lx ld lr lh)
<span class="kr">end</span> =
find y (create (Node ll lx ld lr lh) x d (Leaf elt))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk14d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk14d"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create ll lx ld (join lr x d (Node rl rx rd rr rh))) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk14e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk14e"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk14f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk14f"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk150" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk150"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk151" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk151"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y r = None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk152" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk152"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some d
| _ =&gt; find y (Node ll lx ld lr lh)
<span class="kr">end</span> =
find y (create (Node ll lx ld lr lh) x d (Leaf elt))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk153" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk153"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create ll lx ld (join lr x d (Node rl rx rd rr rh))) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk154" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk154"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk155" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk155"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk156" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk156"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk157" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk157"><span class="highlight"><span class="nb">rewrite</span> not_find_iff; <span class="nb">auto</span>; <span class="nb">intro</span>; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| EQ _ =&gt; Some d
| _ =&gt; find y (Node ll lx ld lr lh)
<span class="kr">end</span> =
find y (create (Node ll lx ld lr lh) x d (Leaf elt))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk158" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk158"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create ll lx ld (join lr x d (Node rl rx rd rr rh))) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk159" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk159"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk15a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk15a"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk15b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk15b"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk15c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk15c"><span class="highlight"><span class="nb">simpl</span>; <span class="kp">repeat</span> (<span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>); <span class="kp">try</span> (order; <span class="kp">fail</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y lr = None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk15d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk15d"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create ll lx ld (join lr x d (Node rl rx rd rr rh))) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk15e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk15e"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk15f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk15f"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk160" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk160"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk161" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk161"><span class="highlight"><span class="nb">rewrite</span> not_find_iff <span class="bp">by</span> <span class="nb">auto</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y lr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk162" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk162"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create ll lx ld (join lr x d (Node rl rx rd rr rh))) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk163" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk163"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk164" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk164"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk165" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk165"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk166" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk166"><span class="highlight"><span class="nb">assert</span> (X.lt y x) <span class="bp">by</span> <span class="nb">auto</span>; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y
  (create ll lx ld (join lr x d (Node rl rx rd rr rh))) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk167" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk167"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk168" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk168"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk169" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk169"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk16a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk16a"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">rewrite</span> Hlr; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y lx <span class="kr">with</span>
| LT _ =&gt; find y ll
| EQ _ =&gt; Some ld
| GT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
    | LT _ =&gt; find y lr
    | EQ _ =&gt; Some d
    | GT _ =&gt;
        <span class="kr">match</span> X.<span class="nb">compare</span> y rx <span class="kr">with</span>
        | LT _ =&gt; find y rl
        | EQ _ =&gt; Some rd
        | GT _ =&gt; find y rr
        <span class="kr">end</span>
    <span class="kr">end</span>
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| LT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y lx <span class="kr">with</span>
    | LT _ =&gt; find y ll
    | EQ _ =&gt; Some ld
    | GT _ =&gt; find y lr
    <span class="kr">end</span>
| EQ _ =&gt; Some d
| GT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y rx <span class="kr">with</span>
    | LT _ =&gt; find y rl
    | EQ _ =&gt; Some rd
    | GT _ =&gt; find y rr
    <span class="kr">end</span>
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk16b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk16b"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk16c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk16c"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk16d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk16d"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk16e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk16e"><span class="highlight"><span class="kp">repeat</span> (<span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree lx (join lr x d (Node rl rx rd rr rh))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk16f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk16f"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk170" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk170"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk171" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk171"><span class="highlight"><span class="nb">intros</span> u Hu; <span class="nb">rewrite</span> join_in <span class="kr">in</span> Hu.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &gt; rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hu</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq u x \/ In u lr \/ In u (Node rl rx rd rr rh)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt lx u</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk172" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk172"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk173" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk173"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk174" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk174"><span class="highlight"><span class="nb">destruct</span> Hu <span class="kr">as</span> [Hu|[Hu|Hu]]; <span class="kp">try</span> <span class="nb">generalize</span> (H2 _ Hu); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y
  (create (join (Node ll lx ld lr lh) x d rl) rx rd rr) =
find y
  (create (Node ll lx ld lr lh) x d
     (Node rl rx rd rr rh))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk175" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk175"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk176" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk176"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">rewrite</span> Hrl; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y rx <span class="kr">with</span>
| LT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
    | LT _ =&gt;
        <span class="kr">match</span> X.<span class="nb">compare</span> y lx <span class="kr">with</span>
        | LT _ =&gt; find y ll
        | EQ _ =&gt; Some ld
        | GT _ =&gt; find y lr
        <span class="kr">end</span>
    | EQ _ =&gt; Some d
    | GT _ =&gt; find y rl
    <span class="kr">end</span>
| EQ _ =&gt; Some rd
| GT _ =&gt; find y rr
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| LT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y lx <span class="kr">with</span>
    | LT _ =&gt; find y ll
    | EQ _ =&gt; Some ld
    | GT _ =&gt; find y lr
    <span class="kr">end</span>
| EQ _ =&gt; Some d
| GT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y rx <span class="kr">with</span>
    | LT _ =&gt; find y rl
    | EQ _ =&gt; Some rd
    | GT _ =&gt; find y rr
    <span class="kr">end</span>
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk177" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk177"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk178" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk178"><span class="highlight"><span class="kp">repeat</span> (<span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree rx (join (Node ll lx ld lr lh) x d rl)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk179" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk179"><span class="highlight"><span class="nb">intros</span> u Hu; <span class="nb">rewrite</span> join_in <span class="kr">in</span> Hu.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ld</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">lh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">d0</span> : elt) (<span class="nv">r</span> : t elt) (<span class="nv">y0</span> : X.t),
bst lr -&gt;
bst r -&gt;
lt_tree x0 lr -&gt;
gt_tree x0 r -&gt; find y0 (join lr x0 d0 r) = find y0 (create lr x0 d0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rx</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rh</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t,
bst (Node ll lx ld lr lh) -&gt;
bst rl -&gt;
lt_tree x (Node ll lx ld lr lh) -&gt;
gt_tree x rl -&gt;
find y0 (join (Node ll lx ld lr lh) x d rl) =
find y0 (create (Node ll lx ld lr lh) x d rl)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">LE</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lh &lt;= rh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">GT'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">rh &gt; lh + <span class="mi">2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x (Node ll lx ld lr lh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x (Node rl rx rd rr rh)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree rx rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree rx rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree lx ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree lx lr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt lx x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x rx</span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hu</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq u x \/ In u (Node ll lx ld lr lh) \/ In u rl</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt u rx</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> Hu <span class="kr">as</span> [Hu|[Hu|Hu]]; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab40"></a><h1 class="section">split</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk17a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk17a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_in_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; <span class="kr">forall</span> <span class="nv">y</span>,
 (In y (<span class="nb">split</span> x m)#l &lt;-&gt; In y m /\ X.lt y x).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
<span class="kr">forall</span> <span class="nv">y</span> : key,
In y (<span class="nb">split</span> x m)#l &lt;-&gt; In y m /\ X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk17b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk17b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
<span class="kr">forall</span> <span class="nv">y</span> : key,
In y (<span class="nb">split</span> x m)#l &lt;-&gt; In y m /\ X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk17c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk17c"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (<span class="nb">split</span> x m); <span class="nb">simpl</span>; <span class="nb">intros</span>;
  inv bst; <span class="kp">try</span> <span class="nb">clear</span> e0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Leaf elt) &lt;-&gt; In y (Leaf elt) /\ X.lt y x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk17d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x l)#l &lt;-&gt; In y1 l /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk17d"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 ll &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk17e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk17e"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 l &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk17f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#l &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk17f"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (join l y d rl) &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk180" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk180"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x l)#l &lt;-&gt; In y1 l /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 ll &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk181" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk181"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 l &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk182" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#l &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk182"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (join l y d rl) &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk183" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk183"><span class="highlight"><span class="nb">rewrite</span> e1 <span class="kr">in</span> IHt; <span class="nb">simpl</span> <span class="kr">in</span> IHt; <span class="nb">rewrite</span> IHt; intuition_in; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 l &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk184" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#l &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk184"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (join l y d rl) &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk185" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk185"><span class="highlight">intuition_in; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#l &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (join l y d rl) &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk186" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk186"><span class="highlight"><span class="nb">rewrite</span> join_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#l &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.eq y0 y \/ In y0 l \/ In y0 rl &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt y0 x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> e1 <span class="kr">in</span> IHt; <span class="nb">simpl</span> <span class="kr">in</span> IHt; <span class="nb">rewrite</span> IHt; intuition_in; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk187" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk187"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_in_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; <span class="kr">forall</span> <span class="nv">y</span>,
 (In y (<span class="nb">split</span> x m)#r &lt;-&gt; In y m /\ X.lt x y).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
<span class="kr">forall</span> <span class="nv">y</span> : key,
In y (<span class="nb">split</span> x m)#r &lt;-&gt; In y m /\ X.lt x y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk188" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk188"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt;
<span class="kr">forall</span> <span class="nv">y</span> : key,
In y (<span class="nb">split</span> x m)#r &lt;-&gt; In y m /\ X.lt x y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk189" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk189"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (<span class="nb">split</span> x m); <span class="nb">subst</span>; <span class="nb">simpl</span>; <span class="nb">intros</span>;
  inv bst; <span class="kp">try</span> <span class="nb">clear</span> e0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Leaf elt) &lt;-&gt; In y (Leaf elt) /\ X.lt x y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk18a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x l)#r &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk18a"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 (join rl y d r) &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk18b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk18b"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 r &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk18c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#r &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk18c"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 rr &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk18d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk18d"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x l)#r &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 (join rl y d r) &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk18e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk18e"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 r &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk18f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#r &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk18f"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 rr &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk190" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk190"><span class="highlight"><span class="nb">rewrite</span> join_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x l)#r &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.eq y0 y \/ In y0 rl \/ In y0 r &lt;-&gt;
In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk191" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk191"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 r &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk192" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#r &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk192"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 rr &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk193" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk193"><span class="highlight"><span class="nb">rewrite</span> e1 <span class="kr">in</span> IHt; <span class="nb">simpl</span> <span class="kr">in</span> IHt; <span class="nb">rewrite</span> IHt; intuition_in; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 r &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk194" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#r &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk194"><hr></label><div class="goal-conclusion"><span class="highlight">In y0 rr &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk195" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk195"><span class="highlight">intuition_in; order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; <span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 (<span class="nb">split</span> x r)#r &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 rr &lt;-&gt; In y0 (Node l y d r _x) /\ X.lt x y0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> e1 <span class="kr">in</span> IHt; <span class="nb">simpl</span> <span class="kr">in</span> IHt; <span class="nb">rewrite</span> IHt; intuition_in; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk196" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk196"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_in_3</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt;
 (<span class="nb">split</span> x m)#o = find x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; (<span class="nb">split</span> x m)#o = find x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk197" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk197"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; (<span class="nb">split</span> x m)#o = find x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (<span class="nb">split</span> x m); <span class="nb">subst</span>; <span class="nb">simpl</span>; <span class="nb">auto</span>;
  <span class="nb">intros</span>; inv bst; <span class="kp">try</span> <span class="nb">clear</span> e0;
  <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="kp">try</span> order; <span class="nb">trivial</span>; <span class="nb">rewrite</span> &lt;- IHt, e1; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk198" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk198"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_bst</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt;
 bst (<span class="nb">split</span> x m)#l /\ bst (<span class="nb">split</span> x m)#r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; bst (<span class="nb">split</span> x m)#l /\ bst (<span class="nb">split</span> x m)#r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk199" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk199"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; bst (<span class="nb">split</span> x m)#l /\ bst (<span class="nb">split</span> x m)#r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk19a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk19a"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (<span class="nb">split</span> x m); <span class="nb">subst</span>; <span class="nb">simpl</span>; <span class="nb">intros</span>;
  inv bst; <span class="kp">try</span> <span class="nb">clear</span> e0; <span class="kp">try</span> <span class="nb">rewrite</span> e1 <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">intuition</span>;
  <span class="nb">apply</span> join_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree y rl</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk19b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk19b"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree y rl</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk19c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk19c"><span class="highlight"><span class="nb">intros</span> y0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 rl -&gt; X.lt y0 y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk19d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk19d"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree y rl</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk19e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk19e"><span class="highlight"><span class="nb">generalize</span> (split_in_2 x H0 y0); <span class="nb">rewrite</span> e1; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree y rl</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk19f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk19f"><span class="highlight"><span class="nb">intros</span> y0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y0 rl -&gt; X.lt y y0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (split_in_1 x H1 y0); <span class="nb">rewrite</span> e1; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_lt_tree</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; lt_tree x (<span class="nb">split</span> x m)#l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; lt_tree x (<span class="nb">split</span> x m)#l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; lt_tree x (<span class="nb">split</span> x m)#l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x B y Hy; <span class="nb">rewrite</span> split_in_1 <span class="kr">in</span> Hy; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_gt_tree</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, bst m -&gt; gt_tree x (<span class="nb">split</span> x m)#r.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; gt_tree x (<span class="nb">split</span> x m)#r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : X.t),
bst m -&gt; gt_tree x (<span class="nb">split</span> x m)#r</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x B y Hy; <span class="nb">rewrite</span> split_in_2 <span class="kr">in</span> Hy; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_find</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span>, bst m -&gt;
 find y m = <span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
              | LT _ =&gt; find y (<span class="nb">split</span> x m)#l
              | EQ _ =&gt; (<span class="nb">split</span> x m)#o
              | GT _ =&gt; find y (<span class="nb">split</span> x m)#r
            <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t),
bst m -&gt;
find y m =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| LT _ =&gt; find y (<span class="nb">split</span> x m)#l
| EQ _ =&gt; (<span class="nb">split</span> x m)#o
| GT _ =&gt; find y (<span class="nb">split</span> x m)#r
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : X.t),
bst m -&gt;
find y m =
<span class="kr">match</span> X.<span class="nb">compare</span> y x <span class="kr">with</span>
| LT _ =&gt; find y (<span class="nb">split</span> x m)#l
| EQ _ =&gt; (<span class="nb">split</span> x m)#o
| GT _ =&gt; find y (<span class="nb">split</span> x m)#r
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a6"><span class="highlight"><span class="nb">intros</span> m x; <span class="nb">functional induction</span> (<span class="nb">split</span> x m); <span class="nb">subst</span>; <span class="nb">simpl</span>; <span class="nb">intros</span>;
  inv bst; <span class="kp">try</span> <span class="nb">clear</span> e0; <span class="kp">try</span> <span class="nb">rewrite</span> e1 <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *;
  [ <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span> | .. ];
  <span class="kp">try</span> <span class="kr">match goal with</span> E:<span class="nb">split</span> ?x ?t = _, B:bst ?t |- _ =&gt;
      <span class="nb">generalize</span> (split_in_1 x B)(split_in_2 x B)(split_bst x B);
       <span class="nb">rewrite</span> E; <span class="nb">simpl</span>; <span class="nb">destruct</span> <span class="mi">3</span> <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : X.t,
bst l -&gt;
find y1 l =
<span class="kr">match</span> X.<span class="nb">compare</span> y1 x <span class="kr">with</span>
| LT _ =&gt; find y1 ll
| EQ _ =&gt; o
| GT _ =&gt; find y1 rl
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 ll &lt;-&gt; In y1 l /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rl &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 ll
| EQ _ =&gt; o
| GT _ =&gt; find y0 (join rl y d r)
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1a7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1a7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1a8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : X.t,
bst r -&gt;
find y1 r =
<span class="kr">match</span> X.<span class="nb">compare</span> y1 x <span class="kr">with</span>
| LT _ =&gt; find y1 rl
| EQ _ =&gt; o
| GT _ =&gt; find y1 rr
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1a8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 (join l y d rl)
| EQ _ =&gt; o
| GT _ =&gt; find y0 rr
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1a9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1a9"><span class="highlight"><span class="nb">rewrite</span> join_find, IHt; <span class="nb">auto</span>; <span class="nb">clear</span> IHt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 ll &lt;-&gt; In y1 l /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rl &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
    | LT _ =&gt; find y0 ll
    | EQ _ =&gt; o
    | GT _ =&gt; find y0 rl
    <span class="kr">end</span>
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 ll
| EQ _ =&gt; o
| GT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
    | LT _ =&gt; find y0 rl
    | EQ _ =&gt; Some d
    | GT _ =&gt; find y0 r
    <span class="kr">end</span>
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1aa" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 ll &lt;-&gt; In y1 l /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rl &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1aa"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree y rl</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1ab" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1ab"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1ac" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : X.t,
bst r -&gt;
find y1 r =
<span class="kr">match</span> X.<span class="nb">compare</span> y1 x <span class="kr">with</span>
| LT _ =&gt; find y1 rl
| EQ _ =&gt; o
| GT _ =&gt; find y1 rr
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1ac"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 (join l y d rl)
| EQ _ =&gt; o
| GT _ =&gt; find y0 rr
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ad" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ad"><span class="highlight"><span class="kp">repeat</span> (<span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">ll</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x l = &lt;&lt; ll, o, rl &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 ll &lt;-&gt; In y1 l /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rl &lt;-&gt; In y1 l /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst ll</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree y rl</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1ae" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1ae"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1af" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : X.t,
bst r -&gt;
find y1 r =
<span class="kr">match</span> X.<span class="nb">compare</span> y1 x <span class="kr">with</span>
| LT _ =&gt; find y1 rl
| EQ _ =&gt; o
| GT _ =&gt; find y1 rr
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1af"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 (join l y d rl)
| EQ _ =&gt; o
| GT _ =&gt; find y0 rr
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b0"><span class="highlight"><span class="nb">intro</span> y1; <span class="nb">rewrite</span> H4; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1b1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : X.t,
bst r -&gt;
find y1 r =
<span class="kr">match</span> X.<span class="nb">compare</span> y1 x <span class="kr">with</span>
| LT _ =&gt; find y1 rl
| EQ _ =&gt; o
| GT _ =&gt; find y1 rr
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1b1"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 (join l y d rl)
| EQ _ =&gt; o
| GT _ =&gt; find y0 rr
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b2"><span class="highlight"><span class="kp">repeat</span> (<span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : X.t,
bst r -&gt;
find y1 r =
<span class="kr">match</span> X.<span class="nb">compare</span> y1 x <span class="kr">with</span>
| LT _ =&gt; find y1 rl
| EQ _ =&gt; o
| GT _ =&gt; find y1 rr
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt; find y0 r
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt; find y0 (join l y d rl)
| EQ _ =&gt; o
| GT _ =&gt; find y0 rr
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b3"><span class="highlight"><span class="nb">rewrite</span> join_find, IHt; <span class="nb">auto</span>; <span class="nb">clear</span> IHt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
| LT _ =&gt; find y0 l
| EQ _ =&gt; Some d
| GT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
    | LT _ =&gt; find y0 rl
    | EQ _ =&gt; o
    | GT _ =&gt; find y0 rr
    <span class="kr">end</span>
<span class="kr">end</span> =
<span class="kr">match</span> X.<span class="nb">compare</span> y0 x <span class="kr">with</span>
| LT _ =&gt;
    <span class="kr">match</span> X.<span class="nb">compare</span> y0 y <span class="kr">with</span>
    | LT _ =&gt; find y0 l
    | EQ _ =&gt; Some d
    | GT _ =&gt; find y0 rl
    <span class="kr">end</span>
| EQ _ =&gt; o
| GT _ =&gt; find y0 rr
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1b4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1b4"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree y rl</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b5"><span class="highlight"><span class="kp">repeat</span> (<span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>); order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">rr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x r = &lt;&lt; rl, o, rr &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key, In y1 rl &lt;-&gt; In y1 r /\ X.lt y1 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> : key,
In y1 rr &lt;-&gt; In y1 r /\ X.lt x y1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rl</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst rr</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree y rl</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> y1; <span class="nb">rewrite</span> H; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab41"></a><h1 class="section">Concatenation</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">concat_in</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">y</span>,
 In y (concat m1 m2) &lt;-&gt; In y m1 \/ In y m2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : key),
In y (concat m1 m2) &lt;-&gt; In y m1 \/ In y m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : key),
In y (concat m1 m2) &lt;-&gt; In y m1 \/ In y m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1b8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1b8"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">functional induction</span> (concat m1 m2); <span class="nb">intros</span>;
  <span class="kp">try</span> factornode _x _x0 _x1 _x2 _x3 <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y m2 &lt;-&gt; In y (Leaf elt) \/ In y m2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1b9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1b9"><hr></label><div class="goal-conclusion"><span class="highlight">In y m1 &lt;-&gt; In y m1 \/ In y (Leaf elt)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1ba" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1ba"><hr></label><div class="goal-conclusion"><span class="highlight">In y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) &lt;-&gt;
In y m1 \/ In y (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1bb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1bb"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y m1 &lt;-&gt; In y m1 \/ In y (Leaf elt)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1bc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1bc"><hr></label><div class="goal-conclusion"><span class="highlight">In y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) &lt;-&gt;
In y m1 \/ In y (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1bd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1bd"><span class="highlight">intuition_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) &lt;-&gt;
In y m1 \/ In y (Node l2 x2 d2 r2 _x4)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> join_in, remove_min_in, e1; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1be" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1be"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">concat_bst</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span>, bst m1 -&gt; bst m2 -&gt;
 (<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span>, In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
 bst (concat m1 m2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t elt,
bst m1 -&gt;
bst m2 -&gt;
(<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
 In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
bst (concat m1 m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1bf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1bf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t elt,
bst m1 -&gt;
bst m2 -&gt;
(<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
 In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
bst (concat m1 m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1c0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1c0"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">functional induction</span> (concat m1 m2); <span class="nb">intros</span>; <span class="nb">auto</span>;
 <span class="kp">try</span> factornode _x _x0 _x1 _x2 _x3 <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1c1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1c1"><span class="highlight"><span class="nb">apply</span> join_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst m2&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1c2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1c2"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1c3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1c3"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1c4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1c4"><span class="highlight"><span class="nb">change</span> (bst (m2&#39;,xd)#<span class="mi">1</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (m2&#39;, xd)#<span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1c5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1c5"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1c6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1c6"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1c7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1c7"><span class="highlight"><span class="nb">rewrite</span> &lt;-e1; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1c8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1c8"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1c9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1c9"><span class="highlight"><span class="nb">intros</span> y Hy.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y xd#<span class="mi">1</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1ca" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1ca"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1cb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1cb"><span class="highlight"><span class="nb">apply</span> H1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In xd#<span class="mi">1</span> (Node l2 x2 d2 r2 _x4)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1cc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1cc"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1cd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1cd"><span class="highlight"><span class="nb">rewrite</span> remove_min_in, e1; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ce" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ce"><span class="highlight"><span class="nb">change</span> (gt_tree (m2&#39;,xd)#<span class="mi">2</span>#<span class="mi">1</span> (m2&#39;,xd)#<span class="mi">1</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree ((m2&#39;, xd)#<span class="mi">2</span>)#<span class="mi">1</span> (m2&#39;, xd)#<span class="mi">1</span></span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> &lt;-e1; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> concat_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1cf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1cf"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">concat_find</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">y</span>, bst m1 -&gt; bst m2 -&gt;
 (<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span>, In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
 find y (concat m1 m2) =
  <span class="kr">match</span> find y m2 <span class="kr">with</span> Some d =&gt; Some d | None =&gt; find y m1 <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : X.t),
bst m1 -&gt;
bst m2 -&gt;
(<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
 In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
find y (concat m1 m2) =
<span class="kr">match</span> find y m2 <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t elt) (<span class="nv">y</span> : X.t),
bst m1 -&gt;
bst m2 -&gt;
(<span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
 In y1 m1 -&gt; In y2 m2 -&gt; X.lt y1 y2) -&gt;
find y (concat m1 m2) =
<span class="kr">match</span> find y m2 <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d1"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">functional induction</span> (concat m1 m2); <span class="nb">intros</span>; <span class="nb">auto</span>;
 <span class="kp">try</span> factornode _x _x0 _x1 _x2 _x3 <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (Leaf elt) -&gt; In y2 m2 -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y m2 =
<span class="kr">match</span> find y m2 <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (Leaf elt)
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1d2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1d2"><hr></label><div class="goal-conclusion"><span class="highlight">find y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) =
<span class="kr">match</span> find y (Node l2 x2 d2 r2 _x4) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d3"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">destruct</span> (find y m2); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) =
<span class="kr">match</span> find y (Node l2 x2 d2 r2 _x4) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d4"><span class="highlight"><span class="nb">generalize</span> (remove_min_find y H0)(remove_min_in l2 x2 d2 r2 _x4)
  (remove_min_bst H0)(remove_min_gt_tree H0);
  <span class="nb">rewrite</span> e1; <span class="nb">simpl</span> fst; <span class="nb">simpl</span> snd; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l2 x2 d2 r2 _x4)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y (Node l2 x2 d2 r2 _x4) =
<span class="kr">match</span> X.<span class="nb">compare</span> y xd#<span class="mi">1</span> <span class="kr">with</span>
| LT _ =&gt; None
| EQ _ =&gt; Some xd#<span class="mi">2</span>
| GT _ =&gt; find y m2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) =
<span class="kr">match</span> find y (Node l2 x2 d2 r2 _x4) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d5"><span class="highlight">inv bst.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y (Node l2 x2 d2 r2 _x4) =
<span class="kr">match</span> X.<span class="nb">compare</span> y xd#<span class="mi">1</span> <span class="kr">with</span>
| LT _ =&gt; None
| EQ _ =&gt; Some xd#<span class="mi">2</span>
| GT _ =&gt; find y m2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (join m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) =
<span class="kr">match</span> find y (Node l2 x2 d2 r2 _x4) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d6"><span class="highlight"><span class="nb">rewrite</span> H2, join_find; <span class="nb">auto</span>; <span class="nb">clear</span> H2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (create m1 xd#<span class="mi">1</span> xd#<span class="mi">2</span> m2&#39;) =
<span class="kr">match</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y xd#<span class="mi">1</span> <span class="kr">with</span>
  | LT _ =&gt; None
  | EQ _ =&gt; Some xd#<span class="mi">2</span>
  | GT _ =&gt; find y m2&#39;
  <span class="kr">end</span>
<span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1d7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1d7"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1d8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1d8"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">destruct</span> X.<span class="nb">compare</span> <span class="kr">as</span> [Hlt| |Hlt]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt xd#<span class="mi">1</span> y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y m2&#39; =
<span class="kr">match</span> find y m2&#39; <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y m1
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1d9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1d9"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1da" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1da"><span class="highlight"><span class="nb">destruct</span> (find y m2&#39;); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt xd#<span class="mi">1</span> y</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">None = find y m1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1db" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1db"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1dc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1dc"><span class="highlight"><span class="nb">symmetry</span>; <span class="nb">rewrite</span> not_find_iff; <span class="nb">auto</span>; <span class="nb">intro</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt xd#<span class="mi">1</span> y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1dd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1dd"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1de" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1de"><span class="highlight"><span class="nb">apply</span> (MX.lt_not_gt Hlt); <span class="nb">apply</span> H1; <span class="nb">auto</span>; <span class="nb">rewrite</span> H3; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">xd</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(key * elt)%type</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">remove_min l2 x2 d2 r2 = (m2&#39;, xd)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 m1 -&gt;
In y2 (Node l2 x2 d2 r2 _x4) -&gt; X.lt y1 y2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 (Node l2 x2 d2 r2 _x4) &lt;-&gt;
X.eq y0 xd#<span class="mi">1</span> \/ In y0 m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree xd#<span class="mi">1</span> m2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x2 l2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x2 r2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree xd#<span class="mi">1</span> m1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> z Hz; <span class="nb">apply</span> H1; <span class="nb">auto</span>; <span class="nb">rewrite</span> H3; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab42"></a><h1 class="section">Elements</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">eqk</span> := (PX.eqk (elt:= elt)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">eqke</span> := (PX.eqke (elt:= elt)).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">ltk</span> := (PX.ltk (elt:= elt)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1df" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1df"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_aux_mapsto</span> : <span class="kr">forall</span> (<span class="nv">s</span>:t elt) <span class="nv">acc</span> <span class="nv">x</span> <span class="nv">e</span>,
 InA eqke (x,e) (elements_aux acc s) &lt;-&gt; MapsTo x e s \/ InA eqke (x,e) acc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x</span> : X.t)
  (<span class="nv">e</span> : elt),
InA eqke (x, e) (elements_aux acc s) &lt;-&gt;
MapsTo x e s \/ InA eqke (x, e) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x</span> : X.t)
  (<span class="nv">e</span> : elt),
InA eqke (x, e) (elements_aux acc s) &lt;-&gt;
MapsTo x e s \/ InA eqke (x, e) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e1"><span class="highlight"><span class="nb">induction</span> s <span class="kr">as</span> [ | l Hl x e r Hr h ]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
InA eqke (x, e) acc &lt;-&gt;
MapsTo x e (Leaf elt) \/ InA eqke (x, e) acc</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1e2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t)
  (<span class="nv">e0</span> : elt),
InA eqke (x0, e0) (elements_aux acc l) &lt;-&gt;
MapsTo x0 e0 l \/ InA eqke (x0, e0) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t)
  (<span class="nv">e0</span> : elt),
InA eqke (x0, e0) (elements_aux acc r) &lt;-&gt;
MapsTo x0 e0 r \/ InA eqke (x0, e0) acc</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1e2"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t) (<span class="nv">e0</span> : elt),
InA eqke (x0, e0)
  (elements_aux ((x, e) :: elements_aux acc r) l) &lt;-&gt;
MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e3"><span class="highlight"><span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e (Leaf elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">InA eqke (x, e) acc</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1e4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t)
  (<span class="nv">e0</span> : elt),
InA eqke (x0, e0) (elements_aux acc l) &lt;-&gt;
MapsTo x0 e0 l \/ InA eqke (x0, e0) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t)
  (<span class="nv">e0</span> : elt),
InA eqke (x0, e0) (elements_aux acc r) &lt;-&gt;
MapsTo x0 e0 r \/ InA eqke (x0, e0) acc</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1e4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t) (<span class="nv">e0</span> : elt),
InA eqke (x0, e0)
  (elements_aux ((x, e) :: elements_aux acc r) l) &lt;-&gt;
MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e5"><span class="highlight"><span class="nb">inversion</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t)
  (<span class="nv">e0</span> : elt),
InA eqke (x0, e0) (elements_aux acc l) &lt;-&gt;
MapsTo x0 e0 l \/ InA eqke (x0, e0) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t)
  (<span class="nv">e0</span> : elt),
InA eqke (x0, e0) (elements_aux acc r) &lt;-&gt;
MapsTo x0 e0 r \/ InA eqke (x0, e0) acc</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc</span> : list (key * elt)) (<span class="nv">x0</span> : X.t) (<span class="nv">e0</span> : elt),
InA eqke (x0, e0)
  (elements_aux ((x, e) :: elements_aux acc r) l) &lt;-&gt;
MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e6"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc0</span> : list (key * elt)) (<span class="nv">x1</span> : X.t)
  (<span class="nv">e1</span> : elt),
InA eqke (x1, e1) (elements_aux acc0 l) &lt;-&gt;
MapsTo x1 e1 l \/ InA eqke (x1, e1) acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc0</span> : list (key * elt)) (<span class="nv">x1</span> : X.t)
  (<span class="nv">e1</span> : elt),
InA eqke (x1, e1) (elements_aux acc0 r) &lt;-&gt;
MapsTo x1 e1 r \/ InA eqke (x1, e1) acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">InA eqke (x0, e0)
  (elements_aux ((x, e) :: elements_aux acc r) l) &lt;-&gt;
MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e7"><span class="highlight"><span class="nb">rewrite</span> Hl.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc0</span> : list (key * elt)) (<span class="nv">x1</span> : X.t)
  (<span class="nv">e1</span> : elt),
InA eqke (x1, e1) (elements_aux acc0 l) &lt;-&gt;
MapsTo x1 e1 l \/ InA eqke (x1, e1) acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">acc0</span> : list (key * elt)) (<span class="nv">x1</span> : X.t)
  (<span class="nv">e1</span> : elt),
InA eqke (x1, e1) (elements_aux acc0 r) &lt;-&gt;
MapsTo x1 e1 r \/ InA eqke (x1, e1) acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x0 e0 l \/
InA eqke (x0, e0) ((x, e) :: elements_aux acc r) &lt;-&gt;
MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e8"><span class="highlight"><span class="nb">destruct</span> (Hr acc x0 e0); <span class="nb">clear</span> Hl Hr.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x0, e0) (elements_aux acc r) -&gt;
MapsTo x0 e0 r \/ InA eqke (x0, e0) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x0 e0 r \/ InA eqke (x0, e0) acc -&gt;
InA eqke (x0, e0) (elements_aux acc r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x0 e0 l \/
InA eqke (x0, e0) ((x, e) :: elements_aux acc r) &lt;-&gt;
MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1e9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1e9"><span class="highlight"><span class="nb">intuition</span>; <span class="nb">inversion_clear</span> H3; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x0, e0) (elements_aux acc r) -&gt;
MapsTo x0 e0 r \/ InA eqke (x0, e0) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x0 e0 r -&gt;
InA eqke (x0, e0) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x0, e0) acc -&gt;
InA eqke (x0, e0) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">eqke (x0, e0) (x, e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x0 e0 (Node l x e r h) \/ InA eqke (x0, e0) acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> H0; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">subst</span>; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ea" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ea"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_mapsto</span> : <span class="kr">forall</span> (<span class="nv">s</span>:t elt) <span class="nv">x</span> <span class="nv">e</span>, InA eqke (x,e) (elements s) &lt;-&gt; MapsTo x e s.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
InA eqke (x, e) (elements s) &lt;-&gt; MapsTo x e s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1eb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1eb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt),
InA eqke (x, e) (elements s) &lt;-&gt; MapsTo x e s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ec" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ec"><span class="highlight"><span class="nb">intros</span>; <span class="nb">generalize</span> (elements_aux_mapsto s nil x e); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e s -&gt;
InA eqke (x, e) (elements_aux nil s)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e) (elements s)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e) nil</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e) (elements_aux nil s)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x e s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">inversion_clear</span> H0.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ed" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ed"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_in</span> : <span class="kr">forall</span> (<span class="nv">s</span>:t elt) <span class="nv">x</span>, L.PX.In x (elements s) &lt;-&gt; In x s.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">x</span> : X.t),
L.PX.In x (elements s) &lt;-&gt; In x s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ee" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ee"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">x</span> : X.t),
L.PX.In x (elements s) &lt;-&gt; In x s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1ef" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1ef"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.PX.In x (elements s) &lt;-&gt; In x s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f0"><span class="highlight"><span class="nb">unfold</span> L.PX.In.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">e</span> : elt, L.PX.MapsTo x e (elements s)) &lt;-&gt;
In x s</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f1"><span class="highlight"><span class="nb">rewrite</span> &lt;- In_alt; <span class="nb">unfold</span> In0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">e</span> : elt, L.PX.MapsTo x e (elements s)) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">e</span> : elt, MapsTo x e s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f2"><span class="highlight"><span class="nb">firstorder</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo x x0 (elements s)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">e</span> : elt, MapsTo x e s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1f3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x x0 s</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1f3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">e</span> : elt, L.PX.MapsTo x e (elements s)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f4"><span class="highlight"><span class="kr">exists</span> <span class="nv">x0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo x x0 (elements s)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">MapsTo x x0 s</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1f5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x x0 s</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1f5"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">e</span> : elt, L.PX.MapsTo x e (elements s)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f6"><span class="highlight"><span class="nb">rewrite</span> &lt;- elements_mapsto; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x x0 s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">e</span> : elt, L.PX.MapsTo x e (elements s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f7"><span class="highlight"><span class="kr">exists</span> <span class="nv">x0</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x x0 s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.PX.MapsTo x x0 (elements s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> L.PX.MapsTo; <span class="nb">rewrite</span> elements_mapsto; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_aux_sort</span> : <span class="kr">forall</span> (<span class="nv">s</span>:t elt) <span class="nv">acc</span>, bst s -&gt; sort ltk acc -&gt;
 (<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">y</span>, InA eqke (x,e) acc -&gt; In y s -&gt; X.lt y x) -&gt;
 sort ltk (elements_aux acc s).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">acc</span> : list (X.t * elt)),
bst s -&gt;
Sorted ltk acc -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">y</span> : key),
 InA eqke (x, e) acc -&gt; In y s -&gt; X.lt y x) -&gt;
Sorted ltk (elements_aux acc s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1f9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1f9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">acc</span> : list (X.t * elt)),
bst s -&gt;
Sorted ltk acc -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">y</span> : key),
 InA eqke (x, e) acc -&gt; In y s -&gt; X.lt y x) -&gt;
Sorted ltk (elements_aux acc s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1fa" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1fa"><span class="highlight"><span class="nb">induction</span> s <span class="kr">as</span> [ | l Hl y e r Hr h]; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l y e r h)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Sorted ltk
  (elements_aux ((y, e) :: elements_aux acc r) l)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1fb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1fb"><span class="highlight">inv bst.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Sorted ltk
  (elements_aux ((y, e) :: elements_aux acc r) l)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1fc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1fc"><span class="highlight"><span class="nb">apply</span> Hl; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Sorted ltk ((y, e) :: elements_aux acc r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1fd" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1fd"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk1fe" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk1fe"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Sorted ltk (elements_aux acc r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk1ff" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk1ff"><hr></label><div class="goal-conclusion"><span class="highlight">HdRel ltk (y, e) (elements_aux acc r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk200" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk200"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk201" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk201"><span class="highlight"><span class="nb">apply</span> Hr; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">HdRel ltk (y, e) (elements_aux acc r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk202" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk202"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk203" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk203"><span class="highlight"><span class="nb">apply</span> InA_InfA <span class="kr">with</span> (eqA:=eqke); <span class="nb">auto with</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : X.t * elt,
InA eqke y0 (elements_aux acc r) -&gt; ltk (y, e) y0</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk204" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk204"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk205" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk205"><span class="highlight"><span class="nb">intros</span> (y&#39;,e&#39;) H6.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ltk (y, e) (y&#39;, e&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk206" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk206"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk207" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk207"><span class="highlight"><span class="nb">destruct</span> (elements_aux_mapsto r acc y&#39; e&#39;); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y&#39; e&#39; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) acc -&gt;
InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ltk (y, e) (y&#39;, e&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk208" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y&#39; e&#39; r -&gt;
InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk208"><hr></label><div class="goal-conclusion"><span class="highlight">ltk (y, e) (y&#39;, e&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk209" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk209"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk20a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk20a"><span class="highlight"><span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y&#39; e&#39; r -&gt;
InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (y&#39;, e&#39;) (elements_aux acc r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ltk (y, e) (y&#39;, e&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk20b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk20b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk20c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk20c"><span class="highlight"><span class="nb">red</span>; <span class="nb">simpl</span>; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 l -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
 InA eqke (x, e0) acc0 -&gt; In y0 r -&gt; X.lt y0 x) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) acc -&gt;
In y0 (Node l y e r h) -&gt; X.lt y0 x</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e0</span> : elt) (<span class="nv">y0</span> : key),
InA eqke (x, e0) ((y, e) :: elements_aux acc r) -&gt;
In y0 l -&gt; X.lt y0 x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk20d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk20d"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 l -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 r -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
InA eqke (x0, e1) acc -&gt;
In y1 (Node l y e r h) -&gt; X.lt y1 x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e0) ((y, e) :: elements_aux acc r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 l</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y0 x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk20e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk20e"><span class="highlight"><span class="nb">inversion_clear</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 l -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 r -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
InA eqke (x0, e1) acc -&gt;
In y1 (Node l y e r h) -&gt; X.lt y1 x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">eqke (x, e0) (y, e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y0 x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk20f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 l -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 r -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
InA eqke (x0, e1) acc -&gt;
In y1 (Node l y e r h) -&gt; X.lt y1 x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e0) (elements_aux acc r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk20f"><hr></label><div class="goal-conclusion"><span class="highlight">X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk210" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk210"><span class="highlight"><span class="nb">destruct</span> H7; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 l -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 r -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
InA eqke (x0, e1) acc -&gt;
In y1 (Node l y e r h) -&gt; X.lt y1 x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">e0 = e</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y0 x</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk211" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 l -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 r -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
InA eqke (x0, e1) acc -&gt;
In y1 (Node l y e r h) -&gt; X.lt y1 x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e0) (elements_aux acc r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk211"><hr></label><div class="goal-conclusion"><span class="highlight">X.lt y0 x</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk212" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk212"><span class="highlight">order.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst l -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 l -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (X.t * elt),
bst r -&gt;
Sorted ltk acc0 -&gt;
(<span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
 InA eqke (x0, e1) acc0 -&gt; In y1 r -&gt; X.lt y1 x0) -&gt;
Sorted ltk (elements_aux acc0 r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Sorted ltk acc</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : X.t) (<span class="nv">e1</span> : elt) (<span class="nv">y1</span> : key),
InA eqke (x0, e1) acc -&gt;
In y1 (Node l y e r h) -&gt; X.lt y1 x0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree y l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree y r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">InA eqke (x, e0) (elements_aux acc r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y0 x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (elements_aux_mapsto r acc x e0); <span class="nb">intuition</span> <span class="nb">eauto</span>.</span></span><span class="coq-wsp"> 
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk213" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk213"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_sort</span> : <span class="kr">forall</span> <span class="nv">s</span> : t elt, bst s -&gt; sort ltk (elements s).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : t elt, bst s -&gt; Sorted ltk (elements s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk214" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk214"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : t elt, bst s -&gt; Sorted ltk (elements s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk215" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk215"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> elements; <span class="nb">apply</span> elements_aux_sort; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">e</span> : elt) (<span class="nv">y</span> : key),
InA eqke (x, e) nil -&gt; In y s -&gt; X.lt y x</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">inversion</span> H0.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> elements_sort : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk216" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk216"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_nodup</span> : <span class="kr">forall</span> <span class="nv">s</span> : t elt, bst s -&gt; NoDupA eqk (elements s).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : t elt, bst s -&gt; NoDupA eqk (elements s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk217" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk217"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : t elt, bst s -&gt; NoDupA eqk (elements s)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">apply</span> PX.Sort_NoDupA; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk218" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk218"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_aux_cardinal</span> :
 <span class="kr">forall</span> (<span class="nv">m</span>:t elt) <span class="nv">acc</span>, (length acc + cardinal m)%nat = length (elements_aux acc m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">acc</span> : list (key * elt)),
(length acc + cardinal m)%nat =
length (elements_aux acc m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk219" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk219"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">acc</span> : list (key * elt)),
(length acc + cardinal m)%nat =
length (elements_aux acc m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21a"><span class="highlight"><span class="nb">simple induction</span> m; <span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
(length acc0 + cardinal t)%nat =
length (elements_aux acc0 t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
(length acc0 + cardinal t0)%nat =
length (elements_aux acc0 t0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(length acc + S (cardinal t + cardinal t0))%nat =
length
  (elements_aux ((k, e) :: elements_aux acc t0) t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21b"><span class="highlight"><span class="nb">rewrite</span> &lt;- H; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
(length acc0 + cardinal t)%nat =
length (elements_aux acc0 t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
(length acc0 + cardinal t0)%nat =
length (elements_aux acc0 t0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(length acc + S (cardinal t + cardinal t0))%nat =
S (length (elements_aux acc t0) + cardinal t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> &lt;- H0; <span class="bp">omega</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_cardinal</span> : <span class="kr">forall</span> (<span class="nv">m</span>:t elt), cardinal m = length (elements m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, cardinal m = length (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, cardinal m = length (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">m</span> =&gt; elements_aux_cardinal m nil).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_app</span> :
 <span class="kr">forall</span> (<span class="nv">s</span>:t elt) <span class="nv">acc</span>, elements_aux acc s = elements s ++ acc.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">acc</span> : list (key * elt)),
elements_aux acc s = elements s ++ acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk21f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk21f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">acc</span> : list (key * elt)),
elements_aux acc s = elements s ++ acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk220" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk220"><span class="highlight"><span class="nb">induction</span> s; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
elements_aux acc0 s1 = elements s1 ++ acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
elements_aux acc0 s2 = elements s2 ++ acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">elements_aux ((k, e) :: elements_aux acc s2) s1 =
elements (Node s1 k e s2 t) ++ acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk221" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk221"><span class="highlight"><span class="nb">rewrite</span> IHs1, IHs2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
elements_aux acc0 s1 = elements s1 ++ acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
elements_aux acc0 s2 = elements s2 ++ acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">elements s1 ++ (k, e) :: elements s2 ++ acc =
elements (Node s1 k e s2 t) ++ acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk222" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk222"><span class="highlight"><span class="nb">unfold</span> elements; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
elements_aux acc0 s1 = elements s1 ++ acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">acc0</span> : list (key * elt),
elements_aux acc0 s2 = elements s2 ++ acc0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">elements_aux nil s1 ++
(k, e) :: elements_aux nil s2 ++ acc =
elements_aux ((k, e) :: elements_aux nil s2) s1 ++ acc</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> IHs1, IHs2, !app_nil_r, !app_ass; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk223" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk223"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_node</span> :
 <span class="kr">forall</span> (<span class="nv">t1</span> <span class="nv">t2</span>:t elt) <span class="nv">x</span> <span class="nv">e</span> <span class="nv">z</span> <span class="nv">l</span>,
 elements t1 ++ (x,e) :: elements t2 ++ l =
 elements (Node t1 x e t2 z) ++ l.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">t1</span> <span class="nv">t2</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">z</span> : int)
  (<span class="nv">l</span> : list (key * elt)),
elements t1 ++ (x, e) :: elements t2 ++ l =
elements (Node t1 x e t2 z) ++ l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk224" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk224"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">t1</span> <span class="nv">t2</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">z</span> : int)
  (<span class="nv">l</span> : list (key * elt)),
elements t1 ++ (x, e) :: elements t2 ++ l =
elements (Node t1 x e t2 z) ++ l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk225" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk225"><span class="highlight"><span class="nb">unfold</span> elements; <span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1, t2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">z</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">elements_aux nil t1 ++
(x, e) :: elements_aux nil t2 ++ l =
elements_aux ((x, e) :: elements_aux nil t2) t1 ++ l</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> !elements_app, !app_nil_r, !app_ass; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab43"></a><h1 class="section">Fold</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fold&#39;</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A)(<span class="nv">s</span> : t elt) :=
  L.<span class="nb">fold</span> f (elements s).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk226" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk226"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fold_equiv_aux</span> :
 <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A) <span class="nv">acc</span>,
 L.<span class="nb">fold</span> f (elements_aux acc s) a = L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f s a).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
  (<span class="nv">acc</span> : list (key * elt)),
L.<span class="nb">fold</span> f (elements_aux acc s) a =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f s a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk227" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk227"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
  (<span class="nv">acc</span> : list (key * elt)),
L.<span class="nb">fold</span> f (elements_aux acc s) a =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f s a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk228" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk228"><span class="highlight"><span class="nb">simple induction</span> s.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
  (<span class="nv">acc</span> : list (key * elt)),
L.<span class="nb">fold</span> f (elements_aux acc (Leaf elt)) a =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f (Leaf elt) a)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk229" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk229"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">t</span> : t elt,
(<span class="kr">forall</span> (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
   (<span class="nv">acc</span> : list (key * elt)),
 L.<span class="nb">fold</span> f (elements_aux acc t) a =
 L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t a)) -&gt;
<span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">t0</span> : Raw.t elt),
(<span class="kr">forall</span> (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
   (<span class="nv">acc</span> : list (key * elt)),
 L.<span class="nb">fold</span> f (elements_aux acc t0) a =
 L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t0 a)) -&gt;
<span class="kr">forall</span> (<span class="nv">t1</span> : int) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
  (<span class="nv">acc</span> : list (key * elt)),
L.<span class="nb">fold</span> f (elements_aux acc (Node t k e t0 t1)) a =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f (Node t k e t0 t1) a)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22a"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">t</span> : t elt,
(<span class="kr">forall</span> (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
   (<span class="nv">acc</span> : list (key * elt)),
 L.<span class="nb">fold</span> f (elements_aux acc t) a =
 L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t a)) -&gt;
<span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">e</span> : elt) (<span class="nv">t0</span> : Raw.t elt),
(<span class="kr">forall</span> (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
   (<span class="nv">acc</span> : list (key * elt)),
 L.<span class="nb">fold</span> f (elements_aux acc t0) a =
 L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t0 a)) -&gt;
<span class="kr">forall</span> (<span class="nv">t1</span> : int) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A)
  (<span class="nv">acc</span> : list (key * elt)),
L.<span class="nb">fold</span> f (elements_aux acc (Node t k e t0 t1)) a =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f (Node t k e t0 t1) a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22b"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A)
  (<span class="nv">acc0</span> : list (key * elt)),
L.<span class="nb">fold</span> f0 (elements_aux acc0 t) a0 =
L.<span class="nb">fold</span> f0 acc0 (<span class="nb">fold</span> f0 t a0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A)
  (<span class="nv">acc0</span> : list (key * elt)),
L.<span class="nb">fold</span> f0 (elements_aux acc0 t0) a0 =
L.<span class="nb">fold</span> f0 acc0 (<span class="nb">fold</span> f0 t0 a0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.<span class="nb">fold</span> f
  (elements_aux ((k, e) :: elements_aux acc t0) t) a =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t0 (f k e (<span class="nb">fold</span> f t a)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22c"><span class="highlight"><span class="nb">rewrite</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A)
  (<span class="nv">acc0</span> : list (key * elt)),
L.<span class="nb">fold</span> f0 (elements_aux acc0 t) a0 =
L.<span class="nb">fold</span> f0 acc0 (<span class="nb">fold</span> f0 t a0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A)
  (<span class="nv">acc0</span> : list (key * elt)),
L.<span class="nb">fold</span> f0 (elements_aux acc0 t0) a0 =
L.<span class="nb">fold</span> f0 acc0 (<span class="nb">fold</span> f0 t0 a0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.<span class="nb">fold</span> f ((k, e) :: elements_aux acc t0) (<span class="nb">fold</span> f t a) =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t0 (f k e (<span class="nb">fold</span> f t a)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22d"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A)
  (<span class="nv">acc0</span> : list (key * elt)),
L.<span class="nb">fold</span> f0 (elements_aux acc0 t) a0 =
L.<span class="nb">fold</span> f0 acc0 (<span class="nb">fold</span> f0 t a0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A)
  (<span class="nv">acc0</span> : list (key * elt)),
L.<span class="nb">fold</span> f0 (elements_aux acc0 t0) a0 =
L.<span class="nb">fold</span> f0 acc0 (<span class="nb">fold</span> f0 t0 a0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">acc</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (key * elt)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.<span class="nb">fold</span> f (elements_aux acc t0) (f k e (<span class="nb">fold</span> f t a)) =
L.<span class="nb">fold</span> f acc (<span class="nb">fold</span> f t0 (f k e (<span class="nb">fold</span> f t a)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> H0.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fold_equiv</span> :
 <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A),
 <span class="nb">fold</span> f s a = fold&#39; f s a.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A),
<span class="nb">fold</span> f s a = fold&#39; f s a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk22f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk22f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A),
<span class="nb">fold</span> f s a = fold&#39; f s a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk230" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk230"><span class="highlight"><span class="nb">unfold</span> fold&#39;, elements.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">s</span> : t elt)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a</span> : A),
<span class="nb">fold</span> f s a = L.<span class="nb">fold</span> f (elements_aux nil s) a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk231" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk231"><span class="highlight"><span class="nb">simple induction</span> s; <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A),
<span class="nb">fold</span> f0 t a0 = L.<span class="nb">fold</span> f0 (elements_aux nil t) a0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A),
<span class="nb">fold</span> f0 t0 a0 =
L.<span class="nb">fold</span> f0 (elements_aux nil t0) a0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">fold</span> f t0 (f k e (<span class="nb">fold</span> f t a)) =
L.<span class="nb">fold</span> f
  (elements_aux ((k, e) :: elements_aux nil t0) t) a</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk232" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk232"><span class="highlight"><span class="nb">rewrite</span> fold_equiv_aux.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A),
<span class="nb">fold</span> f0 t a0 = L.<span class="nb">fold</span> f0 (elements_aux nil t) a0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A),
<span class="nb">fold</span> f0 t0 a0 =
L.<span class="nb">fold</span> f0 (elements_aux nil t0) a0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">fold</span> f t0 (f k e (<span class="nb">fold</span> f t a)) =
L.<span class="nb">fold</span> f ((k, e) :: elements_aux nil t0) (<span class="nb">fold</span> f t a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk233" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk233"><span class="highlight"><span class="nb">rewrite</span> H0.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A),
<span class="nb">fold</span> f0 t a0 = L.<span class="nb">fold</span> f0 (elements_aux nil t) a0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">f0</span> : key -&gt; elt -&gt; A -&gt; A) (<span class="nv">a0</span> : A),
<span class="nb">fold</span> f0 t0 a0 =
L.<span class="nb">fold</span> f0 (elements_aux nil t0) a0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.<span class="nb">fold</span> f (elements_aux nil t0) (f k e (<span class="nb">fold</span> f t a)) =
L.<span class="nb">fold</span> f ((k, e) :: elements_aux nil t0) (<span class="nb">fold</span> f t a)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk234" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk234"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fold_1</span> :
 <span class="kr">forall</span> (<span class="nv">s</span>:t elt)(<span class="nv">Hs</span>:bst s)(<span class="nv">A</span> : <span class="kt">Type</span>)(<span class="nv">i</span>:A)(<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A),
 <span class="nb">fold</span> f s i = fold_left (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">p</span> =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a) (elements s) i.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : t elt,
bst s -&gt;
<span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">i</span> : A) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A),
<span class="nb">fold</span> f s i =
fold_left (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (elements s) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk235" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk235"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : t elt,
bst s -&gt;
<span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">i</span> : A) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A),
<span class="nb">fold</span> f s i =
fold_left (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (elements s) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk236" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk236"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">fold</span> f s i =
fold_left (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (elements s) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk237" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk237"><span class="highlight"><span class="nb">rewrite</span> fold_equiv.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fold&#39; f s i =
fold_left (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (elements s) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk238" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk238"><span class="highlight"><span class="nb">unfold</span> fold&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.<span class="nb">fold</span> f (elements s) i =
fold_left (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (elements s) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk239" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk239"><span class="highlight"><span class="nb">rewrite</span> L.fold_1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">A</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; A -&gt; A</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fold_left
  (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : L.key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (L.elements (elt:=elt) (elements s)) i =
fold_left (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f p#<span class="mi">1</span> p#<span class="mi">2</span> a)
  (elements s) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> L.elements; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
<a name="lab44"></a><h1 class="section">Comparison</h1>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">flatten_e</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> returns the list of elements of the enumeration <span class="inlinecode"><span class="id" title="var">e</span></span>
    i.e. the list of elements actually compared 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">flatten_e</span> (<span class="nv">e</span> : enumeration elt) : list (key*elt) := <span class="kr">match</span> e <span class="kr">with</span>
  | <span class="kn">End</span> <span class="nf">_</span> =&gt; nil
  | More x e t r =&gt; (x,e) :: elements t ++ flatten_e r
 <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">flatten_e_elements</span> :
 <span class="kr">forall</span> (<span class="nv">l</span>:t elt) <span class="nv">r</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">z</span> <span class="nv">e</span>,
 elements l ++ flatten_e (More x d r e) =
 elements (Node l x d r z) ++ flatten_e e.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">z</span> : int)
  (<span class="nv">e</span> : enumeration elt),
elements l ++ flatten_e (More x d r e) =
elements (Node l x d r z) ++ flatten_e e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> <span class="nv">r</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">z</span> : int)
  (<span class="nv">e</span> : enumeration elt),
elements l ++ flatten_e (More x d r e) =
elements (Node l x d r z) ++ flatten_e e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">apply</span> elements_node.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cons_1</span> : <span class="kr">forall</span> (<span class="nv">s</span>:t elt) <span class="nv">e</span>,
  flatten_e (cons s e) = elements s ++ flatten_e e.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">e</span> : enumeration elt),
flatten_e (cons s e) = elements s ++ flatten_e e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : t elt) (<span class="nv">e</span> : enumeration elt),
flatten_e (cons s e) = elements s ++ flatten_e e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23e"><span class="highlight"><span class="nb">induction</span> s; <span class="nb">auto</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e1</span> : enumeration elt,
flatten_e (cons s1 e1) =
elements s1 ++ flatten_e e1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHs2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e1</span> : enumeration elt,
flatten_e (cons s2 e1) =
elements s2 ++ flatten_e e1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">flatten_e (cons (Node s1 k e s2 t) e0) =
elements (Node s1 k e s2 t) ++ flatten_e e0</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">simpl</span> flatten_e; <span class="nb">rewrite</span> IHs1; <span class="nb">apply</span> flatten_e_elements; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
Proof of correction for the comparison 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">cmp</span> : elt-&gt;elt-&gt;bool.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">IfEq</span> <span class="nv">b</span> <span class="nv">l1</span> <span class="nv">l2</span> := L.equal cmp l1 l2 = b.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk23f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk23f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cons_IfEq</span> : <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">d1</span> <span class="nv">d2</span> <span class="nv">l1</span> <span class="nv">l2</span>,
  X.eq x1 x2 -&gt; cmp d1 d2 = true -&gt;
  IfEq b l1 l2 -&gt;
    IfEq b ((x1,d1)::l1) ((x2,d2)::l2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">b</span> : bool) (<span class="nv">x1</span> <span class="nv">x2</span> : X.t) (<span class="nv">d1</span> <span class="nv">d2</span> : elt)
  (<span class="nv">l1</span> <span class="nv">l2</span> : L.t elt),
X.eq x1 x2 -&gt;
cmp d1 d2 = true -&gt;
IfEq b l1 l2 -&gt;
IfEq b ((x1, d1) :: l1) ((x2, d2) :: l2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk240" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk240"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">b</span> : bool) (<span class="nv">x1</span> <span class="nv">x2</span> : X.t) (<span class="nv">d1</span> <span class="nv">d2</span> : elt)
  (<span class="nv">l1</span> <span class="nv">l2</span> : L.t elt),
X.eq x1 x2 -&gt;
cmp d1 d2 = true -&gt;
IfEq b l1 l2 -&gt;
IfEq b ((x1, d1) :: l1) ((x2, d2) :: l2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> IfEq; <span class="nb">destruct</span> b; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">simpl</span>;
  <span class="kp">try</span> <span class="nb">rewrite</span> H0; <span class="nb">auto</span>; order.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk241" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk241"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_end_IfEq</span> : <span class="kr">forall</span> <span class="nv">e2</span>,
  IfEq (equal_end e2) nil (flatten_e e2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e2</span> : enumeration elt,
IfEq (equal_end e2) nil (flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk242" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk242"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e2</span> : enumeration elt,
IfEq (equal_end e2) nil (flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> e2; <span class="nb">red</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk243" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk243"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_more_IfEq</span> :
 <span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">d1</span> (<span class="nv">cont</span>:enumeration elt -&gt; bool) <span class="nv">x2</span> <span class="nv">d2</span> <span class="nv">r2</span> <span class="nv">e2</span> <span class="nv">l</span>,
  IfEq (cont (cons r2 e2)) l (elements r2 ++ flatten_e e2) -&gt;
    IfEq (equal_more cmp x1 d1 cont (More x2 d2 r2 e2)) ((x1,d1)::l)
       (flatten_e (More x2 d2 r2 e2)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : X.t) (<span class="nv">d1</span> : elt)
  (<span class="nv">cont</span> : enumeration elt -&gt; bool) (<span class="nv">x2</span> : key)
  (<span class="nv">d2</span> : elt) (<span class="nv">r2</span> : t elt) (<span class="nv">e2</span> : enumeration elt)
  (<span class="nv">l</span> : L.t elt),
IfEq (cont (cons r2 e2)) l
  (elements r2 ++ flatten_e e2) -&gt;
IfEq (equal_more cmp x1 d1 cont (More x2 d2 r2 e2))
  ((x1, d1) :: l) (flatten_e (More x2 d2 r2 e2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk244" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk244"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : X.t) (<span class="nv">d1</span> : elt)
  (<span class="nv">cont</span> : enumeration elt -&gt; bool) (<span class="nv">x2</span> : key)
  (<span class="nv">d2</span> : elt) (<span class="nv">r2</span> : t elt) (<span class="nv">e2</span> : enumeration elt)
  (<span class="nv">l</span> : L.t elt),
IfEq (cont (cons r2 e2)) l
  (elements r2 ++ flatten_e e2) -&gt;
IfEq (equal_more cmp x1 d1 cont (More x2 d2 r2 e2))
  ((x1, d1) :: l) (flatten_e (More x2 d2 r2 e2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk245" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk245"><span class="highlight"><span class="nb">unfold</span> IfEq; <span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.equal cmp l (elements r2 ++ flatten_e e2) =
cont (cons r2 e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x1 x2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cmp d1 d2 &amp;&amp;
L.equal cmp l (elements r2 ++ flatten_e e2) =
cmp d1 d2 &amp;&amp;&amp; cont (cons r2 e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> &lt;-andb_lazy_alt; <span class="nb">f_equal</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk246" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk246"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_cont_IfEq</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">cont</span> <span class="nv">e2</span> <span class="nv">l</span>,
  (<span class="kr">forall</span> <span class="nv">e</span>, IfEq (cont e) l (flatten_e e)) -&gt;
  IfEq (equal_cont cmp m1 cont e2) (elements m1 ++ l) (flatten_e e2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> : t elt) (<span class="nv">cont</span> : enumeration elt -&gt; bool)
  (<span class="nv">e2</span> : enumeration elt) (<span class="nv">l</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
 IfEq (cont e) l (flatten_e e)) -&gt;
IfEq (equal_cont cmp m1 cont e2) (elements m1 ++ l)
  (flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk247" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk247"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m1</span> : t elt) (<span class="nv">cont</span> : enumeration elt -&gt; bool)
  (<span class="nv">e2</span> : enumeration elt) (<span class="nv">l</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
 IfEq (cont e) l (flatten_e e)) -&gt;
IfEq (equal_cont cmp m1 cont e2) (elements m1 ++ l)
  (flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk248" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk248"><span class="highlight"><span class="nb">induction</span> m1 <span class="kr">as</span> [|l1 Hl1 x1 d1 r1 Hr1 h1]; <span class="nb">intros</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e0) (elements l1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e0) (elements r1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq (equal_cont cmp (Node l1 x1 d1 r1 h1) cont e2)
  (elements (Node l1 x1 d1 r1 h1) ++ l) (flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk249" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk249"><span class="highlight"><span class="nb">rewrite</span> &lt;- elements_node; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e0) (elements l1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e0) (elements r1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_cont cmp l1
     (equal_more cmp x1 d1 (equal_cont cmp r1 cont))
     e2) (elements l1 ++ (x1, d1) :: elements r1 ++ l)
  (flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk24a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk24a"><span class="highlight"><span class="nb">apply</span> Hl1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e0) (elements l1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e0) (elements r1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (equal_more cmp x1 d1 (equal_cont cmp r1 cont) e)
  ((x1, d1) :: elements r1 ++ l) (flatten_e e)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk24b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk24b"><span class="highlight"><span class="nb">clear</span> e2; <span class="nb">intros</span> [|x2 d2 r2 e2].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e2</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e2) (elements l1 ++ l0) (flatten_e e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e2</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e2) (elements r1 ++ l0) (flatten_e e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_more cmp x1 d1 (equal_cont cmp r1 cont)
     (<span class="kn">End</span> <span class="nf">elt</span>)) ((x1, d1) :: elements r1 ++ l)
  (flatten_e (<span class="kn">End</span> <span class="nf">elt</span>))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk24c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool)
  (<span class="nv">e0</span> : enumeration elt) 
  (<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
 IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e0)
  (elements l1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool)
  (<span class="nv">e0</span> : enumeration elt) 
  (<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
 IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e0)
  (elements r1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk24c"><hr></label><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_more cmp x1 d1 (equal_cont cmp r1 cont)
     (More x2 d2 r2 e2))
  ((x1, d1) :: elements r1 ++ l)
  (flatten_e (More x2 d2 r2 e2))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk24d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk24d"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">red</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e0) (elements l1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e0) (elements r1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_more cmp x1 d1 (equal_cont cmp r1 cont)
     (More x2 d2 r2 e2))
  ((x1, d1) :: elements r1 ++ l)
  (flatten_e (More x2 d2 r2 e2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk24e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk24e"><span class="highlight"><span class="nb">apply</span> equal_more_IfEq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp l1 cont0 e0) (elements l1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : enumeration elt -&gt; bool) (<span class="nv">e0</span> : enumeration elt)
(<span class="nv">l0</span> : L.t elt),
(<span class="kr">forall</span> <span class="nv">e</span> : enumeration elt, IfEq (cont0 e) l0 (flatten_e e)) -&gt;
IfEq (equal_cont cmp r1 cont0 e0) (elements r1 ++ l0) (flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (cont e) l (flatten_e e)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq (equal_cont cmp r1 cont (cons r2 e2))
  (elements r1 ++ l) (elements r2 ++ flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> &lt;- cons_1; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk24f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk24f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_IfEq</span> : <span class="kr">forall</span> (<span class="nv">m1</span> <span class="nv">m2</span>:t elt),
  IfEq (equal cmp m1 m2) (elements m1) (elements m2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t elt,
IfEq (equal cmp m1 m2) (elements m1) (elements m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk250" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk250"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t elt,
IfEq (equal cmp m1 m2) (elements m1) (elements m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk251" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk251"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> equal.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_cont cmp m1 (equal_end (elt:=elt))
     (cons m2 (<span class="kn">End</span> <span class="nf">elt</span>))) (elements m1) (elements m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk252" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk252"><span class="highlight"><span class="nb">rewrite</span> &lt;- (app_nil_r (elements m1)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_cont cmp m1 (equal_end (elt:=elt))
     (cons m2 (<span class="kn">End</span> <span class="nf">elt</span>))) (elements m1 ++ nil)
  (elements m2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk253" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk253"><span class="highlight"><span class="nb">replace</span> (elements m2) <span class="kr">with</span> (flatten_e (cons m2 (<span class="kn">End</span> <span class="nf">_</span>)))
  <span class="bp">by</span> (<span class="nb">rewrite</span> cons_1; <span class="nb">simpl</span>; <span class="nb">rewrite</span> app_nil_r; <span class="nb">auto</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq
  (equal_cont cmp m1 (equal_end (elt:=elt))
     (cons m2 (<span class="kn">End</span> <span class="nf">elt</span>))) (elements m1 ++ nil)
  (flatten_e (cons m2 (<span class="kn">End</span> <span class="nf">elt</span>)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk254" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk254"><span class="highlight"><span class="nb">apply</span> equal_cont_IfEq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : enumeration elt,
IfEq (equal_end e) nil (flatten_e e)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk255" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk255"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1, m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">enumeration elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IfEq (equal_end e) nil (flatten_e e)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> equal_end_IfEq; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Equivb</span> <span class="nv">m</span> <span class="nv">m&#39;</span> :=
  (<span class="kr">forall</span> <span class="nv">k</span>, In k m &lt;-&gt; In k m&#39;) /\
  (<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">e</span> <span class="nv">e&#39;</span>, MapsTo k e m -&gt; MapsTo k e&#39; m&#39; -&gt; cmp e e&#39; = true).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk256" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk256"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Equivb_elements</span> : <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span>,
 Equivb s s&#39; &lt;-&gt; L.Equivb cmp (elements s) (elements s&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : t elt,
Equivb s s&#39; &lt;-&gt;
L.Equivb cmp (elements s) (elements s&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk257" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk257"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : t elt,
Equivb s s&#39; &lt;-&gt;
L.Equivb cmp (elements s) (elements s&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk258" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk258"><span class="highlight"><span class="nb">unfold</span> Equivb, L.Equivb; <span class="nb">split</span>; <span class="nb">split</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : key, In k0 s &lt;-&gt; In k0 s&#39;) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 MapsTo k0 e s -&gt;
 MapsTo k0 e&#39; s&#39; -&gt; cmp e e&#39; = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.PX.In k (elements s) &lt;-&gt; L.PX.In k (elements s&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk259" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : key, In k0 s &lt;-&gt; In k0 s&#39;) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 MapsTo k0 e0 s -&gt;
 MapsTo k0 e&#39;0 s&#39; -&gt; cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo k e (elements s)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo k e&#39; (elements s&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk259"><hr></label><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk25a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 L.PX.MapsTo k0 e (elements s) -&gt;
 L.PX.MapsTo k0 e&#39; (elements s&#39;) -&gt;
 cmp e e&#39; = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk25a"><hr></label><div class="goal-conclusion"><span class="highlight">In k s &lt;-&gt; In k s&#39;</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk25b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 L.PX.MapsTo k0 e0 (elements s) -&gt;
 L.PX.MapsTo k0 e&#39;0 (elements s&#39;) -&gt;
 cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e&#39; s&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk25b"><hr></label><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk25c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk25c"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> elements_in; <span class="nb">firstorder</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : key, In k0 s &lt;-&gt; In k0 s&#39;) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 MapsTo k0 e0 s -&gt;
 MapsTo k0 e&#39;0 s&#39; -&gt; cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo k e (elements s)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo k e&#39; (elements s&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk25d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 L.PX.MapsTo k0 e (elements s) -&gt;
 L.PX.MapsTo k0 e&#39; (elements s&#39;) -&gt;
 cmp e e&#39; = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk25d"><hr></label><div class="goal-conclusion"><span class="highlight">In k s &lt;-&gt; In k s&#39;</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk25e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 L.PX.MapsTo k0 e0 (elements s) -&gt;
 L.PX.MapsTo k0 e&#39;0 (elements s&#39;) -&gt;
 cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e&#39; s&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk25e"><hr></label><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk25f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk25f"><span class="highlight"><span class="nb">destruct</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : key, In k0 s &lt;-&gt; In k0 s&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
MapsTo k0 e0 s -&gt;
MapsTo k0 e&#39;0 s&#39; -&gt; cmp e0 e&#39;0 = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo k e (elements s)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">L.PX.MapsTo k e&#39; (elements s&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk260" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 L.PX.MapsTo k0 e (elements s) -&gt;
 L.PX.MapsTo k0 e&#39; (elements s&#39;) -&gt;
 cmp e e&#39; = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk260"><hr></label><div class="goal-conclusion"><span class="highlight">In k s &lt;-&gt; In k s&#39;</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk261" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 L.PX.MapsTo k0 e0 (elements s) -&gt;
 L.PX.MapsTo k0 e&#39;0 (elements s&#39;) -&gt;
 cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e&#39; s&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk261"><hr></label><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk262" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk262"><span class="highlight"><span class="nb">apply</span> (H2 k); <span class="nb">rewrite</span> &lt;- elements_mapsto; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 L.PX.MapsTo k0 e (elements s) -&gt;
 L.PX.MapsTo k0 e&#39; (elements s&#39;) -&gt;
 cmp e e&#39; = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In k s &lt;-&gt; In k s&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk263" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 L.PX.MapsTo k0 e0 (elements s) -&gt;
 L.PX.MapsTo k0 e&#39;0 (elements s&#39;) -&gt;
 cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e&#39; s&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk263"><hr></label><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk264" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk264"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> &lt;- elements_in; <span class="nb">firstorder</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">(<span class="kr">forall</span> <span class="nv">k0</span> : X.t,
 L.PX.In k0 (elements s) &lt;-&gt;
 L.PX.In k0 (elements s&#39;)) /\
(<span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
 L.PX.MapsTo k0 e0 (elements s) -&gt;
 L.PX.MapsTo k0 e&#39;0 (elements s&#39;) -&gt;
 cmp e0 e&#39;0 = true)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e&#39; s&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk265" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk265"><span class="highlight"><span class="nb">destruct</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : X.t,
L.PX.In k0 (elements s) &lt;-&gt;
L.PX.In k0 (elements s&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : X.t) (<span class="nv">e0</span> <span class="nv">e&#39;0</span> : elt),
L.PX.MapsTo k0 e0 (elements s) -&gt;
L.PX.MapsTo k0 e&#39;0 (elements s&#39;) -&gt;
cmp e0 e&#39;0 = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e, e'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo k e&#39; s&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cmp e e&#39; = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> (H2 k); <span class="nb">unfold</span> L.PX.MapsTo; <span class="nb">rewrite</span> elements_mapsto; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk266" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk266"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_Equivb</span> : <span class="kr">forall</span> (<span class="nv">s</span> <span class="nv">s&#39;</span>: t elt), bst s -&gt; bst s&#39; -&gt;
  (equal cmp s s&#39; = true &lt;-&gt; Equivb s s&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : t elt,
bst s -&gt;
bst s&#39; -&gt; equal cmp s s&#39; = true &lt;-&gt; Equivb s s&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk267" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk267"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> <span class="nv">s&#39;</span> : t elt,
bst s -&gt;
bst s&#39; -&gt; equal cmp s s&#39; = true &lt;-&gt; Equivb s s&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk268" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk268"><span class="highlight"><span class="nb">intros</span> s s&#39; B B&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">B'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">equal cmp s s&#39; = true &lt;-&gt; Equivb s s&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk269" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk269"><span class="highlight"><span class="nb">rewrite</span> Equivb_elements, &lt;- equal_IfEq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">B'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst s&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">L.equal cmp (elements s) (elements s&#39;) = true &lt;-&gt;
L.Equivb cmp (elements s) (elements s&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">split</span>; [<span class="nb">apply</span> L.equal_2|<span class="nb">apply</span> L.equal_1]; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Elt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Map</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : elt -&gt; elt&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_1</span> : <span class="kr">forall</span> (<span class="nv">m</span>: t elt)(<span class="nv">x</span>:key)(<span class="nv">e</span>:elt),
    MapsTo x e m -&gt; MapsTo x (f e) (map f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt; MapsTo x (f e) (map f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt; MapsTo x (f e) (map f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">inversion_clear</span> <span class="mi">1</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_2</span> : <span class="kr">forall</span> (<span class="nv">m</span>: t elt)(<span class="nv">x</span>:key),
    In x (map f m) -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key), In x (map f m) -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key), In x (map f m) -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">inversion_clear</span> <span class="mi">1</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_bst</span> : <span class="kr">forall</span> <span class="nv">m</span>, bst m -&gt; bst (map f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (map f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk26f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk26f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (map f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk270" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk270"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt; bst (map f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt; bst (map f m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (Node m1 k e m2 t) -&gt;
bst (Node (map f m1) k (f e) (map f m2) t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">inversion_clear</span> <span class="mi">1</span>; <span class="nb">constructor</span>; <span class="nb">auto</span>;
 <span class="nb">red</span>; <span class="nb">auto using</span> map_2.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Map</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Mapi</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : key -&gt; elt -&gt; elt&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk271" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk271"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mapi_1</span> : <span class="kr">forall</span> (<span class="nv">m</span>: tree elt)(<span class="nv">x</span>:key)(<span class="nv">e</span>:elt),
    MapsTo x e m -&gt; <span class="kr">exists</span> <span class="nv">y</span>, X.eq y x /\ MapsTo x (f y e) (mapi f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\ MapsTo x (f y e) (mapi f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk272" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk272"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\ MapsTo x (f y e) (mapi f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk273" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk273"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">inversion_clear</span> <span class="mi">1</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x k</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk274" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk274"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk275" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk275"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk276" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk276"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk277" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk277"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk278" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk278"><span class="highlight"><span class="nb">destruct</span> (IHm1 _ _ H0).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x1 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x1 /\ MapsTo x1 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x1 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x1 /\ MapsTo x1 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x /\ MapsTo x (f x0 e0) (mapi f m1)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk279" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m2</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk279"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27a"><span class="highlight"><span class="kr">exists</span> <span class="nv">x0</span>; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x0 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x0 /\ MapsTo x0 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27b"><span class="highlight"><span class="nb">destruct</span> (IHm2 _ _ H0).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x1 e1 m1 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x1 /\ MapsTo x1 (f y e1) (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : key) (<span class="nv">e1</span> : elt),
MapsTo x1 e1 m2 -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x1 /\ MapsTo x1 (f y e1) (mapi f m2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo x e0 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x /\ MapsTo x (f x0 e0) (mapi f m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">y</span> : X.t,
  X.eq y x /\
  MapsTo x (f y e0)
    (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kr">exists</span> <span class="nv">x0</span>; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mapi_2</span> : <span class="kr">forall</span> (<span class="nv">m</span>: t elt)(<span class="nv">x</span>:key),
    In x (mapi f m) -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
In x (mapi f m) -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
In x (mapi f m) -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">inversion_clear</span> <span class="mi">1</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mapi_bst</span> : <span class="kr">forall</span> <span class="nv">m</span>, bst m -&gt; bst (mapi f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapi f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk27f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk27f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapi f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk280" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk280"><span class="highlight"><span class="nb">induction</span> m; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1 -&gt; bst (mapi f m1)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHm2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2 -&gt; bst (mapi f m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (Node m1 k e m2 t) -&gt;
bst (Node (mapi f m1) k (f k e) (mapi f m2) t)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">inversion_clear</span> <span class="mi">1</span>; <span class="nb">constructor</span>; <span class="nb">auto</span>;
 <span class="nb">red</span>; <span class="nb">auto using</span> mapi_2.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Mapi</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Map_option</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : key -&gt; elt -&gt; option elt&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">f_compat</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">x&#39;</span> <span class="nv">d</span>, X.eq x x&#39; -&gt; f x d = f x&#39; d.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk281" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk281"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_option_2</span> : <span class="kr">forall</span> (<span class="nv">m</span>:t elt)(<span class="nv">x</span>:key),
 In x (map_option f m) -&gt; <span class="kr">exists</span> <span class="nv">d</span>, MapsTo x d m /\ f x d &lt;&gt; None.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x x&#39; -&gt; f x d = f x&#39; d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
In x (map_option f m) -&gt;
<span class="kr">exists</span> <span class="nv">d</span> : elt, MapsTo x d m /\ f x d &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk282" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk282"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x x&#39; -&gt; f x d = f x&#39; d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
In x (map_option f m) -&gt;
<span class="kr">exists</span> <span class="nv">d</span> : elt, MapsTo x d m /\ f x d &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk283" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk283"><span class="highlight"><span class="nb">intros</span> m; <span class="nb">functional induction</span> (map_option f m); <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d = f x&#39; d</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x (Leaf elt&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d</span> : elt, MapsTo x d (Leaf elt) /\ f x d &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk284" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0
  (join (map_option f l) x d&#39; (map_option f r))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk284"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk285" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (concat (map_option f l) (map_option f r))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk285"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk286" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk286"><span class="highlight"><span class="nb">inversion</span> H.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0
  (join (map_option f l) x d&#39; (map_option f r))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk287" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (concat (map_option f l) (map_option f r))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk287"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk288" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk288"><span class="highlight"><span class="nb">rewrite</span> join_in <span class="kr">in</span> H; <span class="nb">destruct</span> H <span class="kr">as</span> [H|[H|H]].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk289" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f l)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk289"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk28a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk28a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk28b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (concat (map_option f l) (map_option f r))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk28b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk28c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk28c"><span class="highlight"><span class="kr">exists</span> <span class="nv">d</span>; <span class="nb">split</span>; <span class="nb">auto</span>; <span class="nb">rewrite</span> (f_compat d H), e0; <span class="bp">discriminate</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f l)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk28d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk28d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk28e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (concat (map_option f l) (map_option f r))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk28e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk28f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk28f"><span class="highlight"><span class="nb">destruct</span> (IHt _ H) <span class="kr">as</span> (d0 &amp; ? &amp; ?); <span class="kr">exists</span> <span class="nv">d0</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk290" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (concat (map_option f l) (map_option f r))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk290"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk291" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk291"><span class="highlight"><span class="nb">destruct</span> (IHt0 _ H) <span class="kr">as</span> (d0 &amp; ? &amp; ?); <span class="kr">exists</span> <span class="nv">d0</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (concat (map_option f l) (map_option f r))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk292" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk292"><span class="highlight"><span class="nb">rewrite</span> concat_in <span class="kr">in</span> H; <span class="nb">destruct</span> H <span class="kr">as</span> [H|H].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f l)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk293" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f r)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk293"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk294" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk294"><span class="highlight"><span class="nb">destruct</span> (IHt _ H) <span class="kr">as</span> (d0 &amp; ? &amp; ?); <span class="kr">exists</span> <span class="nv">d0</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f l) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 l /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
In x1 (map_option f r) -&gt;
<span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x1 d0 r /\ f x1 d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In x0 (map_option f r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">d0</span> : elt,
  MapsTo x0 d0 (Node l x d r _x) /\ f x0 d0 &lt;&gt; None</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (IHt0 _ H) <span class="kr">as</span> (d0 &amp; ? &amp; ?); <span class="kr">exists</span> <span class="nv">d0</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk295" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk295"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_option_bst</span> : <span class="kr">forall</span> <span class="nv">m</span>, bst m -&gt; bst (map_option f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x x&#39; -&gt; f x d = f x&#39; d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (map_option f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk296" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk296"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x x&#39; -&gt; f x d = f x&#39; d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (map_option f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk297" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk297"><span class="highlight"><span class="nb">intros</span> m; <span class="nb">functional induction</span> (map_option f m); <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="nb">intros</span>;
 inv bst.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (join (map_option f l) x d&#39; (map_option f r))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk298" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk298"><hr></label><div class="goal-conclusion"><span class="highlight">bst (concat (map_option f l) (map_option f r))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk299" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk299"><span class="highlight"><span class="nb">apply</span> join_bst; <span class="nb">auto</span>; <span class="nb">intros</span> y H;
 <span class="nb">destruct</span> (map_option_2 H) <span class="kr">as</span> (d0 &amp; ? &amp; ?); <span class="nb">eauto using</span> MapsTo_In.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (concat (map_option f l) (map_option f r))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29a"><span class="highlight"><span class="nb">apply</span> concat_bst; <span class="nb">auto</span>; <span class="nb">intros</span> y y&#39; H H&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map_option f r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29b"><span class="highlight"><span class="nb">destruct</span> (map_option_2 H) <span class="kr">as</span> (d0 &amp; ? &amp; ?).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d1</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d1 = f x&#39; d1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y d0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f y d0 &lt;&gt; None</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29c"><span class="highlight"><span class="nb">destruct</span> (map_option_2 H&#39;) <span class="kr">as</span> (d0&#39; &amp; ? &amp; ?).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x0</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d1</span> : elt),
X.eq x0 x&#39; -&gt; f x0 d1 = f x&#39; d1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l -&gt; bst (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r -&gt; bst (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y d0 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f y d0 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d0'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y&#39; d0&#39; r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f y&#39; d0&#39; &lt;&gt; None</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">eapply</span> X.lt_trans <span class="kr">with</span> x; <span class="nb">eauto using</span> MapsTo_In.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> map_option_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">nonify</span> e :=
 <span class="nb">replace</span> e <span class="kr">with</span> (@None elt) <span class="bp">by</span>
  (<span class="nb">symmetry</span>; <span class="nb">rewrite</span> not_find_iff; <span class="nb">auto</span>; <span class="nb">intro</span>; order).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_option_find</span> : <span class="kr">forall</span> (<span class="nv">m</span>:t elt)(<span class="nv">x</span>:key),
 bst m -&gt;
 find x (map_option f m) =
  <span class="kr">match</span> (find x m) <span class="kr">with</span> Some d =&gt; f x d | None =&gt; None <span class="kr">end</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x x&#39; -&gt; f x d = f x&#39; d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
bst m -&gt;
find x (map_option f m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f x d
| None =&gt; None
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d</span> : elt),
X.eq x x&#39; -&gt; f x d = f x&#39; d</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key),
bst m -&gt;
find x (map_option f m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f x d
| None =&gt; None
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk29f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk29f"><span class="highlight"><span class="nb">intros</span> m; <span class="nb">functional induction</span> (map_option f m); <span class="nb">simpl</span>; <span class="nb">auto</span>; <span class="nb">intros</span>;
 inv bst; <span class="nb">rewrite</span> join_find || <span class="nb">rewrite</span> concat_find; <span class="nb">auto</span>; <span class="nb">simpl</span>;
 <span class="kp">try</span> <span class="nb">destruct</span> X.<span class="nb">compare</span> <span class="kr">as</span> [Hlt|Heq|Hlt]; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some d&#39; = f x0 d</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a0"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x (map_option f l)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a1"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x (map_option f r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a2"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 l <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> = f x0 d</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a5"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2a6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2a6"><span class="highlight"><span class="nb">rewrite</span> (f_compat d Heq); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree x (map_option f l)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a7"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x (map_option f r)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 l <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2a9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2a9"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> = f x0 d</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2aa" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2aa"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ab" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ab"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2ac" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2ac"><span class="highlight"><span class="nb">intros</span> y H;
 <span class="nb">destruct</span> (map_option_2 H) <span class="kr">as</span> (? &amp; ? &amp; ?); <span class="nb">eauto using</span> MapsTo_In.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = Some d&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree x (map_option f r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ad" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ad"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 l <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ae" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ae"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> = f x0 d</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2af" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2af"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b0"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2b1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2b1"><span class="highlight"><span class="nb">intros</span> y H;
 <span class="nb">destruct</span> (map_option_2 H) <span class="kr">as</span> (? &amp; ? &amp; ?); <span class="nb">eauto using</span> MapsTo_In.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x0 x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 l <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b2"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> = f x0 d</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b3"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b4"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2b5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2b5"><span class="highlight"><span class="nb">rewrite</span> &lt;- IHt, IHt0; <span class="nb">auto</span>; nonify (find x0 r); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> = f x0 d</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b6"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b7"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2b8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2b8"><span class="highlight"><span class="nb">rewrite</span> IHt, IHt0; <span class="nb">auto</span>; nonify (find x0 r); nonify (find x0 l); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq x0 x</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">None = f x0 d</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2b9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2b9"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ba" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ba"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2bb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2bb"><span class="highlight"><span class="nb">rewrite</span> (f_compat d Heq); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; find x0 (map_option f l)
<span class="kr">end</span> =
<span class="kr">match</span> find x0 r <span class="kr">with</span>
| Some d0 =&gt; f x0 d0
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2bc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2bc"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2bd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2bd"><span class="highlight"><span class="nb">rewrite</span> &lt;- IHt0, IHt; <span class="nb">auto</span>; nonify (find x0 l); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x x0</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find x0 (map_option f r) <span class="kr">with</span>
| Some d0 =&gt; Some d0
| None =&gt; None
<span class="kr">end</span> = find x0 (map_option f r)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2be" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2be"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2bf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2bf"><span class="highlight"><span class="nb">destruct</span> (find x0 (map_option f r)); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map_option f l) -&gt;
In y2 (map_option f r) -&gt; X.lt y1 y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c0"><span class="highlight"><span class="nb">intros</span> y y&#39; H H&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x1 x&#39; -&gt; f x1 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst l -&gt;
find x1 (map_option f l) =
<span class="kr">match</span> find x1 l <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x1</span> : key,
bst r -&gt;
find x1 (map_option f r) =
<span class="kr">match</span> find x1 r <span class="kr">with</span>
| Some d0 =&gt; f x1 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map_option f r)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c1"><span class="highlight"><span class="nb">destruct</span> (map_option_2 H) <span class="kr">as</span> (? &amp; ? &amp; ?).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x2</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x2 x&#39; -&gt; f x2 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x2</span> : key,
bst l -&gt;
find x2 (map_option f l) =
<span class="kr">match</span> find x2 l <span class="kr">with</span>
| Some d0 =&gt; f x2 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x2</span> : key,
bst r -&gt;
find x2 (map_option f r) =
<span class="kr">match</span> find x2 r <span class="kr">with</span>
| Some d0 =&gt; f x2 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y x1 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f y x1 &lt;&gt; None</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c2"><span class="highlight"><span class="nb">destruct</span> (map_option_2 H&#39;) <span class="kr">as</span> (? &amp; ? &amp; ?).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x3</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">d0</span> : elt),
X.eq x3 x&#39; -&gt; f x3 d0 = f x&#39; d0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x d = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x3</span> : key,
bst l -&gt;
find x3 (map_option f l) =
<span class="kr">match</span> find x3 l <span class="kr">with</span>
| Some d0 =&gt; f x3 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">x3</span> : key,
bst r -&gt;
find x3 (map_option f r) =
<span class="kr">match</span> find x3 r <span class="kr">with</span>
| Some d0 =&gt; f x3 d0
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y, y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map_option f l)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map_option f r)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y x1 l</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f y x1 &lt;&gt; None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">MapsTo y&#39; x2 r</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f y&#39; x2 &lt;&gt; None</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">eapply</span> X.lt_trans <span class="kr">with</span> x; <span class="nb">eauto using</span> MapsTo_In.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Map_option</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Map2_opt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f0</span> : key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">mapl</span> : t elt -&gt; t elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">mapr</span> : t elt&#39; -&gt; t elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">f0_f</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">o</span>, f x d o = f0 x (Some d) o.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">mapl_bst</span> : <span class="kr">forall</span> <span class="nv">m</span>, bst m -&gt; bst (mapl m).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">mapr_bst</span> : <span class="kr">forall</span> <span class="nv">m&#39;</span>, bst m&#39; -&gt; bst (mapr m&#39;).</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">mapl_f0</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">m</span>, bst m -&gt;
 find x (mapl m) =
  <span class="kr">match</span> find x m <span class="kr">with</span> Some d =&gt; f0 x (Some d) None | None =&gt; None <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">mapr_f0</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">m&#39;</span>, bst m&#39; -&gt;
 find x (mapr m&#39;) =
  <span class="kr">match</span> find x m&#39; <span class="kr">with</span> Some d&#39; =&gt; f0 x None (Some d&#39;) | None =&gt; None <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">f0_compat</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">x&#39;</span> <span class="nv">o</span> <span class="nv">o&#39;</span>, X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Notation</span> <span class="nf">map2_opt</span> := (map2_opt f mapl mapr).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_opt_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">y</span>, bst m -&gt; bst m&#39; -&gt;
  In y (map2_opt m m&#39;) -&gt; In y m \/ In y m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt; In y (map2_opt m m&#39;) -&gt; In y m \/ In y m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt; In y (map2_opt m m&#39;) -&gt; In y m \/ In y m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c5"><span class="highlight"><span class="nb">intros</span> m m&#39;; <span class="nb">functional induction</span> (map2_opt m m&#39;); <span class="nb">intros</span>;
 <span class="nb">auto</span>; <span class="kp">try</span> factornode _x0 _x1 _x2 _x3 _x4 <span class="kr">as</span> m2;
 <span class="kp">try</span> (<span class="nb">generalize</span> (split_in_1 x1 H0 y)(split_in_2 x1 H0 y)
      (split_bst x1 H0); <span class="nb">rewrite</span> e1; <span class="nb">simpl</span>; <span class="nb">destruct</span> <span class="mi">3</span>; inv bst).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapr m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Leaf elt) \/ In y m2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2c6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl (Node l1 x1 d1 r1 _x))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2c6"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2c7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2c7"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2c8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2c8"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2c9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2c9"><span class="highlight"><span class="nb">right</span>; <span class="nb">apply</span> find_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapr m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y m2 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ca" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl (Node l1 x1 d1 r1 _x))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ca"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2cb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2cb"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2cc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2cc"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2cd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2cd"><span class="highlight"><span class="nb">generalize</span> (in_find (mapr_bst H0) H1); <span class="nb">rewrite</span> mapr_f0; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapr m2)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y m2 <span class="kr">with</span>
| Some d&#39; =&gt; f0 y None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span> &lt;&gt; None -&gt; find y m2 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ce" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl (Node l1 x1 d1 r1 _x))</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ce"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2cf" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2cf"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d0"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2d1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2d1"><span class="highlight"><span class="nb">destruct</span> (find y m2); <span class="nb">auto</span>; <span class="nb">intros</span>; <span class="bp">discriminate</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl (Node l1 x1 d1 r1 _x))</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d2" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d2"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d3"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2d4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2d4"><span class="highlight">factornode l1 x1 d1 r1 _x <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl m1)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y m1 \/ In y (Leaf elt&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d5"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d6"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2d7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2d7"><span class="highlight"><span class="nb">left</span>; <span class="nb">apply</span> find_in.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl m1)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y m1 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d8"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2d9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2d9"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2da" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2da"><span class="highlight"><span class="nb">generalize</span> (in_find (mapl_bst H) H1); <span class="nb">rewrite</span> mapl_f0; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (mapl m1)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y m1 <span class="kr">with</span>
| Some d =&gt; f0 y (Some d) None
| None =&gt; None
<span class="kr">end</span> &lt;&gt; None -&gt; find y m1 &lt;&gt; None</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2db" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2db"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2dc" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2dc"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2dd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2dd"><span class="highlight"><span class="nb">destruct</span> (find y m1); <span class="nb">auto</span>; <span class="nb">intros</span>; <span class="bp">discriminate</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2de" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2de"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2df" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2df"><span class="highlight"><span class="nb">rewrite</span> join_in <span class="kr">in</span> H1; <span class="nb">destruct</span> H1 <span class="kr">as</span> [H&#39;|[H&#39;|H&#39;]]; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2e0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2e0"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2e1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2e1"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e2"><span class="highlight"><span class="nb">destruct</span> (IHt1 y H6 H4 H&#39;); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2e3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2e3"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e4"><span class="highlight"><span class="nb">destruct</span> (IHt0 y H7 H5 H&#39;); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e5"><span class="highlight"><span class="nb">rewrite</span> concat_in <span class="kr">in</span> H1; <span class="nb">destruct</span> H1 <span class="kr">as</span> [H&#39;|H&#39;]; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2e6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2e6"><hr></label><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e7"><span class="highlight"><span class="nb">destruct</span> (IHt1 y H6 H4 H&#39;); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 (map2_opt l1 l2&#39;) -&gt;
In y0 l1 \/ In y0 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 (map2_opt r1 r2&#39;) -&gt;
In y0 r1 \/ In y0 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (IHt0 y H7 H5 H&#39;); <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_opt_bst</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span>, bst m -&gt; bst m&#39; -&gt;
 bst (map2_opt m m&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m -&gt; bst m&#39; -&gt; bst (map2_opt m m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2e9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2e9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m -&gt; bst m&#39; -&gt; bst (map2_opt m m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2ea" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2ea"><span class="highlight"><span class="nb">intros</span> m m&#39;; <span class="nb">functional induction</span> (map2_opt m m&#39;); <span class="nb">intros</span>;
 <span class="nb">auto</span>; <span class="kp">try</span> factornode _x0 _x1 _x2 _x3 _x4 <span class="kr">as</span> m2; inv bst;
 <span class="nb">generalize</span> (split_in_1 x1 H0)(split_in_2 x1 H0)(split_bst x1 H0);
  <span class="nb">rewrite</span> e1; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> <span class="mi">3</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (join (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2eb" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2eb"><hr></label><div class="goal-conclusion"><span class="highlight">bst (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2ec" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2ec"><span class="highlight"><span class="nb">apply</span> join_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ed" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ed"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ee" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ee"><hr></label><div class="goal-conclusion"><span class="highlight">bst (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2ef" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2ef"><span class="highlight"><span class="nb">intros</span> y Hy; <span class="nb">specialize</span> H <span class="kr">with</span> y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y x1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2f0" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2f0"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2f1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2f1"><hr></label><div class="goal-conclusion"><span class="highlight">bst (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f2"><span class="highlight"><span class="nb">destruct</span> (map2_opt_2 H1 H6 Hy); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2f3" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2f3"><hr></label><div class="goal-conclusion"><span class="highlight">bst (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f4"><span class="highlight"><span class="nb">intros</span> y Hy; <span class="nb">specialize</span> H5 <span class="kr">with</span> y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt r1 r2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt x1 y</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2f5" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2f5"><hr></label><div class="goal-conclusion"><span class="highlight">bst (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f6"><span class="highlight"><span class="nb">destruct</span> (map2_opt_2 H2 H7 Hy); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst (concat (map2_opt l1 l2&#39;) (map2_opt r1 r2&#39;))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f7"><span class="highlight"><span class="nb">apply</span> concat_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : key, In y r2&#39; &lt;-&gt; In y m2 /\ X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f8"><span class="highlight"><span class="nb">intros</span> y y&#39; Hy Hy&#39;; <span class="nb">specialize</span> H <span class="kr">with</span> y; <span class="nb">specialize</span> H5 <span class="kr">with</span> y&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; r2&#39; &lt;-&gt; In y&#39; m2 /\ X.lt x1 y&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map2_opt r1 r2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2f9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2f9"><span class="highlight"><span class="nb">apply</span> X.lt_trans <span class="kr">with</span> x1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; r2&#39; &lt;-&gt; In y&#39; m2 /\ X.lt x1 y&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map2_opt r1 r2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y x1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2fa" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; r2&#39; &lt;-&gt; In y&#39; m2 /\ X.lt x1 y&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map2_opt r1 r2&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2fa"><hr></label><div class="goal-conclusion"><span class="highlight">X.lt x1 y&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2fb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2fb"><span class="highlight"><span class="nb">destruct</span> (map2_opt_2 H1 H6 Hy); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">o2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, o2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 o2 = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1 -&gt; bst l2&#39; -&gt; bst (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1 -&gt; bst r2&#39; -&gt; bst (map2_opt r1 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H4</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y l2&#39; &lt;-&gt; In y m2 /\ X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; r2&#39; &lt;-&gt; In y&#39; m2 /\ X.lt x1 y&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y&#39; (map2_opt r1 r2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt x1 y&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (map2_opt_2 H2 H7 Hy&#39;); <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> map2_opt_bst : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">map2_aux</span> :=
 <span class="kr">match goal with</span>
  | H : In ?x _ \/ In ?x ?m,
    H&#39; : find ?x ?m = find ?x ?m&#39;, B:bst ?m, B&#39;:bst ?m&#39; |- _ =&gt;
    <span class="nb">destruct</span> H; [ intuition_in; order |
                  <span class="nb">rewrite</span> &lt;-(find_in_equiv B B&#39; H&#39;); <span class="nb">auto</span> ]
 <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">nonify</span> t :=
 <span class="kr">match</span> t <span class="kr">with</span> (find ?y (map2_opt ?m ?m&#39;)) =&gt;
 <span class="nb">replace</span> t <span class="kr">with</span> (@None elt&#39;&#39;);
 [ | <span class="nb">symmetry</span>; <span class="nb">rewrite</span> not_find_iff; <span class="nb">auto</span>; <span class="nb">intro</span>;
     <span class="nb">destruct</span> (@map2_opt_2 m m&#39; y); <span class="nb">auto</span>; order ]
 <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2fc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2fc"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_opt_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">y</span>, bst m -&gt; bst m&#39; -&gt;
 In y m \/ In y m&#39; -&gt;
 find y (map2_opt m m&#39;) = f0 y (find y m) (find y m&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt;
In y m \/ In y m&#39; -&gt;
find y (map2_opt m m&#39;) = f0 y (find y m) (find y m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2fd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2fd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt;
In y m \/ In y m&#39; -&gt;
find y (map2_opt m m&#39;) = f0 y (find y m) (find y m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk2fe" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk2fe"><span class="highlight"><span class="nb">intros</span> m m&#39;; <span class="nb">functional induction</span> (map2_opt m m&#39;); <span class="nb">intros</span>;
 <span class="nb">auto</span>; <span class="kp">try</span> factornode _x0 _x1 _x2 _x3 _x4 <span class="kr">as</span> m2;
 <span class="kp">try</span> (<span class="nb">generalize</span> (split_in_1 x1 H0)(split_in_2 x1 H0)
       (split_in_3 x1 H0)(split_bst x1 H0)(split_find x1 y H0)
       (split_lt_tree (x:=x1) H0)(split_gt_tree (x:=x1) H0);
       <span class="nb">rewrite</span> e1; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">destruct</span> <span class="mi">4</span>; <span class="nb">intros</span>; inv bst;
      <span class="nb">subst</span> o2; <span class="nb">rewrite</span> H7, ?join_find, ?concat_find; <span class="nb">auto</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Leaf elt) \/ In y m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (mapr m2) =
f0 y (find y (Leaf elt)) (find y m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk2ff" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk2ff"><hr></label><div class="goal-conclusion"><span class="highlight">find y (mapl (Node l1 x1 d1 r1 _x)) =
f0 y (find y (Node l1 x1 d1 r1 _x))
  (find y (Leaf elt&#39;))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk300" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk300"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk301" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk301"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk302" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk302"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk303" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk303"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk304" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk304"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk305" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk305"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">destruct</span> H1; [ <span class="nb">inversion_clear</span> H1 | ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (mapr m2) = f0 y None (find y m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk306" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk306"><hr></label><div class="goal-conclusion"><span class="highlight">find y (mapl (Node l1 x1 d1 r1 _x)) =
f0 y (find y (Node l1 x1 d1 r1 _x))
  (find y (Leaf elt&#39;))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk307" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk307"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk308" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk308"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk309" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk309"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk30a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk30a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk30b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk30b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk30c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk30c"><span class="highlight"><span class="nb">rewrite</span> mapr_f0; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m2</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y m2 <span class="kr">with</span>
| Some d&#39; =&gt; f0 y None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span> = f0 y None (find y m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk30d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk30d"><hr></label><div class="goal-conclusion"><span class="highlight">find y (mapl (Node l1 x1 d1 r1 _x)) =
f0 y (find y (Node l1 x1 d1 r1 _x))
  (find y (Leaf elt&#39;))</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk30e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk30e"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk30f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk30f"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk310" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk310"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk311" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk311"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk312" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk312"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk313" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk313"><span class="highlight"><span class="nb">generalize</span> (in_find H0 H1); <span class="nb">destruct</span> (find y m2); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Node l1 x1 d1 r1 _x)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y (Leaf elt&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (mapl (Node l1 x1 d1 r1 _x)) =
f0 y (find y (Node l1 x1 d1 r1 _x))
  (find y (Leaf elt&#39;))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk314" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk314"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk315" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk315"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk316" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk316"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk317" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk317"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk318" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk318"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk319" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk319"><span class="highlight">factornode l1 x1 d1 r1 _x <span class="kr">as</span> m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1 \/ In y (Leaf elt&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (mapl m1) =
f0 y (find y m1) (find y (Leaf elt&#39;))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk31a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk31a"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk31b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk31b"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk31c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk31c"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk31d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk31d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk31e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk31e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk31f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk31f"><span class="highlight"><span class="nb">destruct</span> H1; [ | <span class="nb">inversion_clear</span> H1 ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (mapl m1) =
f0 y (find y m1) (find y (Leaf elt&#39;))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk320" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk320"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk321" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk321"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk322" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk322"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk323" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk323"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk324" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk324"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk325" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk325"><span class="highlight"><span class="nb">rewrite</span> mapl_f0; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst (Leaf elt&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y m1 <span class="kr">with</span>
| Some d =&gt; f0 y (Some d) None
| None =&gt; None
<span class="kr">end</span> = f0 y (find y m1) (find y (Leaf elt&#39;))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk326" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk326"><hr></label><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk327" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk327"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk328" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk328"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk329" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk329"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk32a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk32a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk32b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk32b"><span class="highlight"><span class="nb">generalize</span> (in_find H H1); <span class="nb">destruct</span> (find y m1); <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y
  (create (map2_opt l1 l2&#39;) x1 e2 (map2_opt r1 r2&#39;)) =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk32c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk32c"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk32d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk32d"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk32e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk32e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk32f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk32f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk330" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk330"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (map2_opt l1 l2&#39;) =
f0 y (find y l1) (find y l2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk331" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk331"><hr></label><div class="goal-conclusion"><span class="highlight">Some e2 = f0 y (Some d1) (find x1 m2)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk332" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk332"><hr></label><div class="goal-conclusion"><span class="highlight">find y (map2_opt r1 r2&#39;) =
f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk333" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk333"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk334" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk334"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk335" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk335"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk336" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk336"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk337" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk337"><span class="highlight"><span class="nb">apply</span> IHt1; <span class="nb">auto</span>; map2_aux.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some e2 = f0 y (Some d1) (find x1 m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk338" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk338"><hr></label><div class="goal-conclusion"><span class="highlight">find y (map2_opt r1 r2&#39;) =
f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk339" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk339"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk33a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk33a"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk33b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk33b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk33c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk33c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk33d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk33d"><span class="highlight"><span class="nb">rewrite</span> (@f0_compat y x1), &lt;- f0_f; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (map2_opt r1 r2&#39;) =
f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk33e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk33e"><hr></label><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk33f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk33f"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk340" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk340"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk341" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk341"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk342" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk342"><span class="highlight"><span class="nb">apply</span> IHt0; <span class="nb">auto</span>; map2_aux.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">lt_tree x1 (map2_opt l1 l2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk343" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk343"><hr></label><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk344" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk344"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk345" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk345"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk346" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk346"><span class="highlight"><span class="nb">intros</span> z Hz; <span class="nb">destruct</span> (@map2_opt_2 l1 l2&#39; z); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = Some e2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">gt_tree x1 (map2_opt r1 r2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk347" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk347"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk348" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk348"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk349" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk349"><span class="highlight"><span class="nb">intros</span> z Hz; <span class="nb">destruct</span> (@map2_opt_2 r1 r2&#39; z); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> =
f0 y
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l1
  | EQ _ =&gt; Some d1
  | GT _ =&gt; find y r1
  <span class="kr">end</span>
  <span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
  | LT _ =&gt; find y l2&#39;
  | EQ _ =&gt; find x1 m2
  | GT _ =&gt; find y r2&#39;
  <span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk34a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk34a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk34b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk34b"><span class="highlight"><span class="nb">destruct</span> X.<span class="nb">compare</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y l1) (find y l2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk34c" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk34c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (Some d1) (find x1 m2)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk34d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk34d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk34e" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk34e"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk34f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk34f"><span class="highlight">nonify (find y (map2_opt r1 r2&#39;)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (map2_opt l1 l2&#39;) =
f0 y (find y l1) (find y l2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk350" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk350"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (Some d1) (find x1 m2)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk351" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk351"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk352" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk352"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk353" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk353"><span class="highlight"><span class="nb">apply</span> IHt1; <span class="nb">auto</span>; map2_aux.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (Some d1) (find x1 m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk354" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk354"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk355" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk355"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk356" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk356"><span class="highlight">nonify (find y (map2_opt r1 r2&#39;)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y (map2_opt l1 l2&#39;) = f0 y (Some d1) (find x1 m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk357" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk357"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk358" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk358"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk359" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk359"><span class="highlight">nonify (find y (map2_opt l1 l2&#39;)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.eq y x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find x1 m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">None = f0 y (Some d1) (find x1 m2)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk35a" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk35a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk35b" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk35b"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk35c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk35c"><span class="highlight"><span class="nb">rewrite</span> (@f0_compat y x1), &lt;- f0_f; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; find y (map2_opt l1 l2&#39;)
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk35d" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk35d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk35e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk35e"><span class="highlight">nonify (find y (map2_opt l1 l2&#39;)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> find y (map2_opt r1 r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; None
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk35f" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk35f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk360" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk360"><span class="highlight"><span class="nb">rewrite</span> IHt0; <span class="nb">auto</span>; [ | map2_aux ].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.lt x1 y</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 = find y r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> f0 y (find y r1) (find y r2&#39;) <span class="kr">with</span>
| Some d =&gt; Some d
| None =&gt; None
<span class="kr">end</span> = f0 y (find y r1) (find y r2&#39;)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk361" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk361"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk362" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk362"><span class="highlight"><span class="nb">destruct</span> (f0 y (find y r1) (find y r2&#39;)); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y1</span> <span class="nv">y2</span> : key,
In y1 (map2_opt l1 l2&#39;) -&gt;
In y2 (map2_opt r1 r2&#39;) -&gt; X.lt y1 y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk363" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk363"><span class="highlight"><span class="nb">intros</span> y1 y2 Hy1 Hy2; <span class="nb">apply</span> X.lt_trans <span class="kr">with</span> x1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1, y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y1 (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y2 (map2_opt r1 r2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt y1 x1</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk364" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1, y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y1 (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y2 (map2_opt r1 r2&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk364"><hr></label><div class="goal-conclusion"><span class="highlight">X.lt x1 y2</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk365" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk365"><span class="highlight"><span class="nb">destruct</span> (@map2_opt_2 l1 l2&#39; y1); <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key -&gt; elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39; -&gt; t elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;),
f x d o = f0 x (Some d) o</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, bst m -&gt; bst (mapl m)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_bst</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">m&#39;</span> : t elt&#39;, bst m&#39; -&gt; bst (mapr m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapl_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m</span> : t elt),
bst m -&gt;
find x (mapl m) =
<span class="kr">match</span> find x m <span class="kr">with</span>
| Some d =&gt; f0 x (Some d) None
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mapr_f0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X.t) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m&#39; -&gt;
find x (mapr m&#39;) =
<span class="kr">match</span> find x m&#39; <span class="kr">with</span>
| Some d&#39; =&gt; f0 x None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f0_compat</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">x&#39;</span> : X.t) (<span class="nv">o</span> : option elt)
  (<span class="nv">o&#39;</span> : option elt&#39;),
X.eq x x&#39; -&gt; f0 x o o&#39; = f0 x&#39; o o&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">_x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">int</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2', r2', m2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">f x1 d1 (find x1 m2) = None</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="nb">split</span> x1 m2 = &lt;&lt; l2&#39;, find x1 m2, r2&#39; &gt;&gt;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst l1 -&gt;
bst l2&#39; -&gt;
In y0 l1 \/ In y0 l2&#39; -&gt;
find y0 (map2_opt l1 l2&#39;) =
f0 y0 (find y0 l1) (find y0 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHt0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
bst r1 -&gt;
bst r2&#39; -&gt;
In y0 r1 \/ In y0 r2&#39; -&gt;
find y0 (map2_opt r1 r2&#39;) =
f0 y0 (find y0 r1) (find y0 r2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y (Node l1 x1 d1 r1 _x) \/ In y m2</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 l2&#39; &lt;-&gt; In y0 m2 /\ X.lt y0 x1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">y0</span> : key,
In y0 r2&#39; &lt;-&gt; In y0 m2 /\ X.lt x1 y0</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H5</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H6</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H7</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">find y m2 =
<span class="kr">match</span> X.<span class="nb">compare</span> y x1 <span class="kr">with</span>
| LT _ =&gt; find y l2&#39;
| EQ _ =&gt; find x1 m2
| GT _ =&gt; find y r2&#39;
<span class="kr">end</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H8</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H9</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r2&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H10</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H11</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">lt_tree x1 l1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H13</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">gt_tree x1 r1</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y1, y2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y1 (map2_opt l1 l2&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hy2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y2 (map2_opt r1 r2&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X.lt x1 y2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> (@map2_opt_2 r1 r2&#39; y2); <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Map2_opt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Map2</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk366" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk366"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_bst</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span>, bst m -&gt; bst m&#39; -&gt; bst (map2 f m m&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m -&gt; bst m&#39; -&gt; bst (map2 f m m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk367" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk367"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;),
bst m -&gt; bst m&#39; -&gt; bst (map2 f m m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk368" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk368"><span class="highlight"><span class="nb">unfold</span> map2; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;) =&gt;
      f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt; f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;)))
     m m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> map2_opt_bst <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">_</span> =&gt; f); <span class="nb">auto using</span> map_option_bst;
 <span class="nb">intros</span>; <span class="nb">rewrite</span> map_option_find; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk369" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk369"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">y</span>, bst m -&gt; bst m&#39; -&gt;
  In y m \/ In y m&#39; -&gt; find y (map2 f m m&#39;) = f (find y m) (find y m&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt;
In y m \/ In y m&#39; -&gt;
find y (map2 f m m&#39;) = f (find y m) (find y m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt;
In y m \/ In y m&#39; -&gt;
find y (map2 f m m&#39;) = f (find y m) (find y m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36b"><span class="highlight"><span class="nb">unfold</span> map2; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y m \/ In y m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;) =&gt;
      f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt; f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;)))
     m m&#39;) = f (find y m) (find y m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> (map2_opt_1 (f0:=<span class="kr">fun</span> <span class="nv">_</span> =&gt; f));
 <span class="nb">auto using</span> map_option_bst; <span class="nb">intros</span>; <span class="nb">rewrite</span> map_option_find; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">y</span>, bst m -&gt; bst m&#39; -&gt;
  In y (map2 f m m&#39;) -&gt; In y m \/ In y m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt; In y (map2 f m m&#39;) -&gt; In y m \/ In y m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">y</span> : key),
bst m -&gt;
bst m&#39; -&gt; In y (map2 f m m&#39;) -&gt; In y m \/ In y m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36e"><span class="highlight"><span class="nb">unfold</span> map2; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">In y m \/ In y m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk36f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk36f"><span class="highlight"><span class="nb">eapply</span> map2_opt_2 <span class="kr">with</span> (f0:=<span class="kr">fun</span> <span class="nv">_</span> =&gt; f); <span class="kp">try</span> <span class="bp">eassumption</span>; <span class="nb">trivial</span>; <span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m0</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt; f (Some d) None) m0)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk370" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk370"><hr></label><div class="goal-conclusion"><span class="highlight">bst
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;))
     m&#39;0)</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk371" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk371"><hr></label><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt; f (Some d) None) m0) =
<span class="kr">match</span> find x m0 <span class="kr">with</span>
| Some d =&gt; f (Some d) None
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk372" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk372"><hr></label><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;))
     m&#39;0) =
<span class="kr">match</span> find x m&#39;0 <span class="kr">with</span>
| Some d&#39; =&gt; f None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk373" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk373"><span class="highlight"><span class="nb">apply</span> map_option_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;0</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bst
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;))
     m&#39;0)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk374" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk374"><hr></label><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt; f (Some d) None) m0) =
<span class="kr">match</span> find x m0 <span class="kr">with</span>
| Some d =&gt; f (Some d) None
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk375" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk375"><hr></label><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;))
     m&#39;0) =
<span class="kr">match</span> find x m&#39;0 <span class="kr">with</span>
| Some d&#39; =&gt; f None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk376" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk376"><span class="highlight"><span class="nb">apply</span> map_option_bst; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m0</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt; f (Some d) None) m0) =
<span class="kr">match</span> find x m0 <span class="kr">with</span>
| Some d =&gt; f (Some d) None
| None =&gt; None
<span class="kr">end</span></span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk377" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;0</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk377"><hr></label><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;))
     m&#39;0) =
<span class="kr">match</span> find x m&#39;0 <span class="kr">with</span>
| Some d&#39; =&gt; f None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk378" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk378"><span class="highlight"><span class="nb">rewrite</span> map_option_find; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">In y
  (map2_opt
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) (<span class="nv">o</span> : option elt&#39;)
      =&gt; f (Some d) o)
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d</span> : elt) =&gt;
         f (Some d) None))
     (map_option
        (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt;
         f None (Some d&#39;))) m m&#39;)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">X.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">bst m&#39;0</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">find x
  (map_option
     (<span class="kr">fun</span> (<span class="nv">_</span> : key) (<span class="nv">d&#39;</span> : elt&#39;) =&gt; f None (Some d&#39;))
     m&#39;0) =
<span class="kr">match</span> find x m&#39;0 <span class="kr">with</span>
| Some d&#39; =&gt; f None (Some d&#39;)
| None =&gt; None
<span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> map_option_find; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Map2</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Proofs</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Raw</span>.</span></span></span></pre><div class="doc">
<a name="lab45"></a><h1 class="section">Encapsulation</h1>
<div class="paragraph"> </div>

   Now, in order to really provide a functor implementing <span class="inlinecode"><span class="id" title="var">S</span></span>, we
   need to encapsulate everything into a type of balanced binary search trees. 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">IntMake</span> (I:Int)(X: OrderedType) &lt;: S <span class="kr">with</span> <span class="kn">Module</span> <span class="nf">E</span> := X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">E</span> := X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Raw</span> := Raw I X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Import</span> Raw.Proofs.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight">#[universes(template)]
 <span class="kn">Record</span> <span class="nf">bst</span> (<span class="nv">elt</span>:<span class="kt">Type</span>) :=
  Bst {this :&gt; Raw.tree elt; is_bst : Raw.bst this}.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">t</span> := bst.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">key</span> := E.t.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Elt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span>: <span class="kt">Type</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Implicit Types</span> <span class="nv">m</span> : t elt.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Implicit Types</span> <span class="nv">x</span> <span class="nv">y</span> : key.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Implicit Types</span> <span class="nv">e</span> : elt.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">empty</span> : t elt := Bst (empty_bst elt).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">is_empty</span> <span class="nv">m</span> : bool := Raw.is_empty (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">add</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">m</span> : t elt := Bst (add_bst x e (is_bst m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">remove</span> <span class="nv">x</span> <span class="nv">m</span> : t elt := Bst (remove_bst x (is_bst m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mem</span> <span class="nv">x</span> <span class="nv">m</span> : bool := Raw.mem x (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">find</span> <span class="nv">x</span> <span class="nv">m</span> : option elt := Raw.find x (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map</span> <span class="nv">f</span> <span class="nv">m</span> : t elt&#39; := Bst (map_bst f (is_bst m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mapi</span> (<span class="nv">f</span>:key-&gt;elt-&gt;elt&#39;) <span class="nv">m</span> : t elt&#39; :=
  Bst (mapi_bst f (is_bst m)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">map2</span> <span class="nv">f</span> <span class="nv">m</span> (<span class="nv">m&#39;</span>:t elt&#39;) : t elt&#39;&#39; :=
  Bst (map2_bst f (is_bst m) (is_bst m&#39;)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">elements</span> <span class="nv">m</span> : list (key*elt) := Raw.elements (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">cardinal</span> <span class="nv">m</span> := Raw.cardinal (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fold</span> (<span class="nv">A</span>:<span class="kt">Type</span>) (<span class="nv">f</span>:key-&gt;elt-&gt;A-&gt;A) <span class="nv">m</span> <span class="nv">i</span> := Raw.<span class="nb">fold</span> (A:=A) f (this m) i.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equal</span> <span class="nv">cmp</span> <span class="nv">m</span> <span class="nv">m&#39;</span> : bool := Raw.equal cmp (this m) (this m&#39;).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">MapsTo</span> <span class="nv">x</span> <span class="nv">e</span> <span class="nv">m</span> : <span class="kt">Prop</span> := Raw.MapsTo x e (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">In</span> <span class="nv">x</span> <span class="nv">m</span> : <span class="kt">Prop</span> := Raw.In0 x (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Empty</span> <span class="nv">m</span> : <span class="kt">Prop</span> := Empty (this m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eq_key</span> : (key*elt) -&gt; (key*elt) -&gt; <span class="kt">Prop</span> := @PX.eqk elt.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eq_key_elt</span> : (key*elt) -&gt; (key*elt) -&gt; <span class="kt">Prop</span> := @PX.eqke elt.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lt_key</span> : (key*elt) -&gt; (key*elt) -&gt; <span class="kt">Prop</span> := @PX.ltk elt.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk379" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk379"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">MapsTo_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, E.eq x y -&gt; MapsTo x e m -&gt; MapsTo y e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
E.eq x y -&gt; MapsTo x e m -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
E.eq x y -&gt; MapsTo x e m -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@MapsTo_1 _ (this m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, In x m -&gt; mem x m = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key), In x m -&gt; mem x m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key), In x m -&gt; mem x m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37d"><span class="highlight"><span class="nb">unfold</span> In, mem; <span class="nb">intros</span> m x; <span class="nb">rewrite</span> In_alt; <span class="nb">simpl</span>; <span class="nb">apply</span> mem_1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.bst m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> (is_bst m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span>, mem x m = true -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key), mem x m = true -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk37f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk37f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key), mem x m = true -&gt; In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> In, mem; <span class="nb">intros</span> m x; <span class="nb">rewrite</span> In_alt; <span class="nb">simpl</span>; <span class="nb">apply</span> mem_2; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk380" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk380"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">empty_1</span> : Empty empty.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty empty</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk381" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk381"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty empty</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">exact</span> (@empty_1 elt).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk382" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk382"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">is_empty_1</span> : <span class="kr">forall</span> <span class="nv">m</span>, Empty m -&gt; is_empty m = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, Empty m -&gt; is_empty m = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk383" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk383"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, Empty m -&gt; is_empty m = true</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@is_empty_1 _ (this m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk384" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk384"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">is_empty_2</span> : <span class="kr">forall</span> <span class="nv">m</span>, is_empty m = true -&gt; Empty m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, is_empty m = true -&gt; Empty m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk385" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk385"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, is_empty m = true -&gt; Empty m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@is_empty_2 _ (this m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk386" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk386"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, E.eq x y -&gt; MapsTo y e (add x e m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
E.eq x y -&gt; MapsTo y e (add x e m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk387" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk387"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
E.eq x y -&gt; MapsTo y e (add x e m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="bp">exact</span> (@add_1 elt _ x y e).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk388" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk388"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span> <span class="nv">e&#39;</span>, ~ E.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (add x e&#39; m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ E.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (add x e&#39; m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk389" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk389"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ E.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (add x e&#39; m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y e e&#39;; <span class="bp">exact</span> (@add_2 elt _ x y e e&#39;).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">add_3</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span> <span class="nv">e&#39;</span>, ~ E.eq x y -&gt; MapsTo y e (add x e&#39; m) -&gt; MapsTo y e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ E.eq x y -&gt; MapsTo y e (add x e&#39; m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
~ E.eq x y -&gt; MapsTo y e (add x e&#39; m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y e e&#39;; <span class="bp">exact</span> (@add_3 elt _ x y e e&#39;).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span>, E.eq x y -&gt; ~ In y (remove x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key),
E.eq x y -&gt; ~ In y (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key),
E.eq x y -&gt; ~ In y (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38e"><span class="highlight"><span class="nb">unfold</span> In, remove; <span class="nb">intros</span> m x y; <span class="nb">rewrite</span> In_alt; <span class="nb">simpl</span>; <span class="nb">apply</span> remove_1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.bst m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> (is_bst m).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk38f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk38f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, ~ E.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (remove x m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
~ E.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk390" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk390"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
~ E.eq x y -&gt; MapsTo y e m -&gt; MapsTo y e (remove x m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="bp">exact</span> (@remove_2 elt _ x y e (is_bst m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk391" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk391"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">remove_3</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">e</span>, MapsTo y e (remove x m) -&gt; MapsTo y e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
MapsTo y e (remove x m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk392" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk392"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> <span class="nv">y</span> : key) (<span class="nv">e</span> : elt),
MapsTo y e (remove x m) -&gt; MapsTo y e m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x y e; <span class="bp">exact</span> (@remove_3 elt _ x y e (is_bst m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">

</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk393" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk393"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>, MapsTo x e m -&gt; find x m = Some e.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt; find x m = Some e</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk394" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk394"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt; find x m = Some e</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m x e; <span class="bp">exact</span> (@find_1 elt _ x e (is_bst m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk395" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk395"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">find_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>, find x m = Some e -&gt; MapsTo x e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
find x m = Some e -&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk396" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk396"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
find x m = Some e -&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@find_2 elt (this m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk397" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk397"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fold_1</span> : <span class="kr">forall</span> <span class="nv">m</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">i</span> : A) (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A),
        <span class="nb">fold</span> f m i = fold_left (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">p</span> =&gt; f (fst p) (snd p) a) (elements m) i.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">i</span> : A)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A),
<span class="nb">fold</span> f m i =
fold_left
  (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f (fst p) (snd p) a)
  (elements m) i</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk398" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk398"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">i</span> : A)
  (<span class="nv">f</span> : key -&gt; elt -&gt; A -&gt; A),
<span class="nb">fold</span> f m i =
fold_left
  (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">p</span> : key * elt) =&gt; f (fst p) (snd p) a)
  (elements m) i</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@fold_1 elt (this m) (is_bst m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk399" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk399"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>,
   MapsTo x e m -&gt; InA eq_key_elt (x,e) (elements m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt; InA eq_key_elt (x, e) (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk39a" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk39a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
MapsTo x e m -&gt; InA eq_key_elt (x, e) (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> elements, MapsTo, eq_key_elt; <span class="nb">rewrite</span> elements_mapsto; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk39b" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk39b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">x</span> <span class="nv">e</span>,
   InA eq_key_elt (x,e) (elements m) -&gt; MapsTo x e m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
InA eq_key_elt (x, e) (elements m) -&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk39c" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk39c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key) (<span class="nv">e</span> : elt),
InA eq_key_elt (x, e) (elements m) -&gt; MapsTo x e m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> elements, MapsTo, eq_key_elt; <span class="nb">rewrite</span> &lt;- elements_mapsto; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk39d" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk39d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_3</span> : <span class="kr">forall</span> <span class="nv">m</span>, sort lt_key (elements m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, Sorted lt_key (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk39e" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk39e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, Sorted lt_key (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@elements_sort elt (this m) (is_bst m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk39f" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk39f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">elements_3w</span> : <span class="kr">forall</span> <span class="nv">m</span>, NoDupA eq_key (elements m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, NoDupA eq_key (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, NoDupA eq_key (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m; <span class="bp">exact</span> (@elements_nodup elt (this m) (is_bst m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cardinal_1</span> : <span class="kr">forall</span> <span class="nv">m</span>, cardinal m = length (elements m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, cardinal m = length (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t elt, cardinal m = length (elements m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intro</span> m; <span class="bp">exact</span> (@elements_cardinal elt (this m)).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Equal</span> <span class="nv">m</span> <span class="nv">m&#39;</span> := <span class="kr">forall</span> <span class="nv">y</span>, find y m = find y m&#39;.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Equiv</span> (<span class="nv">eq_elt</span>:elt-&gt;elt-&gt;<span class="kt">Prop</span>) <span class="nv">m</span> <span class="nv">m&#39;</span> :=
   (<span class="kr">forall</span> <span class="nv">k</span>, In k m &lt;-&gt; In k m&#39;) /\
   (<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">e</span> <span class="nv">e&#39;</span>, MapsTo k e m -&gt; MapsTo k e&#39; m&#39; -&gt; eq_elt e e&#39;).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Equivb</span> <span class="nv">cmp</span> := Equiv (Cmp cmp).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Equivb_Equivb</span> : <span class="kr">forall</span> <span class="nv">cmp</span> <span class="nv">m</span> <span class="nv">m&#39;</span>,
  Equivb cmp m m&#39; &lt;-&gt; Raw.Proofs.Equivb cmp m m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">cmp</span> : elt -&gt; elt -&gt; bool) (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt),
Equivb cmp m m&#39; &lt;-&gt; Raw.Proofs.Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">cmp</span> : elt -&gt; elt -&gt; bool) (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt),
Equivb cmp m m&#39; &lt;-&gt; Raw.Proofs.Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a5"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> Equivb, Equiv, Raw.Proofs.Equivb, In.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">k</span> : key, Raw.In0 k m &lt;-&gt; Raw.In0 k m&#39;) /\
(<span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 MapsTo k e m -&gt; MapsTo k e&#39; m&#39; -&gt; Cmp cmp e e&#39;) &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">k</span> : Raw.key, Raw.In k m &lt;-&gt; Raw.In k m&#39;) /\
(<span class="kr">forall</span> (<span class="nv">k</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
 Raw.MapsTo k e m -&gt;
 Raw.MapsTo k e&#39; m&#39; -&gt; cmp e e&#39; = true)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3a6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3a6"><span class="highlight"><span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : key, Raw.In0 k0 m &lt;-&gt; Raw.In0 k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
MapsTo k0 e m -&gt; MapsTo k0 e&#39; m&#39; -&gt; Cmp cmp e e&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In k m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In k m&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3a7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : key, Raw.In0 k0 m &lt;-&gt; Raw.In0 k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
MapsTo k0 e m -&gt; MapsTo k0 e&#39; m&#39; -&gt; Cmp cmp e e&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In k m&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3a7"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.In k m</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3a8" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3a8"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.In0 k m&#39;</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3a9" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3a9"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.In0 k m</span></div></blockquote></div></div></div></small><span class="coq-wsp"> 
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3aa" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3aa"><span class="highlight"><span class="nb">generalize</span> (H0 k); <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> In_alt; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : key, Raw.In0 k0 m &lt;-&gt; Raw.In0 k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
MapsTo k0 e m -&gt; MapsTo k0 e&#39; m&#39; -&gt; Cmp cmp e e&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In k m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In k m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3ab" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3ab"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.In0 k m&#39;</span></div></blockquote><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3ac" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3ac"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.In0 k m</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ad" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ad"><span class="highlight"><span class="nb">generalize</span> (H0 k); <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> In_alt; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In0 k m&#39;</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3ae" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3ae"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.In0 k m</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3af" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3af"><span class="highlight"><span class="nb">generalize</span> (H0 k); <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> &lt;- In_alt; <span class="nb">intuition</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cmp</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt -&gt; bool</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">k0</span> : Raw.key, Raw.In k0 m &lt;-&gt; Raw.In k0 m&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">k0</span> : Raw.key) (<span class="nv">e</span> <span class="nv">e&#39;</span> : elt),
Raw.MapsTo k0 e m -&gt;
Raw.MapsTo k0 e&#39; m&#39; -&gt; cmp e e&#39; = true</span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In0 k m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In0 k m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">generalize</span> (H0 k); <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> &lt;- In_alt; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_1</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">cmp</span>,
   Equivb cmp m m&#39; -&gt; equal cmp m m&#39; = true.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">cmp</span> : elt -&gt; elt -&gt; bool),
Equivb cmp m m&#39; -&gt; equal cmp m m&#39; = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">cmp</span> : elt -&gt; elt -&gt; bool),
Equivb cmp m m&#39; -&gt; equal cmp m m&#39; = true</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> equal; <span class="nb">intros</span> (m,b) (m&#39;,b&#39;) cmp; <span class="nb">rewrite</span> Equivb_Equivb;
  <span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">rewrite</span> equal_Equivb; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equal_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> <span class="nv">cmp</span>,
   equal cmp m m&#39; = true -&gt; Equivb cmp m m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">cmp</span> : elt -&gt; elt -&gt; bool),
equal cmp m m&#39; = true -&gt; Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t elt) (<span class="nv">cmp</span> : elt -&gt; elt -&gt; bool),
equal cmp m m&#39; = true -&gt; Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> equal; <span class="nb">intros</span> (m,b) (m&#39;,b&#39;) cmp; <span class="nb">rewrite</span> Equivb_Equivb;
  <span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">rewrite</span> &lt;-equal_Equivb; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Elt</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_1</span> : <span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span>:<span class="kt">Type</span>)(<span class="nv">m</span>: t elt)(<span class="nv">x</span>:key)(<span class="nv">e</span>:elt)(<span class="nv">f</span>:elt-&gt;elt&#39;),
        MapsTo x e m -&gt; MapsTo x (f e) (map f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">e</span> : elt) (<span class="nv">f</span> : elt -&gt; elt&#39;),
MapsTo x e m -&gt; MapsTo x (f e) (map f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">e</span> : elt) (<span class="nv">f</span> : elt -&gt; elt&#39;),
MapsTo x e m -&gt; MapsTo x (f e) (map f m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> elt elt&#39; m x e f; <span class="bp">exact</span> (@map_1 elt elt&#39; f (this m) x e).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_2</span> : <span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span>:<span class="kt">Type</span>)(<span class="nv">m</span>:t elt)(<span class="nv">x</span>:key)(<span class="nv">f</span>:elt-&gt;elt&#39;), In x (map f m) -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : elt -&gt; elt&#39;),
In (elt:=elt&#39;) x (map f m) -&gt; In (elt:=elt) x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : elt -&gt; elt&#39;),
In (elt:=elt&#39;) x (map f m) -&gt; In (elt:=elt) x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b8"><span class="highlight"><span class="nb">intros</span> elt elt&#39; m x f; <span class="kp">do</span> <span class="mi">2</span> <span class="nb">unfold</span> In <span class="kr">in</span> *; <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> In_alt; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">elt -&gt; elt&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In x (Raw.map f m) -&gt; Raw.In x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> map_2; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3b9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3b9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mapi_1</span> : <span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span>:<span class="kt">Type</span>)(<span class="nv">m</span>: t elt)(<span class="nv">x</span>:key)(<span class="nv">e</span>:elt)
        (<span class="nv">f</span>:key-&gt;elt-&gt;elt&#39;), MapsTo x e m -&gt;
        <span class="kr">exists</span> <span class="nv">y</span>, E.eq y x /\ MapsTo x (f y e) (mapi f m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">e</span> : elt) (<span class="nv">f</span> : key -&gt; elt -&gt; elt&#39;),
MapsTo x e m -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : E.t,
  E.eq y x /\ MapsTo x (f y e) (mapi f m)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ba" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ba"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">e</span> : elt) (<span class="nv">f</span> : key -&gt; elt -&gt; elt&#39;),
MapsTo x e m -&gt;
<span class="kr">exists</span> <span class="nv">y</span> : E.t,
  E.eq y x /\ MapsTo x (f y e) (mapi f m)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> elt elt&#39; m x e f; <span class="bp">exact</span> (@mapi_1 elt elt&#39; f (this m) x e).</span></span><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3bb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3bb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mapi_2</span> : <span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span>:<span class="kt">Type</span>)(<span class="nv">m</span>: t elt)(<span class="nv">x</span>:key)
        (<span class="nv">f</span>:key-&gt;elt-&gt;elt&#39;), In x (mapi f m) -&gt; In x m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : key -&gt; elt -&gt; elt&#39;),
In (elt:=elt&#39;) x (mapi f m) -&gt; In (elt:=elt) x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3bc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3bc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : key -&gt; elt -&gt; elt&#39;),
In (elt:=elt&#39;) x (mapi f m) -&gt; In (elt:=elt) x m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> elt elt&#39; m x f; <span class="nb">unfold</span> In <span class="kr">in</span> *; <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> In_alt; <span class="nb">simpl</span>; <span class="nb">apply</span> mapi_2; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3bd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3bd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_1</span> : <span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span>:<span class="kt">Type</span>)(<span class="nv">m</span>: t elt)(<span class="nv">m&#39;</span>: t elt&#39;)
    (<span class="nv">x</span>:key)(<span class="nv">f</span>:option elt-&gt;option elt&#39;-&gt;option elt&#39;&#39;),
    In x m \/ In x m&#39; -&gt;
    find x (map2 f m m&#39;) = f (find x m) (find x m&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt)
  (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;),
In (elt:=elt) x m \/ In (elt:=elt&#39;) x m&#39; -&gt;
find (elt:=elt&#39;&#39;) x (map2 f m m&#39;) =
f (find (elt:=elt) x m) (find (elt:=elt&#39;) x m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3be" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3be"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt)
  (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;),
In (elt:=elt) x m \/ In (elt:=elt&#39;) x m&#39; -&gt;
find (elt:=elt&#39;&#39;) x (map2 f m m&#39;) =
f (find (elt:=elt) x m) (find (elt:=elt&#39;) x m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3bf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3bf"><span class="highlight"><span class="nb">unfold</span> find, map2, In; <span class="nb">intros</span> elt elt&#39; elt&#39;&#39; m m&#39; x f.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In0 x m \/ Raw.In0 x m&#39; -&gt;
Raw.find x
  {|
  this := Raw.map2 f m m&#39;;
  is_bst := map2_bst f (is_bst m) (is_bst m&#39;) |} =
f (Raw.find x m) (Raw.find x m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c0"><span class="highlight"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> In_alt; <span class="nb">intros</span>; <span class="nb">simpl</span>; <span class="nb">apply</span> map2_1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In x m \/ Raw.In x m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.bst m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3c1" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In x m \/ Raw.In x m&#39;</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3c1"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.bst m&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c2"><span class="highlight"><span class="nb">apply</span> (is_bst m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In x m \/ Raw.In x m&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.bst m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> (is_bst m&#39;).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map2_2</span> : <span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span>:<span class="kt">Type</span>)(<span class="nv">m</span>: t elt)(<span class="nv">m&#39;</span>: t elt&#39;)
     (<span class="nv">x</span>:key)(<span class="nv">f</span>:option elt-&gt;option elt&#39;-&gt;option elt&#39;&#39;),
     In x (map2 f m m&#39;) -&gt; In x m \/ In x m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt)
  (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;),
In (elt:=elt&#39;&#39;) x (map2 f m m&#39;) -&gt;
In (elt:=elt) x m \/ In (elt:=elt&#39;) x m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">elt</span> <span class="nv">elt&#39;</span> <span class="nv">elt&#39;&#39;</span> : <span class="kt">Type</span>) (<span class="nv">m</span> : t elt)
  (<span class="nv">m&#39;</span> : t elt&#39;) (<span class="nv">x</span> : key)
  (<span class="nv">f</span> : option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;),
In (elt:=elt&#39;&#39;) x (map2 f m m&#39;) -&gt;
In (elt:=elt) x m \/ In (elt:=elt&#39;) x m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c5"><span class="highlight"><span class="nb">unfold</span> In, map2; <span class="nb">intros</span> elt elt&#39; elt&#39;&#39; m m&#39; x f.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.In0 x
  {|
  this := Raw.map2 f m m&#39;;
  is_bst := map2_bst f (is_bst m) (is_bst m&#39;) |} -&gt;
Raw.In0 x m \/ Raw.In0 x m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c6"><span class="highlight"><span class="kp">do</span> <span class="mi">3</span> <span class="nb">rewrite</span> In_alt; <span class="nb">intros</span>; <span class="nb">simpl</span> <span class="kr">in</span> *; <span class="nb">eapply</span> map2_2; <span class="nb">eauto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In x (Raw.map2 f m m&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.bst m</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3c7" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In x (Raw.map2 f m m&#39;)</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3c7"><hr></label><div class="goal-conclusion"><span class="highlight">Raw.bst m&#39;</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c8"><span class="highlight"><span class="nb">apply</span> (is_bst m).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">elt, elt', elt''</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kt">Type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt</span></span></span></div><div class="goal-hyp"><span class="hyp-names">m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t elt&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">option elt -&gt; option elt&#39; -&gt; option elt&#39;&#39;</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.In x (Raw.map2 f m m&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.bst m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> (is_bst m&#39;).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"> </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">IntMake</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">IntMake_ord</span> (I:Int)(X: OrderedType)(D : OrderedType) &lt;:
    Sord <span class="kr">with</span> <span class="kn">Module</span> <span class="nf">Data</span> := D
         <span class="kr">with</span> <span class="kn">Module</span> <span class="nf">MapS</span>.E := X.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Data</span> := D.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Import</span> MapS := IntMake(I)(X).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">LO</span> := FMapList.Make_ord(X)(D).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">R</span> := Raw.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">P</span> := Raw.Proofs.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">t</span> := MapS.t D.t.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">cmp</span> <span class="nv">e</span> <span class="nv">e&#39;</span> :=
   <span class="kr">match</span> D.<span class="nb">compare</span> e e&#39; <span class="kr">with</span> EQ _ =&gt; true | _ =&gt; false <span class="kr">end</span>.</span></span></span></pre><div class="doc">
One step of comparison of elements 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">compare_more</span> <span class="nv">x1</span> <span class="nv">d1</span> (<span class="nv">cont</span>:R.enumeration D.t -&gt; comparison) <span class="nv">e2</span> :=
   <span class="kr">match</span> e2 <span class="kr">with</span>
    | R.<span class="kn">End</span> <span class="nf">_</span> =&gt; Gt
    | R.More x2 d2 r2 e2 =&gt;
       <span class="kr">match</span> X.<span class="nb">compare</span> x1 x2 <span class="kr">with</span>
        | EQ _ =&gt; <span class="kr">match</span> D.<span class="nb">compare</span> d1 d2 <span class="kr">with</span>
                   | EQ _ =&gt; cont (R.cons r2 e2)
                   | LT _ =&gt; Lt
                   | GT _ =&gt; Gt
                  <span class="kr">end</span>
        | LT _ =&gt; Lt
        | GT _ =&gt; Gt
       <span class="kr">end</span>
   <span class="kr">end</span>.</span></span></span></pre><div class="doc">
Comparison of left tree, middle element, then right tree 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">compare_cont</span> <span class="nv">s1</span> (<span class="nv">cont</span>:R.enumeration D.t -&gt; comparison) <span class="nv">e2</span> :=
   <span class="kr">match</span> s1 <span class="kr">with</span>
    | R.Leaf _ =&gt; cont e2
    | R.Node l1 x1 d1 r1 _ =&gt;
       compare_cont l1 (compare_more x1 d1 (compare_cont r1 cont)) e2
   <span class="kr">end</span>.</span></span></span></pre><div class="doc">
Initial continuation 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">compare_end</span> (<span class="nv">e2</span>:R.enumeration D.t) :=
   <span class="kr">match</span> e2 <span class="kr">with</span> R.<span class="kn">End</span> <span class="nf">_</span> =&gt; Eq | _ =&gt; Lt <span class="kr">end</span>.</span></span></span></pre><div class="doc">
The complete comparison 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">compare_pure</span> <span class="nv">s1</span> <span class="nv">s2</span> :=
   compare_cont s1 compare_end (R.cons s2 (Raw.<span class="kn">End</span> <span class="nf">_</span>)).</span></span></span></pre><div class="doc">
Correctness of this comparison 
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Cmp</span> <span class="nv">c</span> :=
   <span class="kr">match</span> c <span class="kr">with</span>
    | Eq =&gt; LO.eq_list
    | Lt =&gt; LO.lt_list
    | Gt =&gt; (<span class="kr">fun</span> <span class="nv">l1</span> <span class="nv">l2</span> =&gt; LO.lt_list l2 l1)
   <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3c9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3c9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cons_Cmp</span> : <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">d1</span> <span class="nv">d2</span> <span class="nv">l1</span> <span class="nv">l2</span>,
   X.eq x1 x2 -&gt; D.eq d1 d2 -&gt;
   Cmp c l1 l2 -&gt; Cmp c ((x1,d1)::l1) ((x2,d2)::l2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">c</span> : comparison) (<span class="nv">x1</span> <span class="nv">x2</span> : X.t) (<span class="nv">d1</span> <span class="nv">d2</span> : D.t)
  (<span class="nv">l1</span> <span class="nv">l2</span> : list (X.t * D.t)),
X.eq x1 x2 -&gt;
D.eq d1 d2 -&gt;
Cmp c l1 l2 -&gt; Cmp c ((x1, d1) :: l1) ((x2, d2) :: l2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ca" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ca"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">c</span> : comparison) (<span class="nv">x1</span> <span class="nv">x2</span> : X.t) (<span class="nv">d1</span> <span class="nv">d2</span> : D.t)
  (<span class="nv">l1</span> <span class="nv">l2</span> : list (X.t * D.t)),
X.eq x1 x2 -&gt;
D.eq d1 d2 -&gt;
Cmp c l1 l2 -&gt; Cmp c ((x1, d1) :: l1) ((x2, d2) :: l2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> c; <span class="nb">simpl</span>; <span class="nb">intros</span>; P.MX.elim_comp; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Hint Resolve</span> cons_Cmp : core.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3cb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3cb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_end_Cmp</span> :
   <span class="kr">forall</span> <span class="nv">e2</span>, Cmp (compare_end e2) nil (P.flatten_e e2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e2</span> : R.enumeration D.t,
Cmp (compare_end e2) nil (P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3cc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3cc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e2</span> : R.enumeration D.t,
Cmp (compare_end e2) nil (P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> e2; <span class="nb">simpl</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3cd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3cd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_more_Cmp</span> : <span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">d1</span> <span class="nv">cont</span> <span class="nv">x2</span> <span class="nv">d2</span> <span class="nv">r2</span> <span class="nv">e2</span> <span class="nv">l</span>,
    Cmp (cont (R.cons r2 e2)) l (R.elements r2 ++ P.flatten_e e2) -&gt;
     Cmp (compare_more x1 d1 cont (R.More x2 d2 r2 e2)) ((x1,d1)::l)
       (P.flatten_e (R.More x2 d2 r2 e2)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : X.t) (<span class="nv">d1</span> : D.t)
  (<span class="nv">cont</span> : R.enumeration D.t -&gt; comparison)
  (<span class="nv">x2</span> : R.key) (<span class="nv">d2</span> : D.t) (<span class="nv">r2</span> : Raw.t D.t)
  (<span class="nv">e2</span> : R.enumeration D.t) (<span class="nv">l</span> : list (X.t * D.t)),
Cmp (cont (R.cons r2 e2)) l
  (R.elements r2 ++ P.flatten_e e2) -&gt;
Cmp (compare_more x1 d1 cont (R.More x2 d2 r2 e2))
  ((x1, d1) :: l) (P.flatten_e (R.More x2 d2 r2 e2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ce" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ce"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x1</span> : X.t) (<span class="nv">d1</span> : D.t)
  (<span class="nv">cont</span> : R.enumeration D.t -&gt; comparison)
  (<span class="nv">x2</span> : R.key) (<span class="nv">d2</span> : D.t) (<span class="nv">r2</span> : Raw.t D.t)
  (<span class="nv">e2</span> : R.enumeration D.t) (<span class="nv">l</span> : list (X.t * D.t)),
Cmp (cont (R.cons r2 e2)) l
  (R.elements r2 ++ P.flatten_e e2) -&gt;
Cmp (compare_more x1 d1 cont (R.More x2 d2 r2 e2))
  ((x1, d1) :: l) (P.flatten_e (R.More x2 d2 r2 e2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">intros</span>; <span class="nb">destruct</span> X.<span class="nb">compare</span>; <span class="nb">simpl</span>;
    <span class="kp">try</span> <span class="nb">destruct</span> D.<span class="nb">compare</span>; <span class="nb">simpl</span>; <span class="nb">auto</span>; P.MX.elim_comp; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3cf" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3cf"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_cont_Cmp</span> : <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">cont</span> <span class="nv">e2</span> <span class="nv">l</span>,
   (<span class="kr">forall</span> <span class="nv">e</span>, Cmp (cont e) l (P.flatten_e e)) -&gt;
   Cmp (compare_cont s1 cont e2) (R.elements s1 ++ l) (P.flatten_e e2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s1</span> : Raw.t D.t)
  (<span class="nv">cont</span> : Raw.enumeration D.t -&gt; comparison)
  (<span class="nv">e2</span> : R.enumeration D.t) (<span class="nv">l</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
 Cmp (cont e) l (P.flatten_e e)) -&gt;
Cmp (compare_cont s1 cont e2) (R.elements s1 ++ l)
  (P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s1</span> : Raw.t D.t)
  (<span class="nv">cont</span> : Raw.enumeration D.t -&gt; comparison)
  (<span class="nv">e2</span> : R.enumeration D.t) (<span class="nv">l</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
 Cmp (cont e) l (P.flatten_e e)) -&gt;
Cmp (compare_cont s1 cont e2) (R.elements s1 ++ l)
  (P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d1"><span class="highlight"><span class="nb">induction</span> s1 <span class="kr">as</span> [|l1 Hl1 x1 d1 r1 Hr1 h1]; <span class="nb">intros</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e0) (R.elements l1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e0) (R.elements r1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">R.enumeration D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp (compare_cont (Raw.Node l1 x1 d1 r1 h1) cont e2)
  (R.elements (Raw.Node l1 x1 d1 r1 h1) ++ l)
  (P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d2"><span class="highlight"><span class="nb">rewrite</span> &lt;- P.elements_node; <span class="nb">simpl</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e0) (R.elements l1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e0) (R.elements r1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">R.enumeration D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_cont l1
     (compare_more x1 d1 (compare_cont r1 cont)) e2)
  (Raw.elements l1 ++ (x1, d1) :: Raw.elements r1 ++ l)
  (P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d3"><span class="highlight"><span class="nb">apply</span> Hl1; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e0) (R.elements l1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e0) (R.elements r1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">R.enumeration D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (compare_more x1 d1 (compare_cont r1 cont) e)
  ((x1, d1) :: Raw.elements r1 ++ l) (P.flatten_e e)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d4"><span class="highlight"><span class="nb">clear</span> e2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e2</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e2) (R.elements l1 ++ l0) (P.flatten_e e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e2</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e2) (R.elements r1 ++ l0) (P.flatten_e e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (compare_more x1 d1 (compare_cont r1 cont) e)
  ((x1, d1) :: Raw.elements r1 ++ l) (P.flatten_e e)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d5"><span class="highlight"><span class="nb">intros</span> [|x2 d2 r2 e2].</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e2</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e2) (R.elements l1 ++ l0) (P.flatten_e e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e2</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e2) (R.elements r1 ++ l0) (P.flatten_e e2)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_more x1 d1 (compare_cont r1 cont)
     (Raw.<span class="kn">End</span> <span class="nf">D</span>.t)) ((x1, d1) :: Raw.elements r1 ++ l)
  (P.flatten_e (Raw.<span class="kn">End</span> <span class="nf">D</span>.t))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="FMapAVL-v-chk3d6" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span>
  (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison)
  (<span class="nv">e0</span> : R.enumeration D.t)
  (<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
 Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e0)
  (R.elements l1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span>
  (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison)
  (<span class="nv">e0</span> : R.enumeration D.t)
  (<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
 Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e0)
  (R.elements r1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t</span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="FMapAVL-v-chk3d6"><hr></label><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_more x1 d1 (compare_cont r1 cont)
     (Raw.More x2 d2 r2 e2))
  ((x1, d1) :: Raw.elements r1 ++ l)
  (P.flatten_e (Raw.More x2 d2 r2 e2))</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d7"><span class="highlight"><span class="nb">simpl</span>; <span class="nb">auto</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e0) (R.elements l1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e0) (R.elements r1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_more x1 d1 (compare_cont r1 cont)
     (Raw.More x2 d2 r2 e2))
  ((x1, d1) :: Raw.elements r1 ++ l)
  (P.flatten_e (Raw.More x2 d2 r2 e2))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d8"><span class="highlight"><span class="nb">apply</span> compare_more_Cmp.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">h1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">I.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont l1 cont0 e0) (R.elements l1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hr1</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> (<span class="nv">cont0</span> : Raw.enumeration D.t -&gt; comparison) (<span class="nv">e0</span> : R.enumeration D.t)
(<span class="nv">l0</span> : list (X.t * D.t)),
(<span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t, Cmp (cont0 e) l0 (P.flatten_e e)) -&gt;
Cmp (compare_cont r1 cont0 e0) (R.elements r1 ++ l0) (P.flatten_e e0)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">cont</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t -&gt; comparison</span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">list (X.t * D.t)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight"><span class="kr">forall</span> <span class="nv">e</span> : Raw.enumeration D.t,
Cmp (cont e) l (P.flatten_e e)</span></span></span></div><div class="goal-hyp"><span class="hyp-names">x2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.key</span></span></span></div><div class="goal-hyp"><span class="hyp-names">d2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">r2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">e2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.enumeration D.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp (compare_cont r1 cont (R.cons r2 e2))
  (Raw.elements r1 ++ l)
  (R.elements r2 ++ P.flatten_e e2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">rewrite</span> &lt;- P.cons_1; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3d9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3d9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">compare_Cmp</span> : <span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span>,
   Cmp (compare_pure s1 s2) (R.elements s1) (R.elements s2).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Raw.t D.t,
Cmp (compare_pure s1 s2) (R.elements s1)
  (R.elements s2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3da" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3da"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Raw.t D.t,
Cmp (compare_pure s1 s2) (R.elements s1)
  (R.elements s2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3db" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3db"><span class="highlight"><span class="nb">intros</span>; <span class="nb">unfold</span> compare_pure.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_cont s1 compare_end
     (R.cons s2 (Raw.<span class="kn">End</span> <span class="nf">D</span>.t))) (R.elements s1)
  (R.elements s2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3dc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3dc"><span class="highlight"><span class="nb">rewrite</span> &lt;- (app_nil_r (R.elements s1)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_cont s1 compare_end
     (R.cons s2 (Raw.<span class="kn">End</span> <span class="nf">D</span>.t))) (R.elements s1 ++ nil)
  (R.elements s2)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3dd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3dd"><span class="highlight"><span class="nb">replace</span> (R.elements s2) <span class="kr">with</span> (P.flatten_e (R.cons s2 (R.<span class="kn">End</span> <span class="nf">_</span>))) <span class="bp">by</span>
    (<span class="nb">rewrite</span> P.cons_1; <span class="nb">simpl</span>; <span class="nb">rewrite</span> app_nil_r; <span class="nb">auto</span>).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp
  (compare_cont s1 compare_end
     (R.cons s2 (Raw.<span class="kn">End</span> <span class="nf">D</span>.t))) (R.elements s1 ++ nil)
  (P.flatten_e (R.cons s2 (R.<span class="kn">End</span> <span class="nf">D</span>.t)))</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto using</span> compare_cont_Cmp, compare_end_Cmp.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre><div class="doc">
The dependent-style <span class="inlinecode"><span class="id" title="var">compare</span></span>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v0.2 --><span class="coq-wsp"><span class="highlight">  </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">eq</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t) := LO.eq_list (elements m1) (elements m2).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">lt</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t) := LO.lt_list (elements m1) (elements m2).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3de" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3de"><span class="highlight"><span class="kn">Definition</span> <span class="nf">compare</span> (<span class="nv">s</span> <span class="nv">s&#39;</span>:t) : Compare lt eq s s&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Compare lt eq s s&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3df" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3df"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s, s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Compare lt eq s s&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e0"><span class="highlight"><span class="nb">destruct</span> s <span class="kr">as</span> (s,b), s&#39; <span class="kr">as</span> (s&#39;,b&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.bst s&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Compare lt eq {| this := s; is_bst := b |}
  {| this := s&#39;; is_bst := b&#39; |}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e1"><span class="highlight"><span class="nb">generalize</span> (compare_Cmp s s&#39;).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.bst s</span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.t D.t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">b'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">Raw.bst s&#39;</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cmp (compare_pure s s&#39;) (R.elements s) (R.elements s&#39;) -&gt;
Compare lt eq {| this := s; is_bst := b |}
  {| this := s&#39;; is_bst := b&#39; |}</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">destruct</span> compare_pure; <span class="nb">intros</span>; [<span class="nb">apply</span> EQ|<span class="nb">apply</span> LT|<span class="nb">apply</span> GT]; <span class="nb">red</span>; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
  <span class="c">(* Proofs about [eq] and [lt] *)</span>

</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">selements</span> (<span class="nv">m1</span> : t) :=
   LO.MapS.Build_slist (P.elements_sort (is_bst m1)).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">seq</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t) := LO.eq (selements m1) (selements m2).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">slt</span> (<span class="nv">m1</span> <span class="nv">m2</span> : t) := LO.lt (selements m1) (selements m2).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_seq</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span>, eq m1 m2 &lt;-&gt; seq m1 m2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, eq m1 m2 &lt;-&gt; seq m1 m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, eq m1 m2 &lt;-&gt; seq m1 m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> eq, seq, selements, elements, LO.eq; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_slt</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span>, lt m1 m2 &lt;-&gt; slt m1 m2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, lt m1 m2 &lt;-&gt; slt m1 m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, lt m1 m2 &lt;-&gt; slt m1 m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">unfold</span> lt, slt, selements, elements, LO.lt; <span class="nb">intuition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_1</span> : <span class="kr">forall</span> (<span class="nv">m</span> <span class="nv">m&#39;</span> : t), Equivb cmp m m&#39; -&gt; eq m m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> : t, Equivb cmp m m&#39; -&gt; eq m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> : t, Equivb cmp m m&#39; -&gt; eq m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e8"><span class="highlight"><span class="nb">intros</span> m m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Equivb cmp m m&#39; -&gt; eq m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3e9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3e9"><span class="highlight"><span class="nb">rewrite</span> eq_seq; <span class="nb">unfold</span> seq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Equivb cmp m m&#39; -&gt; LO.eq (selements m) (selements m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ea" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ea"><span class="highlight"><span class="nb">rewrite</span> Equivb_Equivb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Raw.Proofs.Equivb cmp m m&#39; -&gt;
LO.eq (selements m) (selements m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3eb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3eb"><span class="highlight"><span class="nb">rewrite</span> P.Equivb_elements.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P.L.Equivb cmp (Raw.elements m) (Raw.elements m&#39;) -&gt;
LO.eq (selements m) (selements m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto using</span> LO.eq_1.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ec" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ec"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_2</span> : <span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span>, eq m m&#39; -&gt; Equivb cmp m m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> : t, eq m m&#39; -&gt; Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ed" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ed"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> <span class="nv">m&#39;</span> : t, eq m m&#39; -&gt; Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ee" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ee"><span class="highlight"><span class="nb">intros</span> m m&#39;.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">eq m m&#39; -&gt; Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3ef" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3ef"><span class="highlight"><span class="nb">rewrite</span> eq_seq; <span class="nb">unfold</span> seq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LO.eq (selements m) (selements m&#39;) -&gt; Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f0" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f0"><span class="highlight"><span class="nb">rewrite</span> Equivb_Equivb.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LO.eq (selements m) (selements m&#39;) -&gt;
Raw.Proofs.Equivb cmp m m&#39;</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f1" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f1"><span class="highlight"><span class="nb">rewrite</span> P.Equivb_elements.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LO.eq (selements m) (selements m&#39;) -&gt;
P.L.Equivb cmp (Raw.elements m) (Raw.elements m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f2" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f2"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">LO.eq (selements m) (selements m&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P.L.Equivb cmp (Raw.elements m) (Raw.elements m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f3" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f3"><span class="highlight"><span class="nb">generalize</span> (LO.eq_2 H).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, m'</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">LO.eq (selements m) (selements m&#39;)</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LO.MapS.Equivb LO.cmp (selements m) (selements m&#39;) -&gt;
P.L.Equivb cmp (Raw.elements m) (Raw.elements m&#39;)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f4" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_refl</span> : <span class="kr">forall</span> <span class="nv">m</span> : t, eq m m.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t, eq m m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f5" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m</span> : t, eq m m</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">rewrite</span> eq_seq; <span class="nb">unfold</span> seq; <span class="nb">intros</span>; <span class="nb">apply</span> LO.eq_refl.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f6" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_sym</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, eq m1 m2 -&gt; eq m2 m1.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, eq m1 m2 -&gt; eq m2 m1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f7" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, eq m1 m2 -&gt; eq m2 m1</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">rewrite</span> <span class="mi">2</span> eq_seq; <span class="nb">unfold</span> seq; <span class="nb">intros</span>; <span class="nb">apply</span> LO.eq_sym; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f8" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_trans</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">m3</span> : t, eq m1 m2 -&gt; eq m2 m3 -&gt; eq m1 m3.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">m3</span> : t, eq m1 m2 -&gt; eq m2 m3 -&gt; eq m1 m3</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3f9" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3f9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">m3</span> : t, eq m1 m2 -&gt; eq m2 m3 -&gt; eq m1 m3</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3fa" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3fa"><span class="highlight"><span class="nb">intros</span> m1 m2 M3; <span class="nb">rewrite</span> <span class="mi">3</span> eq_seq; <span class="nb">unfold</span> seq.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m1, m2, M3</span><span><span class="hyp-type"><span class="hyp-punct">:</span><span class="highlight">t</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LO.eq (selements m1) (selements m2) -&gt;
LO.eq (selements m2) (selements M3) -&gt;
LO.eq (selements m1) (selements M3)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">   </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span>; <span class="nb">eapply</span> LO.eq_trans; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3fb" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3fb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_trans</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">m3</span> : t, lt m1 m2 -&gt; lt m2 m3 -&gt; lt m1 m3.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">m3</span> : t, lt m1 m2 -&gt; lt m2 m3 -&gt; lt m1 m3</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3fc" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3fc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> <span class="nv">m3</span> : t, lt m1 m2 -&gt; lt m2 m3 -&gt; lt m1 m3</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m1 m2 m3; <span class="nb">rewrite</span> <span class="mi">3</span> lt_slt; <span class="nb">unfold</span> slt;
   <span class="nb">intros</span>; <span class="nb">eapply</span> LO.lt_trans; <span class="nb">eauto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3fd" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3fd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">lt_not_eq</span> : <span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, lt m1 m2 -&gt; ~ eq m1 m2.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, lt m1 m2 -&gt; ~ eq m1 m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="FMapAVL-v-chk3fe" style="display: none" type="checkbox"><label class="coq-input" for="FMapAVL-v-chk3fe"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">m1</span> <span class="nv">m2</span> : t, lt m1 m2 -&gt; ~ eq m1 m2</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">intros</span> m1 m2; <span class="nb">rewrite</span> lt_slt, eq_seq; <span class="nb">unfold</span> slt, seq;
   <span class="nb">intros</span>; <span class="nb">apply</span> LO.lt_not_eq; <span class="nb">auto</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">IntMake_ord</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
<span class="c">(* For concrete use inside Coq, we propose an instantiation of [Int] by [Z]. *)</span>

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Make</span> (X: OrderedType) &lt;: S <span class="kr">with</span> <span class="kn">Module</span> <span class="nf">E</span> := X
 :=IntMake(Z_as_Int)(X).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Module</span> <span class="nf">Make_ord</span> (X: OrderedType)(D: OrderedType)
 &lt;: Sord <span class="kr">with</span> <span class="kn">Module</span> <span class="nf">Data</span> := D
            <span class="kr">with</span> <span class="kn">Module</span> <span class="nf">MapS</span>.E := X
 :=IntMake_ord(Z_as_Int)(X)(D).</span></span></span></pre></article></body></html>